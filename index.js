(()=>{"use strict";var e={5067:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.BlendMode=void 0,function(e){e.Normal="normal",e.Darken="darken",e.Multiply="multiply",e.ColorBurn="color_burn",e.Lighten="lighten",e.Screen="screen",e.ColorDodge="color_dodge",e.Addition="addition",e.Overlay="overlay",e.SoftLight="soft_light",e.HardLight="hard_light",e.Difference="difference",e.Exclusion="exclusion",e.Subtract="subtract",e.Divide="divide",e.Hue="hsl_hue",e.Saturation="hsl_saturation",e.Color="hsl_color",e.Luminosity="hsl_luminosity"}(i||(t.BlendMode=i={}))},2902:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.Direction=void 0,function(e){e.Forward="forward",e.Reverse="reverse",e.PingPong="pingpong"}(i||(t.Direction=i={}))},5169:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.Format=void 0,function(e){e.RGBA8888="RGBA8888",e.I8="I8"}(i||(t.Format=i={}))},3660:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Format=t.Direction=t.BlendMode=void 0,i(5760);var s=i(5067);Object.defineProperty(t,"BlendMode",{enumerable:!0,get:function(){return s.BlendMode}});var n=i(2902);Object.defineProperty(t,"Direction",{enumerable:!0,get:function(){return n.Direction}});var a=i(5169);Object.defineProperty(t,"Format",{enumerable:!0,get:function(){return a.Format}})},5760:()=>{},3504:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.GridOrientation=void 0,function(e){e.ORTHOGONAL="orthogonal",e.ISOMETRIC="isometric"}(i||(t.GridOrientation=i={}))},4615:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WangSetType=t.TileRenderSize=t.ObjectAlignment=t.FillMode=t.isTilesetRef=t.isEmbeddedTileset=t.VerticalAlign=t.HorizontalAlign=t.PropertyType=t.StaggerIndex=t.StaggerAxis=t.RenderOrder=t.MapOrientation=t.Encoding=t.DrawOrder=t.decodeTileLayer=t.Compression=t.isUnencodedTileLayer=t.isTileLayer=t.isObjectGroup=t.isImageLayer=t.isGroup=t.isEncodedTileLayer=t.GridOrientation=void 0,i(5734);var s=i(3504);Object.defineProperty(t,"GridOrientation",{enumerable:!0,get:function(){return s.GridOrientation}});var n=i(6627);Object.defineProperty(t,"isEncodedTileLayer",{enumerable:!0,get:function(){return n.isEncodedTileLayer}}),Object.defineProperty(t,"isGroup",{enumerable:!0,get:function(){return n.isGroup}}),Object.defineProperty(t,"isImageLayer",{enumerable:!0,get:function(){return n.isImageLayer}}),Object.defineProperty(t,"isObjectGroup",{enumerable:!0,get:function(){return n.isObjectGroup}}),Object.defineProperty(t,"isTileLayer",{enumerable:!0,get:function(){return n.isTileLayer}}),Object.defineProperty(t,"isUnencodedTileLayer",{enumerable:!0,get:function(){return n.isUnencodedTileLayer}});var a=i(8913);Object.defineProperty(t,"Compression",{enumerable:!0,get:function(){return a.Compression}});var r=i(6381);Object.defineProperty(t,"decodeTileLayer",{enumerable:!0,get:function(){return r.decodeTileLayer}});var o=i(6889);Object.defineProperty(t,"DrawOrder",{enumerable:!0,get:function(){return o.DrawOrder}});var h=i(5222);Object.defineProperty(t,"Encoding",{enumerable:!0,get:function(){return h.Encoding}});var l=i(9539);Object.defineProperty(t,"MapOrientation",{enumerable:!0,get:function(){return l.MapOrientation}});var d=i(8554);Object.defineProperty(t,"RenderOrder",{enumerable:!0,get:function(){return d.MapRenderOrder}});var u=i(897);Object.defineProperty(t,"StaggerAxis",{enumerable:!0,get:function(){return u.StaggerAxis}});var c=i(9481);Object.defineProperty(t,"StaggerIndex",{enumerable:!0,get:function(){return c.StaggerIndex}});var p=i(7360);Object.defineProperty(t,"PropertyType",{enumerable:!0,get:function(){return p.PropertyType}});var g=i(5178);Object.defineProperty(t,"HorizontalAlign",{enumerable:!0,get:function(){return g.HorizontalAlign}});var m=i(8761);Object.defineProperty(t,"VerticalAlign",{enumerable:!0,get:function(){return m.VerticalAlign}});var y=i(356);Object.defineProperty(t,"isEmbeddedTileset",{enumerable:!0,get:function(){return y.isEmbeddedTileset}}),Object.defineProperty(t,"isTilesetRef",{enumerable:!0,get:function(){return y.isTilesetRef}});var f=i(7811);Object.defineProperty(t,"FillMode",{enumerable:!0,get:function(){return f.FillMode}});var _=i(9781);Object.defineProperty(t,"ObjectAlignment",{enumerable:!0,get:function(){return _.ObjectAlignment}});var w=i(738);Object.defineProperty(t,"TileRenderSize",{enumerable:!0,get:function(){return w.TileRenderSize}});var v=i(9247);Object.defineProperty(t,"WangSetType",{enumerable:!0,get:function(){return v.WangSetType}})},5734:()=>{},6627:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isGroup=t.isImageLayer=t.isObjectGroup=t.isUnencodedTileLayer=t.isEncodedTileLayer=t.isTileLayer=void 0;const s=i(5222);t.isTileLayer=function(e){return"tilelayer"===e.type},t.isEncodedTileLayer=function(e){return"tilelayer"===e.type&&e.encoding!==s.Encoding.CSV},t.isUnencodedTileLayer=function(e){return"tilelayer"===e.type&&(null==e.encoding||e.encoding===s.Encoding.CSV)},t.isObjectGroup=function(e){return"objectgroup"===e.type},t.isImageLayer=function(e){return"imagelayer"===e.type},t.isGroup=function(e){return"group"===e.type}},8913:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.Compression=void 0,function(e){e.NONE="",e.GZIP="gzip",e.ZLIB="zlib",e.ZSTD="zstd"}(i||(t.Compression=i={}))},6889:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.DrawOrder=void 0,function(e){e.TOPDOWN="topdown",e.INDEX="index"}(i||(t.DrawOrder=i={}))},5222:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.Encoding=void 0,function(e){e.CSV="csv",e.BASE64="base64"}(i||(t.Encoding=i={}))},6381:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decodeTileLayer=void 0;const s=i(9742),n=i(3531),a=i(9591),r=i(6627),o=i(8913),h=i(5222),l={[h.Encoding.BASE64]:s.toByteArray},d={[o.Compression.NONE]:e=>e,[o.Compression.ZLIB]:a.inflate,[o.Compression.GZIP]:a.ungzip,[o.Compression.ZSTD]:n.decompress};t.decodeTileLayer=function(e){if((0,r.isUnencodedTileLayer)(e))return e;const t=l[e.encoding],i=d[e.compression??o.Compression.NONE],s=e=>Array.from(new Uint32Array(e.buffer,e.byteOffset));return{...e,compression:o.Compression.NONE,encoding:h.Encoding.CSV,data:null!=e.data?s(i(t(e.data))):void 0,chunks:e.chunks?.map((e=>({...e,data:s(i(t(e.data)))})))}}},9539:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MapOrientation=void 0,function(e){e.ORTHOGONAL="orthogonal",e.ISOMETRIC="isometric",e.STAGGERED="staggered",e.HEXAGONAL="hexagonal"}(i||(t.MapOrientation=i={}))},8554:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MapRenderOrder=void 0,function(e){e.RIGHT_DOWN="right-down",e.RIGHT_UP="right-up",e.LEFT_DOWN="left-down",e.LEFT_UP="left-up"}(i||(t.MapRenderOrder=i={}))},897:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.StaggerAxis=void 0,function(e){e.X="x",e.Y="y"}(i||(t.StaggerAxis=i={}))},9481:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.StaggerIndex=void 0,function(e){e.ODD="odd",e.EVEN="even"}(i||(t.StaggerIndex=i={}))},7360:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.PropertyType=void 0,function(e){e.STRING="string",e.INT="int",e.FLOAT="float",e.BOOL="bool",e.COLOR="color",e.FILE="file",e.OBJECT="object",e.CLASS="class"}(i||(t.PropertyType=i={}))},5178:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.HorizontalAlign=void 0,function(e){e.CENTER="center",e.RIGHT="right",e.JUSTIFY="justify",e.LEFT="left"}(i||(t.HorizontalAlign=i={}))},8761:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlign=void 0,function(e){e.CENTER="center",e.BOTTOM="bottom",e.TOP="top"}(i||(t.VerticalAlign=i={}))},356:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isTilesetRef=t.isEmbeddedTileset=void 0,t.isEmbeddedTileset=function(e){return null==e.source},t.isTilesetRef=function(e){return null!=e.source}},7811:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.FillMode=void 0,function(e){e.STRETCH="stretch",e.PRESERVE_ASPECT_FIT="preserve-aspect-fit"}(i||(t.FillMode=i={}))},9781:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectAlignment=void 0,function(e){e.UNSPECIFIED="unspecified",e.TOPLEFT="topleft",e.TOP="top",e.TOPRIGHT="topright",e.LEFT="left",e.CENTER="center",e.RIGHT="right",e.BOTTOMLEFT="bottomleft",e.BOTTOM="bottom",e.BOTTOMRIGHT="bottomright"}(i||(t.ObjectAlignment=i={}))},738:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.TileRenderSize=void 0,function(e){e.TILE="tile",e.GRID="grid"}(i||(t.TileRenderSize=i={}))},9247:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.WangSetType=void 0,function(e){e.CORNER="corner",e.EDGE="edge",e.MIXED="mixed"}(i||(t.WangSetType=i={}))},9742:(e,t)=>{t.byteLength=function(e){var t=o(e),i=t[0],s=t[1];return 3*(i+s)/4-s},t.toByteArray=function(e){var t,i,a=o(e),r=a[0],h=a[1],l=new n(function(e,t,i){return 3*(t+i)/4-i}(0,r,h)),d=0,u=h>0?r-4:r;for(i=0;i<u;i+=4)t=s[e.charCodeAt(i)]<<18|s[e.charCodeAt(i+1)]<<12|s[e.charCodeAt(i+2)]<<6|s[e.charCodeAt(i+3)],l[d++]=t>>16&255,l[d++]=t>>8&255,l[d++]=255&t;return 2===h&&(t=s[e.charCodeAt(i)]<<2|s[e.charCodeAt(i+1)]>>4,l[d++]=255&t),1===h&&(t=s[e.charCodeAt(i)]<<10|s[e.charCodeAt(i+1)]<<4|s[e.charCodeAt(i+2)]>>2,l[d++]=t>>8&255,l[d++]=255&t),l},t.fromByteArray=function(e){for(var t,s=e.length,n=s%3,a=[],r=16383,o=0,l=s-n;o<l;o+=r)a.push(h(e,o,o+r>l?l:o+r));return 1===n?(t=e[s-1],a.push(i[t>>2]+i[t<<4&63]+"==")):2===n&&(t=(e[s-2]<<8)+e[s-1],a.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"=")),a.join("")};for(var i=[],s=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0;r<64;++r)i[r]=a[r],s[a.charCodeAt(r)]=r;function o(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function h(e,t,s){for(var n,a,r=[],o=t;o<s;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),r.push(i[(a=n)>>18&63]+i[a>>12&63]+i[a>>6&63]+i[63&a]);return r.join("")}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},3531:(e,t)=>{var i=ArrayBuffer,s=Uint8Array,n=Uint16Array,a=Int16Array,r=Int32Array,o=function(e,t,i){if(s.prototype.slice)return s.prototype.slice.call(e,t,i);(null==t||t<0)&&(t=0),(null==i||i>e.length)&&(i=e.length);var n=new s(i-t);return n.set(e.subarray(t,i)),n},h=function(e,t,i,n){if(s.prototype.fill)return s.prototype.fill.call(e,t,i,n);for((null==i||i<0)&&(i=0),(null==n||n>e.length)&&(n=e.length);i<n;++i)e[i]=t;return e},l=function(e,t,i,n){if(s.prototype.copyWithin)return s.prototype.copyWithin.call(e,t,i,n);for((null==i||i<0)&&(i=0),(null==n||n>e.length)&&(n=e.length);i<n;)e[t++]=e[i++]};t.ZstdErrorCode={InvalidData:0,WindowSizeTooLarge:1,InvalidBlockType:2,FSEAccuracyTooHigh:3,DistanceTooFarBack:4,UnexpectedEOF:5};var d=["invalid zstd data","window size too large (>2046MB)","invalid block type","FSE accuracy too high","match distance too far back","unexpected EOF"],u=function(e,t,i){var s=new Error(t||d[e]);if(s.code=e,Error.captureStackTrace&&Error.captureStackTrace(s,u),!i)throw s;return s},c=function(e,t,i){for(var s=0,n=0;s<i;++s)n|=e[t++]<<(s<<3);return n},p=function(e,t){var i,n=e[0]|e[1]<<8|e[2]<<16;if(3126568==n&&253==e[3]){var a=e[4],o=a>>5&1,h=a>>2&1,l=3&a,d=a>>6;8&a&&u(0);var p=6-o,g=3==l?4:l,m=c(e,p,g),y=d?1<<d:o,f=c(e,p+=g,y)+(1==d&&256),_=f;if(!o){var w=1<<10+(e[5]>>3);_=w+(w>>3)*(7&e[5])}_>2145386496&&u(1);var v=new s((1==t?f||_:t?0:_)+12);return v[0]=1,v[4]=4,v[8]=8,{b:p+y,y:0,l:0,d:m,w:t&&1!=t?t:v.subarray(12),e:_,o:new r(v.buffer,0,3),u:f,c:h,m:Math.min(131072,_)}}if(25481893==(n>>4|e[3]<<20))return 8+(((i=e)[4]|i[5]<<8|i[6]<<16|i[7]<<24)>>>0);u(0)},g=function(e){for(var t=0;1<<t<=e;++t);return t-1},m=function(e,t,r){var o=4+(t<<3),h=5+(15&e[t]);h>r&&u(3);for(var l=1<<h,d=l,c=-1,p=-1,m=-1,y=l,f=new i(512+(l<<2)),_=new a(f,0,256),w=new n(f,0,256),v=new n(f,512,l),b=512+(l<<1),T=new s(f,b,l),E=new s(f,b+l);c<255&&d>0;){var I=g(d+1),A=o>>3,S=(1<<I+1)-1,x=(e[A]|e[A+1]<<8|e[A+2]<<16)>>(7&o)&S,O=(1<<I)-1,C=S-d-1,P=x&O;if(P<C?(o+=I,x=P):(o+=I+1,x>O&&(x-=C)),_[++c]=--x,-1==x?(d+=x,T[--y]=c):d-=x,!x)do{var k=o>>3;p=(e[k]|e[k+1]<<8)>>(7&o)&3,o+=2,c+=p}while(3==p)}(c>255||d)&&u(0);for(var M=0,N=(l>>1)+(l>>3)+3,R=l-1,D=0;D<=c;++D){var L=_[D];if(L<1)w[D]=-L;else for(m=0;m<L;++m){T[M]=D;do{M=M+N&R}while(M>=y)}}for(M&&u(0),m=0;m<l;++m){var F=w[T[m]]++,G=E[m]=h-g(F);v[m]=(F<<G)-l}return[o+7>>3,{b:h,s:T,n:E,t:v}]},y=m(new s([81,16,99,140,49,198,24,99,12,33,196,24,99,102,102,134,70,146,4]),0,6)[1],f=m(new s([33,20,196,24,99,140,33,132,16,66,8,33,132,16,66,8,33,68,68,68,68,68,68,68,68,36,9]),0,6)[1],_=m(new s([32,132,16,66,102,70,68,68,68,68,36,73,2]),0,5)[1],w=function(e,t){for(var i=e.length,s=new r(i),n=0;n<i;++n)s[n]=t,t+=1<<e[n];return s},v=new s(new r([0,0,0,0,16843009,50528770,134678020,202050057,269422093]).buffer,0,36),b=w(v,0),T=new s(new r([0,0,0,0,0,0,0,0,16843009,50528770,117769220,185207048,252579084,16]).buffer,0,53),E=w(T,3),I=function(e,t,i){var s=e.length,n=t.length,a=e[s-1],r=(1<<i.b)-1,o=-i.b;a||u(0);for(var h=0,l=i.b,d=(s<<3)-8+g(a)-l,c=-1;d>o&&c<n;){var p=d>>3;h=(h<<l|(e[p]|e[p+1]<<8|e[p+2]<<16)>>(7&d))&r,t[++c]=i.s[h],d-=l=i.n[h]}d==o&&c+1==n||u(0)},A=function(e,t,i){var s=6,n=t.length+3>>2,a=n<<1,r=n+a;I(e.subarray(s,s+=e[0]|e[1]<<8),t.subarray(0,n),i),I(e.subarray(s,s+=e[2]|e[3]<<8),t.subarray(n,a),i),I(e.subarray(s,s+=e[4]|e[5]<<8),t.subarray(a,r),i),I(e.subarray(s),t.subarray(r),i)},S=function(e,t,i){var a,r=t.b,l=e[r],d=l>>1&3;t.l=1&l;var c=l>>3|e[r+1]<<5|e[r+2]<<13,p=(r+=3)+c;if(1==d){if(r>=e.length)return;return t.b=r+1,i?(h(i,e[r],t.y,t.y+=c),i):h(new s(c),e[r])}if(!(p>e.length)){if(0==d)return t.b=p,i?(i.set(e.subarray(r,p),t.y),t.y+=c,i):o(e,r,p);if(2==d){var w=e[r],S=3&w,x=w>>2&3,O=w>>4,C=0,P=0;S<2?1&x?O|=e[++r]<<4|(2&x&&e[++r]<<12):O=w>>3:(P=x,x<2?(O|=(63&e[++r])<<4,C=e[r]>>6|e[++r]<<2):2==x?(O|=e[++r]<<4|(3&e[++r])<<12,C=e[r]>>2|e[++r]<<6):(O|=e[++r]<<4|(63&e[++r])<<12,C=e[r]>>6|e[++r]<<2|e[++r]<<10)),++r;var k=i?i.subarray(t.y,t.y+t.m):new s(t.m),M=k.length-O;if(0==S)k.set(e.subarray(r,r+=O),M);else if(1==S)h(k,e[r++],M);else{var N=t.h;if(2==S){var R=function(e,t){var i=0,a=-1,r=new s(292),o=e[t],l=r.subarray(0,256),d=r.subarray(256,268),c=new n(r.buffer,268);if(o<128){var p=m(e,t+1,6),y=p[0],f=p[1],_=y<<3,w=e[t+=o];w||u(0);for(var v=0,b=0,T=f.b,E=T,I=(++t<<3)-8+g(w);!((I-=T)<_);){var A=I>>3;if(v+=(e[A]|e[A+1]<<8)>>(7&I)&(1<<T)-1,l[++a]=f.s[v],(I-=E)<_)break;b+=(e[A=I>>3]|e[A+1]<<8)>>(7&I)&(1<<E)-1,l[++a]=f.s[b],T=f.n[v],v=f.t[v],E=f.n[b],b=f.t[b]}++a>255&&u(0)}else{for(a=o-127;i<a;i+=2){var S=e[++t];l[i]=S>>4,l[i+1]=15&S}++t}var x=0;for(i=0;i<a;++i)(k=l[i])>11&&u(0),x+=k&&1<<k-1;var O=g(x)+1,C=1<<O,P=C-x;for(P&P-1&&u(0),l[a++]=g(P)+1,i=0;i<a;++i){var k=l[i];++d[l[i]=k&&O+1-k]}var M=new s(C<<1),N=M.subarray(0,C),R=M.subarray(C);for(c[O]=0,i=O;i>0;--i){var D=c[i];h(R,i,D,c[i-1]=D+d[i]*(1<<O-i))}for(c[0]!=C&&u(0),i=0;i<a;++i){var L=l[i];if(L){var F=c[L];h(N,i,F,c[L]=F+(1<<O-L))}}return[t,{n:R,b:O,s:N}]}(e,r);C+=r-(r=R[0]),t.h=N=R[1]}else N||u(0);(P?A:I)(e.subarray(r,r+=C),k.subarray(M),N)}var D=e[r++];if(D){255==D?D=32512+(e[r++]|e[r++]<<8):D>127&&(D=D-128<<8|e[r++]);var L=e[r++];3&L&&u(0);for(var F=[f,_,y],G=2;G>-1;--G){var B=L>>2+(G<<1)&3;if(1==B){var j=new s([0,0,e[r++]]);F[G]={s:j.subarray(2,3),n:j.subarray(0,1),t:new n(j.buffer,0,1),b:0}}else 2==B?(r=(a=m(e,r,9-(1&G)))[0],F[G]=a[1]):3==B&&(t.t||u(0),F[G]=t.t[G])}var W=t.t=F,U=W[0],H=W[1],V=W[2],Y=e[p-1];Y||u(0);var z=(p<<3)-8+g(Y)-V.b,Q=z>>3,K=0,X=(e[Q]|e[Q+1]<<8)>>(7&z)&(1<<V.b)-1,J=(e[Q=(z-=H.b)>>3]|e[Q+1]<<8)>>(7&z)&(1<<H.b)-1,Z=(e[Q=(z-=U.b)>>3]|e[Q+1]<<8)>>(7&z)&(1<<U.b)-1;for(++D;--D;){var q=V.s[X],$=V.n[X],ee=U.s[Z],te=U.n[Z],ie=H.s[J],se=H.n[J],ne=1<<ie,ae=ne+((e[Q=(z-=ie)>>3]|e[Q+1]<<8|e[Q+2]<<16|e[Q+3]<<24)>>>(7&z)&ne-1);Q=(z-=T[ee])>>3;var re=E[ee]+((e[Q]|e[Q+1]<<8|e[Q+2]<<16)>>(7&z)&(1<<T[ee])-1);Q=(z-=v[q])>>3;var oe=b[q]+((e[Q]|e[Q+1]<<8|e[Q+2]<<16)>>(7&z)&(1<<v[q])-1);if(Q=(z-=$)>>3,X=V.t[X]+((e[Q]|e[Q+1]<<8)>>(7&z)&(1<<$)-1),Q=(z-=te)>>3,Z=U.t[Z]+((e[Q]|e[Q+1]<<8)>>(7&z)&(1<<te)-1),Q=(z-=se)>>3,J=H.t[J]+((e[Q]|e[Q+1]<<8)>>(7&z)&(1<<se)-1),ae>3)t.o[2]=t.o[1],t.o[1]=t.o[0],t.o[0]=ae-=3;else{var he=ae-(0!=oe);he?(ae=3==he?t.o[0]-1:t.o[he],he>1&&(t.o[2]=t.o[1]),t.o[1]=t.o[0],t.o[0]=ae):ae=t.o[0]}for(G=0;G<oe;++G)k[K+G]=k[M+G];M+=oe;var le=(K+=oe)-ae;if(le<0){var de=-le,ue=t.e+le;for(de>re&&(de=re),G=0;G<de;++G)k[K+G]=t.w[ue+G];K+=de,re-=de,le=0}for(G=0;G<re;++G)k[K+G]=k[le+G];K+=re}if(K!=M)for(;M<k.length;)k[K++]=k[M++];else K=k.length;i?t.y+=K:k=o(k,0,K)}else if(i){if(t.y+=O,M)for(G=0;G<O;++G)k[G]=k[M+G]}else M&&(k=o(k,M));return t.b=p,k}u(2)}},x=function(e,t){if(1==e.length)return e[0];for(var i=new s(t),n=0,a=0;n<e.length;++n){var r=e[n];i.set(r,a),a+=r.length}return i};t.decompress=function(e,t){for(var i=0,s=[],n=+!t,a=0;e.length;){var r=p(e,n||t);if("object"==typeof r){for(n?(t=null,r.w.length==r.u&&(s.push(t=r.w),a+=r.u)):(s.push(t),r.e=0);!r.l;){var o=S(e,r,t);o||u(5),t?r.e=r.y:(s.push(o),a+=o.length,l(r.w,0,o.length),r.w.set(o,r.w.length-o.length))}i=r.b+4*r.c}else i=r;e=e.subarray(i)}return x(s,a)};var O=function(){function e(e){this.ondata=e,this.c=[],this.l=0,this.z=0}return e.prototype.push=function(e,t){if("number"==typeof this.s){var i=Math.min(e.length,this.s);e=e.subarray(i),this.s-=i}var s=e.length+this.l;if(!this.s){if(t){if(!s)return;s<5&&u(5)}else if(s<18)return this.c.push(e),void(this.l=s);if(this.l&&(this.c.push(e),e=x(this.c,s),this.c=[],this.l=0),"number"==typeof(this.s=p(e)))return this.push(e,t)}if("number"!=typeof this.s){if(s<(this.z||4))return t&&u(5),this.c.push(e),void(this.l=s);if(this.l&&(this.c.push(e),e=x(this.c,s),this.c=[],this.l=0),!this.z&&s<(this.z=2&e[this.s.b]?5:4+(e[this.s.b]>>3|e[this.s.b+1]<<5|e[this.s.b+2]<<13)))return t&&u(5),this.c.push(e),void(this.l=s);for(this.z=0;;){var n=S(e,this.s);if(!n){t&&u(5);var a=e.subarray(this.s.b);return this.s.b=0,this.c.push(a),void(this.l+=a.length)}if(this.ondata(n,!1),l(this.s.w,0,n.length),this.s.w.set(n,this.s.w.length-n.length),this.s.l){var r=e.subarray(this.s.b);return this.s=4*this.s.c,void this.push(r,t)}}}},e}();t.Decompress=O},9591:(e,t,i)=>{const{Deflate:s,deflate:n,deflateRaw:a,gzip:r}=i(4555),{Inflate:o,inflate:h,inflateRaw:l,ungzip:d}=i(8843),u=i(1619);e.exports.Deflate=s,e.exports.deflate=n,e.exports.deflateRaw=a,e.exports.gzip=r,e.exports.Inflate=o,e.exports.inflate=h,e.exports.inflateRaw=l,e.exports.ungzip=d,e.exports.constants=u},4555:(e,t,i)=>{const s=i(405),n=i(4236),a=i(9373),r=i(8898),o=i(2292),h=Object.prototype.toString,{Z_NO_FLUSH:l,Z_SYNC_FLUSH:d,Z_FULL_FLUSH:u,Z_FINISH:c,Z_OK:p,Z_STREAM_END:g,Z_DEFAULT_COMPRESSION:m,Z_DEFAULT_STRATEGY:y,Z_DEFLATED:f}=i(1619);function _(e){this.options=n.assign({level:m,method:f,chunkSize:16384,windowBits:15,memLevel:8,strategy:y},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;let i=s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==p)throw new Error(r[i]);if(t.header&&s.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===h.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,i=s.deflateSetDictionary(this.strm,e),i!==p)throw new Error(r[i]);this._dict_set=!0}}function w(e,t){const i=new _(t);if(i.push(e,!0),i.err)throw i.msg||r[i.err];return i.result}_.prototype.push=function(e,t){const i=this.strm,n=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?c:l,"string"==typeof e?i.input=a.string2buf(e):"[object ArrayBuffer]"===h.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),(o===d||o===u)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(r=s.deflate(i,o),r===g)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),r=s.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===p;if(0!==i.avail_out){if(o>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},_.prototype.onData=function(e){this.chunks.push(e)},_.prototype.onEnd=function(e){e===p&&(this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Deflate=_,e.exports.deflate=w,e.exports.deflateRaw=function(e,t){return(t=t||{}).raw=!0,w(e,t)},e.exports.gzip=function(e,t){return(t=t||{}).gzip=!0,w(e,t)},e.exports.constants=i(1619)},8843:(e,t,i)=>{const s=i(7948),n=i(4236),a=i(9373),r=i(8898),o=i(2292),h=i(2401),l=Object.prototype.toString,{Z_NO_FLUSH:d,Z_FINISH:u,Z_OK:c,Z_STREAM_END:p,Z_NEED_DICT:g,Z_STREAM_ERROR:m,Z_DATA_ERROR:y,Z_MEM_ERROR:f}=i(1619);function _(e){this.options=n.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;let i=s.inflateInit2(this.strm,t.windowBits);if(i!==c)throw new Error(r[i]);if(this.header=new h,s.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=a.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=s.inflateSetDictionary(this.strm,t.dictionary),i!==c)))throw new Error(r[i])}function w(e,t){const i=new _(t);if(i.push(e),i.err)throw i.msg||r[i.err];return i.result}_.prototype.push=function(e,t){const i=this.strm,n=this.options.chunkSize,r=this.options.dictionary;let o,h,_;if(this.ended)return!1;for(h=t===~~t?t:!0===t?u:d,"[object ArrayBuffer]"===l.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),o=s.inflate(i,h),o===g&&r&&(o=s.inflateSetDictionary(i,r),o===c?o=s.inflate(i,h):o===y&&(o=g));i.avail_in>0&&o===p&&i.state.wrap>0&&0!==e[i.next_in];)s.inflateReset(i),o=s.inflate(i,h);switch(o){case m:case y:case g:case f:return this.onEnd(o),this.ended=!0,!1}if(_=i.avail_out,i.next_out&&(0===i.avail_out||o===p))if("string"===this.options.to){let e=a.utf8border(i.output,i.next_out),t=i.next_out-e,s=a.buf2string(i.output,e);i.next_out=t,i.avail_out=n-t,t&&i.output.set(i.output.subarray(e,e+t),0),this.onData(s)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(o!==c||0!==_){if(o===p)return o=s.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},_.prototype.onData=function(e){this.chunks.push(e)},_.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Inflate=_,e.exports.inflate=w,e.exports.inflateRaw=function(e,t){return(t=t||{}).raw=!0,w(e,t)},e.exports.ungzip=w,e.exports.constants=i(1619)},4236:e=>{const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);e.exports.assign=function(e){const i=Array.prototype.slice.call(arguments,1);for(;i.length;){const s=i.shift();if(s){if("object"!=typeof s)throw new TypeError(s+"must be non-object");for(const i in s)t(s,i)&&(e[i]=s[i])}}return e},e.exports.flattenChunks=e=>{let t=0;for(let i=0,s=e.length;i<s;i++)t+=e[i].length;const i=new Uint8Array(t);for(let t=0,s=0,n=e.length;t<n;t++){let n=e[t];i.set(n,s),s+=n.length}return i}},9373:e=>{let t=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){t=!1}const i=new Uint8Array(256);for(let e=0;e<256;e++)i[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;i[254]=i[254]=1,e.exports.string2buf=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,i,s,n,a,r=e.length,o=0;for(n=0;n<r;n++)i=e.charCodeAt(n),55296==(64512&i)&&n+1<r&&(s=e.charCodeAt(n+1),56320==(64512&s)&&(i=65536+(i-55296<<10)+(s-56320),n++)),o+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(o),a=0,n=0;a<o;n++)i=e.charCodeAt(n),55296==(64512&i)&&n+1<r&&(s=e.charCodeAt(n+1),56320==(64512&s)&&(i=65536+(i-55296<<10)+(s-56320),n++)),i<128?t[a++]=i:i<2048?(t[a++]=192|i>>>6,t[a++]=128|63&i):i<65536?(t[a++]=224|i>>>12,t[a++]=128|i>>>6&63,t[a++]=128|63&i):(t[a++]=240|i>>>18,t[a++]=128|i>>>12&63,t[a++]=128|i>>>6&63,t[a++]=128|63&i);return t},e.exports.buf2string=(e,s)=>{const n=s||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,s));let a,r;const o=new Array(2*n);for(r=0,a=0;a<n;){let t=e[a++];if(t<128){o[r++]=t;continue}let s=i[t];if(s>4)o[r++]=65533,a+=s-1;else{for(t&=2===s?31:3===s?15:7;s>1&&a<n;)t=t<<6|63&e[a++],s--;s>1?o[r++]=65533:t<65536?o[r++]=t:(t-=65536,o[r++]=55296|t>>10&1023,o[r++]=56320|1023&t)}}return((e,i)=>{if(i<65534&&e.subarray&&t)return String.fromCharCode.apply(null,e.length===i?e:e.subarray(0,i));let s="";for(let t=0;t<i;t++)s+=String.fromCharCode(e[t]);return s})(o,r)},e.exports.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let s=t-1;for(;s>=0&&128==(192&e[s]);)s--;return s<0||0===s?t:s+i[e[s]]>t?s:t}},6069:e=>{e.exports=(e,t,i,s)=>{let n=65535&e|0,a=e>>>16&65535|0,r=0;for(;0!==i;){r=i>2e3?2e3:i,i-=r;do{n=n+t[s++]|0,a=a+n|0}while(--r);n%=65521,a%=65521}return n|a<<16|0}},1619:e=>{e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},2869:e=>{const t=new Uint32Array((()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t})());e.exports=(e,i,s,n)=>{const a=t,r=n+s;e^=-1;for(let t=n;t<r;t++)e=e>>>8^a[255&(e^i[t])];return-1^e}},405:(e,t,i)=>{const{_tr_init:s,_tr_stored_block:n,_tr_flush_block:a,_tr_tally:r,_tr_align:o}=i(342),h=i(6069),l=i(2869),d=i(8898),{Z_NO_FLUSH:u,Z_PARTIAL_FLUSH:c,Z_FULL_FLUSH:p,Z_FINISH:g,Z_BLOCK:m,Z_OK:y,Z_STREAM_END:f,Z_STREAM_ERROR:_,Z_DATA_ERROR:w,Z_BUF_ERROR:v,Z_DEFAULT_COMPRESSION:b,Z_FILTERED:T,Z_HUFFMAN_ONLY:E,Z_RLE:I,Z_FIXED:A,Z_DEFAULT_STRATEGY:S,Z_UNKNOWN:x,Z_DEFLATED:O}=i(1619),C=258,P=262,k=42,M=113,N=666,R=(e,t)=>(e.msg=d[t],t),D=e=>2*e-(e>4?9:0),L=e=>{let t=e.length;for(;--t>=0;)e[t]=0},F=e=>{let t,i,s,n=e.w_size;t=e.hash_size,s=t;do{i=e.head[--s],e.head[s]=i>=n?i-n:0}while(--t);t=n,s=t;do{i=e.prev[--s],e.prev[s]=i>=n?i-n:0}while(--t)};let G=(e,t,i)=>(t<<e.hash_shift^i)&e.hash_mask;const B=e=>{const t=e.state;let i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},j=(e,t)=>{a(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,B(e.strm)},W=(e,t)=>{e.pending_buf[e.pending++]=t},U=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},H=(e,t,i,s)=>{let n=e.avail_in;return n>s&&(n=s),0===n?0:(e.avail_in-=n,t.set(e.input.subarray(e.next_in,e.next_in+n),i),1===e.state.wrap?e.adler=h(e.adler,t,n,i):2===e.state.wrap&&(e.adler=l(e.adler,t,n,i)),e.next_in+=n,e.total_in+=n,n)},V=(e,t)=>{let i,s,n=e.max_chain_length,a=e.strstart,r=e.prev_length,o=e.nice_match;const h=e.strstart>e.w_size-P?e.strstart-(e.w_size-P):0,l=e.window,d=e.w_mask,u=e.prev,c=e.strstart+C;let p=l[a+r-1],g=l[a+r];e.prev_length>=e.good_match&&(n>>=2),o>e.lookahead&&(o=e.lookahead);do{if(i=t,l[i+r]===g&&l[i+r-1]===p&&l[i]===l[a]&&l[++i]===l[a+1]){a+=2,i++;do{}while(l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&a<c);if(s=C-(c-a),a=c-C,s>r){if(e.match_start=t,r=s,s>=o)break;p=l[a+r-1],g=l[a+r]}}}while((t=u[t&d])>h&&0!=--n);return r<=e.lookahead?r:e.lookahead},Y=e=>{const t=e.w_size;let i,s,n;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-P)&&(e.window.set(e.window.subarray(t,t+t-s),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),F(e),s+=t),0===e.strm.avail_in)break;if(i=H(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=i,e.lookahead+e.insert>=3)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=G(e,e.ins_h,e.window[n+1]);e.insert&&(e.ins_h=G(e,e.ins_h,e.window[n+3-1]),e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<P&&0!==e.strm.avail_in)},z=(e,t)=>{let i,s,a,r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,o=0,h=e.strm.avail_in;do{if(i=65535,a=e.bi_valid+42>>3,e.strm.avail_out<a)break;if(a=e.strm.avail_out-a,s=e.strstart-e.block_start,i>s+e.strm.avail_in&&(i=s+e.strm.avail_in),i>a&&(i=a),i<r&&(0===i&&t!==g||t===u||i!==s+e.strm.avail_in))break;o=t===g&&i===s+e.strm.avail_in?1:0,n(e,0,0,o),e.pending_buf[e.pending-4]=i,e.pending_buf[e.pending-3]=i>>8,e.pending_buf[e.pending-2]=~i,e.pending_buf[e.pending-1]=~i>>8,B(e.strm),s&&(s>i&&(s=i),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+s),e.strm.next_out),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s,e.block_start+=s,i-=s),i&&(H(e.strm,e.strm.output,e.strm.next_out,i),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i)}while(0===o);return h-=e.strm.avail_in,h&&(h>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=h&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-h,e.strm.next_in),e.strstart),e.strstart+=h,e.insert+=h>e.w_size-e.insert?e.w_size-e.insert:h),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?4:t!==u&&t!==g&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(a=e.window_size-e.strstart,e.strm.avail_in>a&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,a+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),a>e.strm.avail_in&&(a=e.strm.avail_in),a&&(H(e.strm,e.window,e.strstart,a),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.high_water<e.strstart&&(e.high_water=e.strstart),a=e.bi_valid+42>>3,a=e.pending_buf_size-a>65535?65535:e.pending_buf_size-a,r=a>e.w_size?e.w_size:a,s=e.strstart-e.block_start,(s>=r||(s||t===g)&&t!==u&&0===e.strm.avail_in&&s<=a)&&(i=s>a?a:s,o=t===g&&0===e.strm.avail_in&&i===s?1:0,n(e,e.block_start,i,o),e.block_start+=i,B(e.strm)),o?3:1)},Q=(e,t)=>{let i,s;for(;;){if(e.lookahead<P){if(Y(e),e.lookahead<P&&t===u)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=G(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-P&&(e.match_length=V(e,i)),e.match_length>=3)if(s=r(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=G(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=G(e,e.ins_h,e.window[e.strstart+1]);else s=r(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(s&&(j(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===g?(j(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(j(e,!1),0===e.strm.avail_out)?1:2},K=(e,t)=>{let i,s,n;for(;;){if(e.lookahead<P){if(Y(e),e.lookahead<P&&t===u)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=G(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-P&&(e.match_length=V(e,i),e.match_length<=5&&(e.strategy===T||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,s=r(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=G(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,s&&(j(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(s=r(e,0,e.window[e.strstart-1]),s&&j(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(s=r(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===g?(j(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(j(e,!1),0===e.strm.avail_out)?1:2};function X(e,t,i,s,n){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=s,this.func=n}const J=[new X(0,0,0,0,z),new X(4,4,8,4,Q),new X(4,5,16,8,Q),new X(4,6,32,32,Q),new X(4,4,16,16,K),new X(8,16,32,32,K),new X(8,16,128,128,K),new X(8,32,128,256,K),new X(32,128,258,1024,K),new X(32,258,258,4096,K)];function Z(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=O,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),L(this.dyn_ltree),L(this.dyn_dtree),L(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),L(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),L(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const q=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==k&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==M&&t.status!==N?1:0},$=e=>{if(q(e))return R(e,_);e.total_in=e.total_out=0,e.data_type=x;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?k:M,e.adler=2===t.wrap?0:1,t.last_flush=-2,s(t),y},ee=e=>{const t=$(e);var i;return t===y&&((i=e.state).window_size=2*i.w_size,L(i.head),i.max_lazy_match=J[i.level].max_lazy,i.good_match=J[i.level].good_length,i.nice_match=J[i.level].nice_length,i.max_chain_length=J[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),t},te=(e,t,i,s,n,a)=>{if(!e)return _;let r=1;if(t===b&&(t=6),s<0?(r=0,s=-s):s>15&&(r=2,s-=16),n<1||n>9||i!==O||s<8||s>15||t<0||t>9||a<0||a>A||8===s&&1!==r)return R(e,_);8===s&&(s=9);const o=new Z;return e.state=o,o.strm=e,o.status=k,o.wrap=r,o.gzhead=null,o.w_bits=s,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=a,o.method=i,ee(e)};e.exports.deflateInit=(e,t)=>te(e,t,O,15,8,S),e.exports.deflateInit2=te,e.exports.deflateReset=ee,e.exports.deflateResetKeep=$,e.exports.deflateSetHeader=(e,t)=>q(e)||2!==e.state.wrap?_:(e.state.gzhead=t,y),e.exports.deflate=(e,t)=>{if(q(e)||t>m||t<0)return e?R(e,_):_;const i=e.state;if(!e.output||0!==e.avail_in&&!e.input||i.status===N&&t!==g)return R(e,0===e.avail_out?v:_);const s=i.last_flush;if(i.last_flush=t,0!==i.pending){if(B(e),0===e.avail_out)return i.last_flush=-1,y}else if(0===e.avail_in&&D(t)<=D(s)&&t!==g)return R(e,v);if(i.status===N&&0!==e.avail_in)return R(e,v);if(i.status===k&&0===i.wrap&&(i.status=M),i.status===k){let t=O+(i.w_bits-8<<4)<<8,s=-1;if(s=i.strategy>=E||i.level<2?0:i.level<6?1:6===i.level?2:3,t|=s<<6,0!==i.strstart&&(t|=32),t+=31-t%31,U(i,t),0!==i.strstart&&(U(i,e.adler>>>16),U(i,65535&e.adler)),e.adler=1,i.status=M,B(e),0!==i.pending)return i.last_flush=-1,y}if(57===i.status)if(e.adler=0,W(i,31),W(i,139),W(i,8),i.gzhead)W(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),W(i,255&i.gzhead.time),W(i,i.gzhead.time>>8&255),W(i,i.gzhead.time>>16&255),W(i,i.gzhead.time>>24&255),W(i,9===i.level?2:i.strategy>=E||i.level<2?4:0),W(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(W(i,255&i.gzhead.extra.length),W(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=l(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(W(i,0),W(i,0),W(i,0),W(i,0),W(i,0),W(i,9===i.level?2:i.strategy>=E||i.level<2?4:0),W(i,3),i.status=M,B(e),0!==i.pending)return i.last_flush=-1,y;if(69===i.status){if(i.gzhead.extra){let t=i.pending,s=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+s>i.pending_buf_size;){let n=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+n),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>t&&(e.adler=l(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex+=n,B(e),0!==i.pending)return i.last_flush=-1,y;t=0,s-=n}let n=new Uint8Array(i.gzhead.extra);i.pending_buf.set(n.subarray(i.gzindex,i.gzindex+s),i.pending),i.pending+=s,i.gzhead.hcrc&&i.pending>t&&(e.adler=l(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){let t,s=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>s&&(e.adler=l(e.adler,i.pending_buf,i.pending-s,s)),B(e),0!==i.pending)return i.last_flush=-1,y;s=0}t=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,W(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>s&&(e.adler=l(e.adler,i.pending_buf,i.pending-s,s)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){let t,s=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>s&&(e.adler=l(e.adler,i.pending_buf,i.pending-s,s)),B(e),0!==i.pending)return i.last_flush=-1,y;s=0}t=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,W(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>s&&(e.adler=l(e.adler,i.pending_buf,i.pending-s,s))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(B(e),0!==i.pending))return i.last_flush=-1,y;W(i,255&e.adler),W(i,e.adler>>8&255),e.adler=0}if(i.status=M,B(e),0!==i.pending)return i.last_flush=-1,y}if(0!==e.avail_in||0!==i.lookahead||t!==u&&i.status!==N){let s=0===i.level?z(i,t):i.strategy===E?((e,t)=>{let i;for(;;){if(0===e.lookahead&&(Y(e),0===e.lookahead)){if(t===u)return 1;break}if(e.match_length=0,i=r(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(j(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===g?(j(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(j(e,!1),0===e.strm.avail_out)?1:2})(i,t):i.strategy===I?((e,t)=>{let i,s,n,a;const o=e.window;for(;;){if(e.lookahead<=C){if(Y(e),e.lookahead<=C&&t===u)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=e.strstart-1,s=o[n],s===o[++n]&&s===o[++n]&&s===o[++n])){a=e.strstart+C;do{}while(s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&n<a);e.match_length=C-(a-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=r(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=r(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(j(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===g?(j(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(j(e,!1),0===e.strm.avail_out)?1:2})(i,t):J[i.level].func(i,t);if(3!==s&&4!==s||(i.status=N),1===s||3===s)return 0===e.avail_out&&(i.last_flush=-1),y;if(2===s&&(t===c?o(i):t!==m&&(n(i,0,0,!1),t===p&&(L(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),B(e),0===e.avail_out))return i.last_flush=-1,y}return t!==g?y:i.wrap<=0?f:(2===i.wrap?(W(i,255&e.adler),W(i,e.adler>>8&255),W(i,e.adler>>16&255),W(i,e.adler>>24&255),W(i,255&e.total_in),W(i,e.total_in>>8&255),W(i,e.total_in>>16&255),W(i,e.total_in>>24&255)):(U(i,e.adler>>>16),U(i,65535&e.adler)),B(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?y:f)},e.exports.deflateEnd=e=>{if(q(e))return _;const t=e.state.status;return e.state=null,t===M?R(e,w):y},e.exports.deflateSetDictionary=(e,t)=>{let i=t.length;if(q(e))return _;const s=e.state,n=s.wrap;if(2===n||1===n&&s.status!==k||s.lookahead)return _;if(1===n&&(e.adler=h(e.adler,t,i,0)),s.wrap=0,i>=s.w_size){0===n&&(L(s.head),s.strstart=0,s.block_start=0,s.insert=0);let e=new Uint8Array(s.w_size);e.set(t.subarray(i-s.w_size,i),0),t=e,i=s.w_size}const a=e.avail_in,r=e.next_in,o=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,Y(s);s.lookahead>=3;){let e=s.strstart,t=s.lookahead-2;do{s.ins_h=G(s,s.ins_h,s.window[e+3-1]),s.prev[e&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=e,e++}while(--t);s.strstart=e,s.lookahead=2,Y(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=2,s.match_available=0,e.next_in=r,e.input=o,e.avail_in=a,s.wrap=n,y},e.exports.deflateInfo="pako deflate (from Nodeca project)"},2401:e=>{e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},4264:e=>{const t=16209;e.exports=function(e,i){let s,n,a,r,o,h,l,d,u,c,p,g,m,y,f,_,w,v,b,T,E,I,A,S;const x=e.state;s=e.next_in,A=e.input,n=s+(e.avail_in-5),a=e.next_out,S=e.output,r=a-(i-e.avail_out),o=a+(e.avail_out-257),h=x.dmax,l=x.wsize,d=x.whave,u=x.wnext,c=x.window,p=x.hold,g=x.bits,m=x.lencode,y=x.distcode,f=(1<<x.lenbits)-1,_=(1<<x.distbits)-1;e:do{g<15&&(p+=A[s++]<<g,g+=8,p+=A[s++]<<g,g+=8),w=m[p&f];t:for(;;){if(v=w>>>24,p>>>=v,g-=v,v=w>>>16&255,0===v)S[a++]=65535&w;else{if(!(16&v)){if(0==(64&v)){w=m[(65535&w)+(p&(1<<v)-1)];continue t}if(32&v){x.mode=16191;break e}e.msg="invalid literal/length code",x.mode=t;break e}b=65535&w,v&=15,v&&(g<v&&(p+=A[s++]<<g,g+=8),b+=p&(1<<v)-1,p>>>=v,g-=v),g<15&&(p+=A[s++]<<g,g+=8,p+=A[s++]<<g,g+=8),w=y[p&_];i:for(;;){if(v=w>>>24,p>>>=v,g-=v,v=w>>>16&255,!(16&v)){if(0==(64&v)){w=y[(65535&w)+(p&(1<<v)-1)];continue i}e.msg="invalid distance code",x.mode=t;break e}if(T=65535&w,v&=15,g<v&&(p+=A[s++]<<g,g+=8,g<v&&(p+=A[s++]<<g,g+=8)),T+=p&(1<<v)-1,T>h){e.msg="invalid distance too far back",x.mode=t;break e}if(p>>>=v,g-=v,v=a-r,T>v){if(v=T-v,v>d&&x.sane){e.msg="invalid distance too far back",x.mode=t;break e}if(E=0,I=c,0===u){if(E+=l-v,v<b){b-=v;do{S[a++]=c[E++]}while(--v);E=a-T,I=S}}else if(u<v){if(E+=l+u-v,v-=u,v<b){b-=v;do{S[a++]=c[E++]}while(--v);if(E=0,u<b){v=u,b-=v;do{S[a++]=c[E++]}while(--v);E=a-T,I=S}}}else if(E+=u-v,v<b){b-=v;do{S[a++]=c[E++]}while(--v);E=a-T,I=S}for(;b>2;)S[a++]=I[E++],S[a++]=I[E++],S[a++]=I[E++],b-=3;b&&(S[a++]=I[E++],b>1&&(S[a++]=I[E++]))}else{E=a-T;do{S[a++]=S[E++],S[a++]=S[E++],S[a++]=S[E++],b-=3}while(b>2);b&&(S[a++]=S[E++],b>1&&(S[a++]=S[E++]))}break}}break}}while(s<n&&a<o);b=g>>3,s-=b,g-=b<<3,p&=(1<<g)-1,e.next_in=s,e.next_out=a,e.avail_in=s<n?n-s+5:5-(s-n),e.avail_out=a<o?o-a+257:257-(a-o),x.hold=p,x.bits=g}},7948:(e,t,i)=>{const s=i(6069),n=i(2869),a=i(4264),r=i(6973),{Z_FINISH:o,Z_BLOCK:h,Z_TREES:l,Z_OK:d,Z_STREAM_END:u,Z_NEED_DICT:c,Z_STREAM_ERROR:p,Z_DATA_ERROR:g,Z_MEM_ERROR:m,Z_BUF_ERROR:y,Z_DEFLATED:f}=i(1619),_=16180,w=16190,v=16191,b=16192,T=16194,E=16199,I=16200,A=16206,S=16209,x=16210,O=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function C(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const P=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<_||t.mode>16211?1:0},k=e=>{if(P(e))return p;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=_,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,d},M=e=>{if(P(e))return p;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,k(e)},N=(e,t)=>{let i;if(P(e))return p;const s=e.state;return t<0?(i=0,t=-t):(i=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?p:(null!==s.window&&s.wbits!==t&&(s.window=null),s.wrap=i,s.wbits=t,M(e))},R=(e,t)=>{if(!e)return p;const i=new C;e.state=i,i.strm=e,i.window=null,i.mode=_;const s=N(e,t);return s!==d&&(e.state=null),s};let D,L,F=!0;const G=e=>{if(F){D=new Int32Array(512),L=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(r(1,e.lens,0,288,D,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;r(2,e.lens,0,32,L,0,e.work,{bits:5}),F=!1}e.lencode=D,e.lenbits=9,e.distcode=L,e.distbits=5},B=(e,t,i,s)=>{let n;const a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),s>=a.wsize?(a.window.set(t.subarray(i-a.wsize,i),0),a.wnext=0,a.whave=a.wsize):(n=a.wsize-a.wnext,n>s&&(n=s),a.window.set(t.subarray(i-s,i-s+n),a.wnext),(s-=n)?(a.window.set(t.subarray(i-s,i),0),a.wnext=s,a.whave=a.wsize):(a.wnext+=n,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=n))),0};e.exports.inflateReset=M,e.exports.inflateReset2=N,e.exports.inflateResetKeep=k,e.exports.inflateInit=e=>R(e,15),e.exports.inflateInit2=R,e.exports.inflate=(e,t)=>{let i,C,k,M,N,R,D,L,F,j,W,U,H,V,Y,z,Q,K,X,J,Z,q,$=0;const ee=new Uint8Array(4);let te,ie;const se=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(P(e)||!e.output||!e.input&&0!==e.avail_in)return p;i=e.state,i.mode===v&&(i.mode=b),N=e.next_out,k=e.output,D=e.avail_out,M=e.next_in,C=e.input,R=e.avail_in,L=i.hold,F=i.bits,j=R,W=D,q=d;e:for(;;)switch(i.mode){case _:if(0===i.wrap){i.mode=b;break}for(;F<16;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}if(2&i.wrap&&35615===L){0===i.wbits&&(i.wbits=15),i.check=0,ee[0]=255&L,ee[1]=L>>>8&255,i.check=n(i.check,ee,2,0),L=0,F=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&L)<<8)+(L>>8))%31){e.msg="incorrect header check",i.mode=S;break}if((15&L)!==f){e.msg="unknown compression method",i.mode=S;break}if(L>>>=4,F-=4,Z=8+(15&L),0===i.wbits&&(i.wbits=Z),Z>15||Z>i.wbits){e.msg="invalid window size",i.mode=S;break}i.dmax=1<<i.wbits,i.flags=0,e.adler=i.check=1,i.mode=512&L?16189:v,L=0,F=0;break;case 16181:for(;F<16;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}if(i.flags=L,(255&i.flags)!==f){e.msg="unknown compression method",i.mode=S;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=S;break}i.head&&(i.head.text=L>>8&1),512&i.flags&&4&i.wrap&&(ee[0]=255&L,ee[1]=L>>>8&255,i.check=n(i.check,ee,2,0)),L=0,F=0,i.mode=16182;case 16182:for(;F<32;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}i.head&&(i.head.time=L),512&i.flags&&4&i.wrap&&(ee[0]=255&L,ee[1]=L>>>8&255,ee[2]=L>>>16&255,ee[3]=L>>>24&255,i.check=n(i.check,ee,4,0)),L=0,F=0,i.mode=16183;case 16183:for(;F<16;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}i.head&&(i.head.xflags=255&L,i.head.os=L>>8),512&i.flags&&4&i.wrap&&(ee[0]=255&L,ee[1]=L>>>8&255,i.check=n(i.check,ee,2,0)),L=0,F=0,i.mode=16184;case 16184:if(1024&i.flags){for(;F<16;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}i.length=L,i.head&&(i.head.extra_len=L),512&i.flags&&4&i.wrap&&(ee[0]=255&L,ee[1]=L>>>8&255,i.check=n(i.check,ee,2,0)),L=0,F=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&(U=i.length,U>R&&(U=R),U&&(i.head&&(Z=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(C.subarray(M,M+U),Z)),512&i.flags&&4&i.wrap&&(i.check=n(i.check,C,U,M)),R-=U,M+=U,i.length-=U),i.length))break e;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===R)break e;U=0;do{Z=C[M+U++],i.head&&Z&&i.length<65536&&(i.head.name+=String.fromCharCode(Z))}while(Z&&U<R);if(512&i.flags&&4&i.wrap&&(i.check=n(i.check,C,U,M)),R-=U,M+=U,Z)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===R)break e;U=0;do{Z=C[M+U++],i.head&&Z&&i.length<65536&&(i.head.comment+=String.fromCharCode(Z))}while(Z&&U<R);if(512&i.flags&&4&i.wrap&&(i.check=n(i.check,C,U,M)),R-=U,M+=U,Z)break e}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;F<16;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}if(4&i.wrap&&L!==(65535&i.check)){e.msg="header crc mismatch",i.mode=S;break}L=0,F=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=v;break;case 16189:for(;F<32;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}e.adler=i.check=O(L),L=0,F=0,i.mode=w;case w:if(0===i.havedict)return e.next_out=N,e.avail_out=D,e.next_in=M,e.avail_in=R,i.hold=L,i.bits=F,c;e.adler=i.check=1,i.mode=v;case v:if(t===h||t===l)break e;case b:if(i.last){L>>>=7&F,F-=7&F,i.mode=A;break}for(;F<3;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}switch(i.last=1&L,L>>>=1,F-=1,3&L){case 0:i.mode=16193;break;case 1:if(G(i),i.mode=E,t===l){L>>>=2,F-=2;break e}break;case 2:i.mode=16196;break;case 3:e.msg="invalid block type",i.mode=S}L>>>=2,F-=2;break;case 16193:for(L>>>=7&F,F-=7&F;F<32;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}if((65535&L)!=(L>>>16^65535)){e.msg="invalid stored block lengths",i.mode=S;break}if(i.length=65535&L,L=0,F=0,i.mode=T,t===l)break e;case T:i.mode=16195;case 16195:if(U=i.length,U){if(U>R&&(U=R),U>D&&(U=D),0===U)break e;k.set(C.subarray(M,M+U),N),R-=U,M+=U,D-=U,N+=U,i.length-=U;break}i.mode=v;break;case 16196:for(;F<14;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}if(i.nlen=257+(31&L),L>>>=5,F-=5,i.ndist=1+(31&L),L>>>=5,F-=5,i.ncode=4+(15&L),L>>>=4,F-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=S;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;F<3;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}i.lens[se[i.have++]]=7&L,L>>>=3,F-=3}for(;i.have<19;)i.lens[se[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,te={bits:i.lenbits},q=r(0,i.lens,0,19,i.lencode,0,i.work,te),i.lenbits=te.bits,q){e.msg="invalid code lengths set",i.mode=S;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;$=i.lencode[L&(1<<i.lenbits)-1],Y=$>>>24,z=$>>>16&255,Q=65535&$,!(Y<=F);){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}if(Q<16)L>>>=Y,F-=Y,i.lens[i.have++]=Q;else{if(16===Q){for(ie=Y+2;F<ie;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}if(L>>>=Y,F-=Y,0===i.have){e.msg="invalid bit length repeat",i.mode=S;break}Z=i.lens[i.have-1],U=3+(3&L),L>>>=2,F-=2}else if(17===Q){for(ie=Y+3;F<ie;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}L>>>=Y,F-=Y,Z=0,U=3+(7&L),L>>>=3,F-=3}else{for(ie=Y+7;F<ie;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}L>>>=Y,F-=Y,Z=0,U=11+(127&L),L>>>=7,F-=7}if(i.have+U>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=S;break}for(;U--;)i.lens[i.have++]=Z}}if(i.mode===S)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=S;break}if(i.lenbits=9,te={bits:i.lenbits},q=r(1,i.lens,0,i.nlen,i.lencode,0,i.work,te),i.lenbits=te.bits,q){e.msg="invalid literal/lengths set",i.mode=S;break}if(i.distbits=6,i.distcode=i.distdyn,te={bits:i.distbits},q=r(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,te),i.distbits=te.bits,q){e.msg="invalid distances set",i.mode=S;break}if(i.mode=E,t===l)break e;case E:i.mode=I;case I:if(R>=6&&D>=258){e.next_out=N,e.avail_out=D,e.next_in=M,e.avail_in=R,i.hold=L,i.bits=F,a(e,W),N=e.next_out,k=e.output,D=e.avail_out,M=e.next_in,C=e.input,R=e.avail_in,L=i.hold,F=i.bits,i.mode===v&&(i.back=-1);break}for(i.back=0;$=i.lencode[L&(1<<i.lenbits)-1],Y=$>>>24,z=$>>>16&255,Q=65535&$,!(Y<=F);){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}if(z&&0==(240&z)){for(K=Y,X=z,J=Q;$=i.lencode[J+((L&(1<<K+X)-1)>>K)],Y=$>>>24,z=$>>>16&255,Q=65535&$,!(K+Y<=F);){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}L>>>=K,F-=K,i.back+=K}if(L>>>=Y,F-=Y,i.back+=Y,i.length=Q,0===z){i.mode=16205;break}if(32&z){i.back=-1,i.mode=v;break}if(64&z){e.msg="invalid literal/length code",i.mode=S;break}i.extra=15&z,i.mode=16201;case 16201:if(i.extra){for(ie=i.extra;F<ie;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}i.length+=L&(1<<i.extra)-1,L>>>=i.extra,F-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;$=i.distcode[L&(1<<i.distbits)-1],Y=$>>>24,z=$>>>16&255,Q=65535&$,!(Y<=F);){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}if(0==(240&z)){for(K=Y,X=z,J=Q;$=i.distcode[J+((L&(1<<K+X)-1)>>K)],Y=$>>>24,z=$>>>16&255,Q=65535&$,!(K+Y<=F);){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}L>>>=K,F-=K,i.back+=K}if(L>>>=Y,F-=Y,i.back+=Y,64&z){e.msg="invalid distance code",i.mode=S;break}i.offset=Q,i.extra=15&z,i.mode=16203;case 16203:if(i.extra){for(ie=i.extra;F<ie;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}i.offset+=L&(1<<i.extra)-1,L>>>=i.extra,F-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=S;break}i.mode=16204;case 16204:if(0===D)break e;if(U=W-D,i.offset>U){if(U=i.offset-U,U>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=S;break}U>i.wnext?(U-=i.wnext,H=i.wsize-U):H=i.wnext-U,U>i.length&&(U=i.length),V=i.window}else V=k,H=N-i.offset,U=i.length;U>D&&(U=D),D-=U,i.length-=U;do{k[N++]=V[H++]}while(--U);0===i.length&&(i.mode=I);break;case 16205:if(0===D)break e;k[N++]=i.length,D--,i.mode=I;break;case A:if(i.wrap){for(;F<32;){if(0===R)break e;R--,L|=C[M++]<<F,F+=8}if(W-=D,e.total_out+=W,i.total+=W,4&i.wrap&&W&&(e.adler=i.check=i.flags?n(i.check,k,W,N-W):s(i.check,k,W,N-W)),W=D,4&i.wrap&&(i.flags?L:O(L))!==i.check){e.msg="incorrect data check",i.mode=S;break}L=0,F=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;F<32;){if(0===R)break e;R--,L+=C[M++]<<F,F+=8}if(4&i.wrap&&L!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=S;break}L=0,F=0}i.mode=16208;case 16208:q=u;break e;case S:q=g;break e;case x:return m;default:return p}return e.next_out=N,e.avail_out=D,e.next_in=M,e.avail_in=R,i.hold=L,i.bits=F,(i.wsize||W!==e.avail_out&&i.mode<S&&(i.mode<A||t!==o))&&B(e,e.output,e.next_out,W-e.avail_out)?(i.mode=x,m):(j-=e.avail_in,W-=e.avail_out,e.total_in+=j,e.total_out+=W,i.total+=W,4&i.wrap&&W&&(e.adler=i.check=i.flags?n(i.check,k,W,e.next_out-W):s(i.check,k,W,e.next_out-W)),e.data_type=i.bits+(i.last?64:0)+(i.mode===v?128:0)+(i.mode===E||i.mode===T?256:0),(0===j&&0===W||t===o)&&q===d&&(q=y),q)},e.exports.inflateEnd=e=>{if(P(e))return p;let t=e.state;return t.window&&(t.window=null),e.state=null,d},e.exports.inflateGetHeader=(e,t)=>{if(P(e))return p;const i=e.state;return 0==(2&i.wrap)?p:(i.head=t,t.done=!1,d)},e.exports.inflateSetDictionary=(e,t)=>{const i=t.length;let n,a,r;return P(e)?p:(n=e.state,0!==n.wrap&&n.mode!==w?p:n.mode===w&&(a=1,a=s(a,t,i,0),a!==n.check)?g:(r=B(e,t,i,i),r?(n.mode=x,m):(n.havedict=1,d)))},e.exports.inflateInfo="pako inflate (from Nodeca project)"},6973:e=>{const t=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),i=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),s=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),n=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);e.exports=(e,a,r,o,h,l,d,u)=>{const c=u.bits;let p,g,m,y,f,_,w=0,v=0,b=0,T=0,E=0,I=0,A=0,S=0,x=0,O=0,C=null;const P=new Uint16Array(16),k=new Uint16Array(16);let M,N,R,D=null;for(w=0;w<=15;w++)P[w]=0;for(v=0;v<o;v++)P[a[r+v]]++;for(E=c,T=15;T>=1&&0===P[T];T--);if(E>T&&(E=T),0===T)return h[l++]=20971520,h[l++]=20971520,u.bits=1,0;for(b=1;b<T&&0===P[b];b++);for(E<b&&(E=b),S=1,w=1;w<=15;w++)if(S<<=1,S-=P[w],S<0)return-1;if(S>0&&(0===e||1!==T))return-1;for(k[1]=0,w=1;w<15;w++)k[w+1]=k[w]+P[w];for(v=0;v<o;v++)0!==a[r+v]&&(d[k[a[r+v]]++]=v);if(0===e?(C=D=d,_=20):1===e?(C=t,D=i,_=257):(C=s,D=n,_=0),O=0,v=0,w=b,f=l,I=E,A=0,m=-1,x=1<<E,y=x-1,1===e&&x>852||2===e&&x>592)return 1;for(;;){M=w-A,d[v]+1<_?(N=0,R=d[v]):d[v]>=_?(N=D[d[v]-_],R=C[d[v]-_]):(N=96,R=0),p=1<<w-A,g=1<<I,b=g;do{g-=p,h[f+(O>>A)+g]=M<<24|N<<16|R|0}while(0!==g);for(p=1<<w-1;O&p;)p>>=1;if(0!==p?(O&=p-1,O+=p):O=0,v++,0==--P[w]){if(w===T)break;w=a[r+d[v]]}if(w>E&&(O&y)!==m){for(0===A&&(A=E),f+=b,I=w-A,S=1<<I;I+A<T&&(S-=P[I+A],!(S<=0));)I++,S<<=1;if(x+=1<<I,1===e&&x>852||2===e&&x>592)return 1;m=O&y,h[m]=E<<24|I<<16|f-l|0}}return 0!==O&&(h[f+O]=w-A<<24|64<<16|0),u.bits=E,0}},8898:e=>{e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},342:e=>{function t(e){let t=e.length;for(;--t>=0;)e[t]=0}const i=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),s=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),n=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),a=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),r=new Array(576);t(r);const o=new Array(60);t(o);const h=new Array(512);t(h);const l=new Array(256);t(l);const d=new Array(29);t(d);const u=new Array(30);function c(e,t,i,s,n){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=s,this.max_length=n,this.has_stree=e&&e.length}let p,g,m;function y(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}t(u);const f=e=>e<256?h[e]:h[256+(e>>>7)],_=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},w=(e,t,i)=>{e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,_(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},v=(e,t,i)=>{w(e,i[2*t],i[2*t+1])},b=(e,t)=>{let i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1},T=(e,t,i)=>{const s=new Array(16);let n,a,r=0;for(n=1;n<=15;n++)r=r+i[n-1]<<1,s[n]=r;for(a=0;a<=t;a++){let t=e[2*a+1];0!==t&&(e[2*a]=b(s[t]++,t))}},E=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},I=e=>{e.bi_valid>8?_(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},A=(e,t,i,s)=>{const n=2*t,a=2*i;return e[n]<e[a]||e[n]===e[a]&&s[t]<=s[i]},S=(e,t,i)=>{const s=e.heap[i];let n=i<<1;for(;n<=e.heap_len&&(n<e.heap_len&&A(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!A(t,s,e.heap[n],e.depth));)e.heap[i]=e.heap[n],i=n,n<<=1;e.heap[i]=s},x=(e,t,n)=>{let a,r,o,h,c=0;if(0!==e.sym_next)do{a=255&e.pending_buf[e.sym_buf+c++],a+=(255&e.pending_buf[e.sym_buf+c++])<<8,r=e.pending_buf[e.sym_buf+c++],0===a?v(e,r,t):(o=l[r],v(e,o+256+1,t),h=i[o],0!==h&&(r-=d[o],w(e,r,h)),a--,o=f(a),v(e,o,n),h=s[o],0!==h&&(a-=u[o],w(e,a,h)))}while(c<e.sym_next);v(e,256,t)},O=(e,t)=>{const i=t.dyn_tree,s=t.stat_desc.static_tree,n=t.stat_desc.has_stree,a=t.stat_desc.elems;let r,o,h,l=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<a;r++)0!==i[2*r]?(e.heap[++e.heap_len]=l=r,e.depth[r]=0):i[2*r+1]=0;for(;e.heap_len<2;)h=e.heap[++e.heap_len]=l<2?++l:0,i[2*h]=1,e.depth[h]=0,e.opt_len--,n&&(e.static_len-=s[2*h+1]);for(t.max_code=l,r=e.heap_len>>1;r>=1;r--)S(e,i,r);h=a;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],S(e,i,1),o=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=o,i[2*h]=i[2*r]+i[2*o],e.depth[h]=(e.depth[r]>=e.depth[o]?e.depth[r]:e.depth[o])+1,i[2*r+1]=i[2*o+1]=h,e.heap[1]=h++,S(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const i=t.dyn_tree,s=t.max_code,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,r=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,h=t.stat_desc.max_length;let l,d,u,c,p,g,m=0;for(c=0;c<=15;c++)e.bl_count[c]=0;for(i[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)d=e.heap[l],c=i[2*i[2*d+1]+1]+1,c>h&&(c=h,m++),i[2*d+1]=c,d>s||(e.bl_count[c]++,p=0,d>=o&&(p=r[d-o]),g=i[2*d],e.opt_len+=g*(c+p),a&&(e.static_len+=g*(n[2*d+1]+p)));if(0!==m){do{for(c=h-1;0===e.bl_count[c];)c--;e.bl_count[c]--,e.bl_count[c+1]+=2,e.bl_count[h]--,m-=2}while(m>0);for(c=h;0!==c;c--)for(d=e.bl_count[c];0!==d;)u=e.heap[--l],u>s||(i[2*u+1]!==c&&(e.opt_len+=(c-i[2*u+1])*i[2*u],i[2*u+1]=c),d--)}})(e,t),T(i,l,e.bl_count)},C=(e,t,i)=>{let s,n,a=-1,r=t[1],o=0,h=7,l=4;for(0===r&&(h=138,l=3),t[2*(i+1)+1]=65535,s=0;s<=i;s++)n=r,r=t[2*(s+1)+1],++o<h&&n===r||(o<l?e.bl_tree[2*n]+=o:0!==n?(n!==a&&e.bl_tree[2*n]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,a=n,0===r?(h=138,l=3):n===r?(h=6,l=3):(h=7,l=4))},P=(e,t,i)=>{let s,n,a=-1,r=t[1],o=0,h=7,l=4;for(0===r&&(h=138,l=3),s=0;s<=i;s++)if(n=r,r=t[2*(s+1)+1],!(++o<h&&n===r)){if(o<l)do{v(e,n,e.bl_tree)}while(0!=--o);else 0!==n?(n!==a&&(v(e,n,e.bl_tree),o--),v(e,16,e.bl_tree),w(e,o-3,2)):o<=10?(v(e,17,e.bl_tree),w(e,o-3,3)):(v(e,18,e.bl_tree),w(e,o-11,7));o=0,a=n,0===r?(h=138,l=3):n===r?(h=6,l=3):(h=7,l=4)}};let k=!1;const M=(e,t,i,s)=>{w(e,0+(s?1:0),3),I(e),_(e,i),_(e,~i),i&&e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i};e.exports._tr_init=e=>{k||((()=>{let e,t,a,y,f;const _=new Array(16);for(a=0,y=0;y<28;y++)for(d[y]=a,e=0;e<1<<i[y];e++)l[a++]=y;for(l[a-1]=y,f=0,y=0;y<16;y++)for(u[y]=f,e=0;e<1<<s[y];e++)h[f++]=y;for(f>>=7;y<30;y++)for(u[y]=f<<7,e=0;e<1<<s[y]-7;e++)h[256+f++]=y;for(t=0;t<=15;t++)_[t]=0;for(e=0;e<=143;)r[2*e+1]=8,e++,_[8]++;for(;e<=255;)r[2*e+1]=9,e++,_[9]++;for(;e<=279;)r[2*e+1]=7,e++,_[7]++;for(;e<=287;)r[2*e+1]=8,e++,_[8]++;for(T(r,287,_),e=0;e<30;e++)o[2*e+1]=5,o[2*e]=b(e,5);p=new c(r,i,257,286,15),g=new c(o,s,0,30,15),m=new c(new Array(0),n,0,19,7)})(),k=!0),e.l_desc=new y(e.dyn_ltree,p),e.d_desc=new y(e.dyn_dtree,g),e.bl_desc=new y(e.bl_tree,m),e.bi_buf=0,e.bi_valid=0,E(e)},e.exports._tr_stored_block=M,e.exports._tr_flush_block=(e,t,i,s)=>{let n,h,l=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),O(e,e.l_desc),O(e,e.d_desc),l=(e=>{let t;for(C(e,e.dyn_ltree,e.l_desc.max_code),C(e,e.dyn_dtree,e.d_desc.max_code),O(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*a[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),n=e.opt_len+3+7>>>3,h=e.static_len+3+7>>>3,h<=n&&(n=h)):n=h=i+5,i+4<=n&&-1!==t?M(e,t,i,s):4===e.strategy||h===n?(w(e,2+(s?1:0),3),x(e,r,o)):(w(e,4+(s?1:0),3),((e,t,i,s)=>{let n;for(w(e,t-257,5),w(e,i-1,5),w(e,s-4,4),n=0;n<s;n++)w(e,e.bl_tree[2*a[n]+1],3);P(e,e.dyn_ltree,t-1),P(e,e.dyn_dtree,i-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),x(e,e.dyn_ltree,e.dyn_dtree)),E(e),s&&I(e)},e.exports._tr_tally=(e,t,i)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=i,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(l[i]+256+1)]++,e.dyn_dtree[2*f(t)]++),e.sym_next===e.sym_end),e.exports._tr_align=e=>{w(e,2,3),v(e,256,r),(e=>{16===e.bi_valid?(_(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},2292:e=>{e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},4488:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.STEAM_APP_ID=t.WINDOW_ENDING_FADE_DURATION=t.WINDOW_ENDING_CUTSCENE_DURATION=t.PETTING_ENDING_FADE_DURATION=t.PETTING_ENDING_CUTSCENE_DURATION=t.DIALOG_FONT=t.PLAYER_CARRY_HEIGHT=t.PLAYER_WIDTH=t.PLAYER_HEIGHT=t.DOUBLE_JUMP_COLORS=t.PLAYER_JUMP_TIMING_THRESHOLD=t.TERMINAL_VELOCITY=t.PLAYER_BOUNCE_HEIGHT=t.PLAYER_JUMP_HEIGHT=t.PLAYER_ACCELERATION_AIR=t.PLAYER_ACCELERATION=t.MAX_PLAYER_RUNNING_SPEED=t.MAX_PLAYER_SPEED=t.DROWNING_VELOCITY=t.SHORT_JUMP_GRAVITY=t.GRAVITY=t.SOUND_INTENSITY_MULTIPLIER=t.METER_PER_PIXEL=t.PIXEL_PER_METER=t.GAME_CANVAS_HEIGHT=t.GAME_CANVAS_WIDTH=t.CACHE_NAME=t.APP_NAME=void 0,t.APP_NAME="Friendly Fire",t.CACHE_NAME="v1",t.GAME_CANVAS_WIDTH=480,t.GAME_CANVAS_HEIGHT=270,t.PIXEL_PER_METER=18,t.METER_PER_PIXEL=1/t.PIXEL_PER_METER,t.SOUND_INTENSITY_MULTIPLIER=50,t.GRAVITY=35,t.SHORT_JUMP_GRAVITY=70,t.DROWNING_VELOCITY=-1,t.MAX_PLAYER_SPEED=5,t.MAX_PLAYER_RUNNING_SPEED=7,t.PLAYER_ACCELERATION=30,t.PLAYER_ACCELERATION_AIR=12,t.PLAYER_JUMP_HEIGHT=3.75,t.PLAYER_BOUNCE_HEIGHT=10,t.TERMINAL_VELOCITY=-30,t.PLAYER_JUMP_TIMING_THRESHOLD=.1,t.DOUBLE_JUMP_COLORS=["#ffffff","#cccccc","#aaaaaa"],t.PLAYER_HEIGHT=1.6*t.PIXEL_PER_METER,t.PLAYER_WIDTH=.5*t.PIXEL_PER_METER,t.PLAYER_CARRY_HEIGHT=4,t.DIALOG_FONT="fonts/pixcelsior.font.json",t.PETTING_ENDING_CUTSCENE_DURATION=135,t.PETTING_ENDING_FADE_DURATION=5,t.WINDOW_ENDING_CUTSCENE_DURATION=50,t.WINDOW_ENDING_FADE_DURATION=3,t.STEAM_APP_ID=1311660},2571:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Animator=void 0;const s=i(225);t.Animator=class{constructor(e){this.currentAnimation={tag:"",start:0,duration:0,finished:!1},this.entity=e}assignSprite(e){this.sprite=e}updateAnimation(e,t){this.sprite&&(!this.currentAnimation.finished&&this.currentAnimation.duration>0&&1e3*this.entity.scene.gameTime-this.currentAnimation.start+1e3*this.entity.scene.dt>=this.currentAnimation.duration&&(this.currentAnimation.finished=!0,this.currentAnimation.config?.callback&&this.currentAnimation.config.callback()),this.currentAnimation.tag!==e&&(this.currentAnimation.tag=e,this.currentAnimation.start=1e3*this.entity.scene.gameTime,this.currentAnimation.config=t,this.currentAnimation.finished=!1,this.currentAnimation.duration=this.sprite.getAnimationDurationByTag(e)||0))}play(e,t,i){this.currentAnimation.direction=t,this.updateAnimation(e,i);let s=1e3*this.entity.scene.gameTime-this.currentAnimation.start;if(!1===i?.loop){const e=this.currentAnimation.duration-1;s=Math.min(e,s)}0===s&&(s+=1),this.draw(s)}draw(e){this.sprite&&this.entity.scene.renderer.addAseprite(this.sprite,this.currentAnimation.tag,this.entity.x,this.entity.y,s.RenderingLayer.ENTITIES,this.currentAnimation.direction,e)}}},9797:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Aseprite=void 0;const s=i(3660),n=i(8557),a=i(6070);class r{constructor(e,t,i){this.source=e,this.json=t,this.image=i,this.frameTags={},this.frameTagDurations={},this.fallbackTag="idle",this.frames=Object.values(t.frames),this.duration=this.frames.reduce(((e,t)=>e+t.duration),0);for(const e of t.meta.frameTags??[]){let t=0;for(let i=e.from;i<=e.to;i++)t+=this.frames[i].duration;this.frameTags[e.name]=e,this.frameTagDurations[e.name]=t}}static async load(e){const t=await(await fetch(e)).json(),i=new URL(e,location.href),s=await(0,n.loadImage)(new URL(t.meta.image,i));return new r(e,t,s)}get width(){return this.frames[0].sourceSize.w}get height(){return this.frames[0].sourceSize.h}calculateFrameIndex(e=(0,a.now)(),t=this.duration,i=0,n=this.frames.length-1,r=s.Direction.Forward){let o=r===s.Direction.Reverse?-1:1;r===s.Direction.PingPong&&(t=2*t-this.frames[i].duration-this.frames[n].duration);let h=e%t,l=r===s.Direction.Reverse?n:i;for(;(o>0&&l<n||o<0&&l>i)&&h>=this.frames[l].duration;)h-=this.frames[l].duration,l+=o,l===n&&(o=-o);return l}getFrameIndex(e=(0,a.now)()){return this.calculateFrameIndex(e)}drawFrame(e,t,i,s){const n=this.frames[t];if(null==n)throw new Error("Frame index not found: "+t);e.drawImage(this.image,n.frame.x,n.frame.y,n.frame.w,n.frame.h,Math.round(i)+n.spriteSourceSize.x,Math.round(s)+n.spriteSourceSize.y,n.spriteSourceSize.w,n.spriteSourceSize.h)}getTaggedFrameIndex(e,t=(0,a.now)()){const i=this.frameTags[e]??this.frameTags[this.fallbackTag];if(null==i)throw new Error(`Frame tag not found in sprite '${this.source}' and fallback is not available as well. Tag: '${e}' | FallbackTag: '${this.fallbackTag}'`);return this.calculateFrameIndex(t,this.frameTagDurations[e],i.from,i.to,i.direction)}getAnimationDurationByTag(e){const t=this.frameTagDurations[e]||this.frameTagDurations[this.fallbackTag];if(null==t)throw new Error(`Frame tag not found and fallback is not available as well. Tag: '${e}' | FallbackTag: '${this.fallbackTag}'`);return t}drawTag(e,t,i,s,n=(0,a.now)()){this.drawFrame(e,this.getTaggedFrameIndex(t,n),i,s)}draw(e,t,i,s=(0,a.now)()){const n=this.calculateFrameIndex(s);this.drawFrame(e,n,t,i)}getLayer(e){return this.json.meta.layers?.find((t=>t.name===e))??null}}t.Aseprite=r},5943:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Assets=t.asset=void 0;const s=i(9797),n=i(1531),a=i(4973),r=i(8585),o=i(8557),h=new Map;class l{constructor(e,t,i,s){this.target=e,this.propertyKey=t,this.src=i,this.options=s}resolve(e){this.target[this.propertyKey]=this.options.map?this.options.map(e):e}}const d=[];t.asset=function(e,t={}){return(i,s)=>{d.push(new l(i,s,e,t))}},t.Assets=class{async loadAsset(e){let t=h.get(e);if(null==t){if(e.endsWith(".aseprite.json"))t=await s.Aseprite.load(`assets/${e}`);else if(e.endsWith(".font.json"))t=await r.BitmapFont.load(`assets/${e}`);else if(e.endsWith(".png"))t=await(0,o.loadImage)(e);else if(e.endsWith(".mp3")||e.endsWith(".ogg")){const i=e.startsWith("music")?a.SoundChannel.MUSIC:a.SoundChannel.SFX;t=await n.Sound.load(`assets/${e}`,i)}else{if("appinfo.json"!==e)throw new Error(`Unknown asset format: ${e}`);t=await(await fetch("appinfo.json")).json()}h.set(e,t)}return t}async load(e){const t=d.length;let i,s=0;for(e&&e(t,s);null!=(i=d.pop());)"string"==typeof i.src?i.resolve(await this.loadAsset(i.src)):i.resolve(await Promise.all(i.src.map((e=>this.loadAsset(e))))),s++,e&&e(t,s)}}},8585:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BitmapFont=void 0;const s=i(6867),n=i(8557);class a{constructor(e,t,i,s,n,a,r=1){this.sourceImage=e,this.canvas=document.createElement("canvas"),this.charMap=i,this.charHeight=s,this.colorMap=this.prepareColors(t),this.charWidths=n,this.compactablePrecursors=a,this.charStartPoints=[],this.charCount=i.length,this.charReverseMap={};for(let e=0;e<this.charCount;e++){this.charStartPoints[e]=0===e?0:this.charStartPoints[e-1]+this.charWidths[e-1]+r;const t=this.charMap[e];this.charReverseMap[t]=e}}static async load(e){const t=await(await fetch(e)).json(),i=new URL(e,location.href),s=await(0,n.loadImage)(new URL(t.image,i)),r=t.characterMapping.map((e=>e.char)).join(""),o=t.characterMapping.map((e=>e.width)),h=t.characterMapping.map((e=>e.compactablePrecursors??[]));return new a(s,t.colors,r,t.characterHeight,o,h,t.margin)}prepareColors(e){const t={},i=Object.keys(e),s=i.length,a=this.canvas.width=this.sourceImage.width,r=this.charHeight+1;this.canvas.height=r*s;const o=(0,n.getRenderingContext)(this.canvas,"2d");for(let e=0;e<s;e++)t[i[e]]=e,o.drawImage(this.sourceImage,0,r*e);o.globalCompositeOperation="source-in";for(let t=0;t<s;t++)o.fillStyle=e[i[t]],o.save(),o.beginPath(),o.rect(0,r*t,a,r),o.clip(),o.fillRect(0,0,a,r*s),o.restore();return o.globalCompositeOperation="source-over",t}getCharIndex(e){let t=this.charReverseMap[e];return null==t&&(t=this.charCount-1),t}drawCharacter(e,t,i){const s=this.colorMap[i],n="number"==typeof t?t:this.getCharIndex(t),a=this.charStartPoints[n],r=s*(this.charHeight+1);e.drawImage(this.canvas,a,r,this.charWidths[n],this.charHeight,0,0,this.charWidths[n],this.charHeight)}drawText(e,t,i,n,a,r=0,o=1){if(""===t||0===o)return;if(e.save(),e.translate(i,n),s.DisplayManager.getInstance().getRenderMode()!==s.RenderMode.NATIVE&&null!=e.getTransform){const t=e.getTransform();e.translate(Math.round(t.e)-t.e,Math.round(t.f)-t.f)}e.globalAlpha*=o;const{width:h}=this.measureText(t);e.translate(-r*h,0);let l=null;for(const i of t){const t=this.getCharIndex(i),s=null!=l&&this.compactablePrecursors[t].includes(l)?1:0;e.translate(-s,0),this.drawCharacter(e,t,a),e.translate(this.charWidths[t]+1,0),l=i}e.restore()}measureText(e){let t=0,i=null;for(const s of e){const e=this.getCharIndex(s),n=null!=i&&this.compactablePrecursors[e].includes(i)?1:0;t+=this.charWidths[e]-n+1,i=s}return e.length>0&&(t-=1),{width:t,height:this.charHeight}}drawTextWithOutline(e,t,i,s,n,a,r=0){for(let n=s-1;n<=s+1;n++)for(let o=i-1;o<=i+1;o++)o===i&&n===s||this.drawText(e,t,o,n,a,r);this.drawText(e,t,i,s,n,r)}}t.BitmapFont=a},6362:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Camera=void 0;const s=i(6867),n=i(3121),a=i(225),r=i(6070);t.Camera=class{constructor(e,t,i=.5,s=.1){if(this.scene=e,this.target=t,this.barHeight=s,this.x=0,this.y=0,this.zoom=1,this.rotation=0,this.focuses=[],this.time=0,this.zoomingOut=!1,this.currentBarTarget=0,this.currentBarHeight=0,i>1)throw new Error("Camera interpolation time may not exceed 1");this.interpolationTime=i/2,(0,r.isDev)()&&(console.log("Dev mode, press Tab to zoom out & click somewhere to teleport there."),document.addEventListener("keydown",this.handleKeyDown.bind(this))),this.currentBarTarget=0,this.currentBarHeight=0,this.x=t.x,this.y=t.y}setBounds(e){this.bounds=e}getBounds(){return this.bounds}handleKeyDown(e){if("Tab"!==e.key)return;if(e.stopPropagation(),e.preventDefault(),e.repeat)return;const t=this.scene.game.displayManager,i=this.scene.game.canvas,n=t.getRenderMode(),a=e=>{const t=i.getBoundingClientRect(),s=e.clientX-t.x,n=e.clientY-t.y,a=s/t.width,o=n/t.height,h=this.getVisibleRect(),l=h.x+a*h.width,d=h.y+(1-o)*h.height;this.scene.player.x=l,this.scene.player.y=d,this.setBounds(this.scene.player.getCurrentMapBounds()),this.scene.player.setVelocity(0,0),r()},r=()=>{this.zoomingOut=!1,t.setRenderMode(n),document.removeEventListener("keyup",o),i.removeEventListener("click",a),document.removeEventListener("keyup",o)},o=e=>{"Tab"===e.key&&(r(),e.stopPropagation(),e.preventDefault())};this.zoomingOut=!0,t.setRenderMode(s.RenderMode.NATIVE),document.addEventListener("keyup",o),i.addEventListener("click",a)}getVisibleRect(e=this.x,t=this.y){const i=this.scene.game,s=i.width/this.zoom,n=i.height/this.zoom;return{x:e-s/2,y:t-n/2,width:s,height:n}}isPointVisible(e,t,i=0){const s=this.getVisibleRect();return e>=s.x-i&&t>=s.y-i&&e<=s.x+s.width+i&&t<=s.y+s.height+i}setCinematicBar(e){this.currentBarTarget=e}getBaseCameraTarget(){let e=this.target.x,t=this.target.y+30;if(this.bounds){const i=this.getVisibleRect(e,t),s={left:i.x<this.bounds.x,right:i.x+i.width>this.bounds.x+this.bounds.width,top:i.y+i.height>this.bounds.y,bottom:i.y<this.bounds.y-this.bounds.height};if(i.width>=this.bounds.width){const t=i.x+i.width/2;e+=this.bounds.x+this.bounds.width/2-t}else s.left?e+=this.bounds.x-i.x:s.right&&(e+=this.bounds.x+this.bounds.width-(i.x+i.width));if(i.height>=this.bounds.height){const e=i.y+i.height-i.height/2;t+=this.bounds.y-this.bounds.height/2-e}else s.top?t+=this.bounds.y-(i.y+i.height):s.bottom&&(t+=this.bounds.y-this.bounds.height-i.y)}return{x:e,y:t}}update(e,t){this.time=t;const i=this.getBaseCameraTarget();if(this.x=i.x,this.y=i.y,(this.scene.fire.isAngry()||this.scene.apocalypse)&&this.applyApocalypticShake(this.scene.fire),this.zoom=1,this.rotation=0,this.zoomingOut){const e=this.scene.game,t=e.width,i=e.height,s=this.scene.world,n=s.getWidth(),a=s.getHeight();this.x=n/2,this.y=a/2,this.zoom=Math.min(t/n,i/a)}for(const e of this.focuses)this.updateAndApplyFocus(e);this.focuses=this.focuses.filter((e=>!e.dead)),this.currentBarHeight=(0,r.shiftValue)(this.currentBarHeight,this.currentBarTarget,1.5*e),this.currentBarTarget=0}applyApocalypticShake(e){const t=this.x-e.x,i=this.y-e.y,s=Math.sqrt(t*t+i*i);if(s<200){const t=(e.intensity-5)/15;if(t>0){const e=5*t*(1-s/200)*(this.scene.player.playerConversation?.5:1);this.x+=(0,r.rnd)(-1,1)*e,this.y+=(0,r.rnd)(-1,1)*e}}}isOnTarget(){return 0===this.focuses.length}getFocusForce(){return this.focuses.reduce(((e,t)=>Math.max(e,t.force)),0)}applyTransform(e){e.scale(this.zoom,this.zoom),e.rotate(this.rotation),e.translate(-this.x,this.y),this.zoomingOut&&(e.imageSmoothingEnabled=!0,e.imageSmoothingQuality="high")}unapplyTransform(e){e.translate(this.x,-this.y),e.rotate(-this.rotation),e.scale(1/this.zoom,1/this.zoom)}focusOn(e,t,i,s=1,a=0,r=n.valueCurves.cos(this.interpolationTime)){const o={x:t,y:i,duration:e,zoom:s,rotation:a,startTime:this.time,endTime:this.time+e,progress:0,dead:!1,force:0,curve:r};return this.focuses.push(o),new Promise(((e,t)=>{o.resolve=e,this.updateAndApplyFocus(o)}))}updateAndApplyFocus(e){if(e.progress=(0,r.clamp)((this.time-e.startTime)/e.duration,0,1),e.dead=e.progress>=1,e.dead)e.resolve&&(e.resolve(),e.resolve=void 0);else{const t=e.force=e.curve.get(e.progress),i=1-t;this.x=i*this.x+t*e.x,this.y=i*this.y+t*e.y;const s=i*(1/this.zoom)+t*(1/e.zoom);this.zoom=1/s,this.rotation=i*this.rotation+t*e.rotation}}addCinematicBarsToRenderer(e=this.getFocusForce()){e=Math.max(e,this.getFocusForce(),this.currentBarHeight),this.scene.renderer.add({type:a.RenderingType.BLACK_BARS,layer:a.RenderingLayer.BLACK_BARS,color:"black",height:this.barHeight,force:e})}drawBars(e,t=this.getFocusForce()){t=Math.max(t,this.getFocusForce(),this.currentBarHeight),e.save(),e.fillStyle="black",e.setTransform(1,0,0,1,0,0);const i=.5-.5*Math.cos(Math.PI*t),s=e.canvas.height*this.barHeight*i;e.fillRect(0,0,e.canvas.width,s),e.fillRect(0,e.canvas.height-s,e.canvas.width,s),e.restore()}isZoomingOut(){return this.zoomingOut}}},815:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Campaign=t.VoiceAsset=t.CharacterAsset=void 0;const s=i(7582),n=s.__importDefault(i(2377)),a=s.__importDefault(i(3123)),r=s.__importDefault(i(1688)),o=s.__importDefault(i(9063)),h=s.__importDefault(i(1347)),l=s.__importDefault(i(7117)),d=s.__importDefault(i(8001)),u=s.__importDefault(i(2575)),c=s.__importDefault(i(8364)),p=s.__importDefault(i(812)),g=s.__importDefault(i(2662)),m=s.__importDefault(i(5979)),y=s.__importDefault(i(6847)),f=s.__importDefault(i(2381)),_=s.__importDefault(i(2630)),w=s.__importDefault(i(1670)),v=s.__importDefault(i(8357)),b=s.__importDefault(i(8598)),T=s.__importDefault(i(8478)),E=s.__importDefault(i(9584)),I=s.__importDefault(i(9324)),A=s.__importDefault(i(662)),S=s.__importDefault(i(8165)),x=s.__importDefault(i(8091)),O=s.__importDefault(i(4337)),C=s.__importDefault(i(271)),P=s.__importDefault(i(4554)),k=i(3595),M=i(6607),N=i(3121),R=i(8129),D=i(9406),L={caveman1:n.default,caveman2:a.default,fire0:r.default,fire1:o.default,fire2:h.default,fire3:l.default,fire4:d.default,stone1:E.default,stone2:I.default,stonedisciple1:A.default,stonedisciple2:S.default,seed1:y.default,tree0:x.default,tree1:O.default,tree2:C.default,shiba1:_.default,shiba2:w.default,shiba3:v.default,shiba4:b.default,shiba5:T.default,powershiba2:m.default,flameboy1:u.default,flameboy2:c.default,flameboy3:p.default,flameboy4:g.default,wing1:P.default,shadowpresence1:f.default};var F,G;!function(e){e[e.FEMALE=0]="FEMALE",e[e.MALE=1]="MALE",e[e.PATIENT=2]="PATIENT"}(F||(t.CharacterAsset=F={})),function(e){e[e.FEMALE=0]="FEMALE",e[e.MALE=1]="MALE"}(G||(t.VoiceAsset=G={})),t.Campaign=class{constructor(e){this.game=e,this.onStatesChanged=new D.Signal,this.states=["start"],this.quests=[new R.QuestA(this),new R.QuestB(this),new R.QuestC(this),new R.QuestD(this),new R.QuestE(this)],this.selectedCharacter=F.FEMALE,this.selectedVoice=G.FEMALE,this.isNewGamePlus=!1}getQuest(e){const t=this.quests.find((t=>t.key===e));if(!t)throw new Error(`Cannot find quest with key ${e}`);return t}setNewGamePlus(e){this.isNewGamePlus=e}toggleCharacterAsset(){this.selectedCharacter=this.selectedCharacter===F.MALE?F.FEMALE:F.MALE}toggleVoiceAsset(){this.selectedVoice=this.selectedVoice===G.MALE?G.FEMALE:G.MALE}begin(e){this.gameScene=e,this.quests.forEach((e=>{e.reset()})),this.getQuest(R.QuestKey.A).trigger(R.QuestATrigger.JUST_ARRIVED),this.runAction("enable",null,["caveman","caveman1"]),this.runAction("enable",null,["fire","fire0"]),this.runAction("enable",null,["tree","tree0"]),this.runAction("enable",null,["stone","stone1"]),this.runAction("enable",null,["stonedisciple","stonedisciple1"]),this.runAction("enable",null,["flameboy","flameboy1"]),this.runAction("enable",null,["wing","wing1"]),this.runAction("enable",null,["shadowpresence","shadowpresence1"])}hasState(e){return this.states.includes(e)}setStates(e){this.states=e,this.onStatesChanged.emit(this.states)}removeState(e){this.hasState(e)&&(this.states.splice(this.states.indexOf(e),1),this.onStatesChanged.emit(this.states))}addState(e){this.hasState(e)||(this.states.push(e),this.onStatesChanged.emit(this.states))}runAction(e,t,i=[]){if(this.gameScene)switch(e){case"angry":t?.face?.setMode(M.FaceModes.ANGRY);break;case"neutral":t?.face?.setMode(M.FaceModes.NEUTRAL);break;case"bored":t?.face?.setMode(M.FaceModes.BORED);break;case"amused":t?.face?.setMode(M.FaceModes.AMUSED);break;case"sad":t?.face?.setMode(M.FaceModes.SAD);break;case"zoomin":this.gameScene.camera.zoom+=1;break;case"zoomout":this.gameScene.camera.zoom-=1;break;case"treezoom":{const e=this.gameScene.pointsOfInterest.find((e=>"forest"===e.name));e&&this.gameScene.camera.focusOn(8,e.x,e.y,1,0,N.valueCurves.cos(.35));break}case"mountainzoom":{const e=this.gameScene.pointsOfInterest.find((e=>"mountain"===e.name));e&&this.gameScene.camera.focusOn(8,e.x,e.y,1,0,N.valueCurves.cos(.35));break}case"riverzoom":{const e=this.gameScene.pointsOfInterest.find((e=>"river"===e.name));e&&this.gameScene.camera.focusOn(8,e.x,e.y,1,0,N.valueCurves.cos(.35));break}case"crazyzoom":{this.getQuest(R.QuestKey.A).trigger(R.QuestATrigger.APOCALYPSE_STARTED);const e=12;this.gameScene.camera.focusOn(e,this.gameScene.fire.x,this.gameScene.fire.y+15,8,-2*Math.PI,N.valueCurves.cubic).then((()=>this.gameScene?.beginApocalypse())),this.gameScene.fire.conversation=null,this.gameScene.fireFuryEndTime=this.gameScene.gameTime+e+8;break}case"friendshipEnding":this.gameScene.beginFriendshipEnding();break;case"activatefireportal":this.gameScene.exitPortal.activate(),this.gameScene.flameboy.nextState();break;case"talkedtofire":this.getQuest(R.QuestKey.A).trigger(R.QuestATrigger.TALKED_TO_FIRE);break;case"giveWoodToFlameboy":k.Conversation.setGlobal("gaveWoodToFlameboy","true"),this.gameScene.setGateDisabled("exitportaldoor_1",!1),this.gameScene.player.removeMultiJump(),this.gameScene.removeGameObject(this.gameScene.fire),this.gameScene.removeGameObject(this.gameScene.shiba),this.gameScene.removeGameObject(this.gameScene.powerShiba),this.gameScene.removeGameObject(this.gameScene.bird),this.gameScene.removeGameObject(this.gameScene.shadowPresence),this.gameScene.removeGameObject(this.gameScene.tree),this.gameScene.removeGameObject(this.gameScene.wing),this.gameScene.removeGameObject(this.gameScene.mimic),this.gameScene.removeGameObject(this.gameScene.stone),this.gameScene.removeGameObject(this.gameScene.stoneDisciple),this.runAction("enable",null,["flameboy","flameboy3"]);break;case"giveBone":k.Conversation.setGlobal("gaveBoneToPowerShiba","true"),this.runAction("enable",null,["shiba","shiba3"]),this.runAction("enable",null,["powershiba","powershiba2"]);break;case"shibaNextState":this.gameScene.shiba.nextState();break;case"talkedtotree":this.getQuest(R.QuestKey.A).trigger(R.QuestATrigger.TALKED_TO_TREE);break;case"gotFireQuest":this.getQuest(R.QuestKey.A).trigger(R.QuestATrigger.GOT_QUEST_FROM_FIRE),k.Conversation.setGlobal("gotFireQuest","true"),this.runAction("enable",null,["tree","tree1"]);break;case"endgameA":this.getQuest(R.QuestKey.A).trigger(R.QuestATrigger.BEAT_GAME),this.getQuest(R.QuestKey.A).finish(),this.gameScene.fire.conversation=null,this.gameScene.gameOver();break;case"endgameB":this.getQuest(R.QuestKey.B).finish(),this.gameScene.fire.conversation=null,this.gameScene.gameOver();break;case"endgameC":this.getQuest(R.QuestKey.C).finish(),this.gameScene.caveman.conversation=null,this.gameScene.gameOver();break;case"game":this.addState(i[0]);break;case"enableRunning":this.gameScene.player.enableRunning();break;case"doublejump":this.gameScene.player.enableDoubleJump();break;case"multijump":this.getQuest(R.QuestKey.A).trigger(R.QuestATrigger.GOT_MULTIJUMP),this.gameScene.player.enableMultiJump();break;case"friendship":this.gameScene.player.enableFriendship();break;case"spawnseed":this.gameScene.tree.spawnSeed();break;case"spawnwood":this.getQuest(R.QuestKey.A).trigger(R.QuestATrigger.TREE_DROPPED_WOOD),this.gameScene.tree.spawnWood();break;case"talkedToStone":this.getQuest(R.QuestKey.A).getHighestTriggerIndex()===R.QuestATrigger.PLANTED_SEED&&this.getQuest(R.QuestKey.A).trigger(R.QuestATrigger.TALKED_TO_STONE);break;case"pickupstone":this.gameScene.stone.pickUp();break;case"learnraindance":this.gameScene.player.enableRainDance();break;case"talkedToFireWithWood":this.getQuest(R.QuestKey.A).getHighestTriggerIndex()===R.QuestATrigger.GOT_WOOD&&this.getQuest(R.QuestKey.A).trigger(R.QuestATrigger.TALKED_TO_FIRE_WITH_WOOD);break;case"dance":setTimeout((()=>{this.gameScene?.player.startDance(+i[0]||1)}),500);break;case"wakeupchest":this.gameScene.mimic.nextState();break;case"petDoggo":this.gameScene.beginPetEnding();break;case"lookThroughWindow":this.gameScene.beginWindowEnding();break;case"enable":{const e=i[0],t=i[1],s={fire:this.gameScene.fire,stone:this.gameScene.stone,stonedisciple:this.gameScene.stoneDisciple,tree:this.gameScene.tree,seed:this.gameScene.seed,flameboy:this.gameScene.flameboy,wing:this.gameScene.wing,caveman:this.gameScene.caveman,shadowpresence:this.gameScene.shadowPresence,shiba:this.gameScene.shiba,powershiba:this.gameScene.powerShiba}[e],n=L[t];null!=s&&null!=n&&(s.conversation=new k.Conversation(n,s));break}case"disable":{const e=i[0],t={fire:this.gameScene.fire,stone:this.gameScene.stone,stonedisciple:this.gameScene.stoneDisciple,tree:this.gameScene.tree,seed:this.gameScene.seed,flameboy:this.gameScene.flameboy,wing:this.gameScene.wing,caveman:this.gameScene.caveman,shadowpresence:this.gameScene.shadowPresence,shiba:this.gameScene.shiba,powershiba:this.gameScene.powerShiba}[e];null!=t&&(t.conversation=null);break}}}}},5744:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterSounds=void 0;const s=i(7582),n=i(5943),a=i(815),r=i(6070);class o{static getSoundData(){return{[a.VoiceAsset.MALE]:{jump:o.lowPitchJump,drown:o.lowPitchDrown,land:o.lowPitchLand,throw:o.lowPitchThrow},[a.VoiceAsset.FEMALE]:{jump:o.highPitchJump,drown:o.highPitchDrown,land:o.highPitchLand,throw:o.highPitchThrow}}}static getRandomCharacterSound(e,t){return(0,r.rndItem)(o.getSoundData()[t][e])}static playRandomCharacterSound(e,t){o.stopCharacterSound(e,t);const i=o.getRandomCharacterSound(e,t);i&&i.play()}static stopCharacterSound(e,t){o.getSoundData()[t][e].forEach((e=>e.stop()))}}t.CharacterSounds=o,s.__decorate([(0,n.asset)(["sounds/jumping/jumping.mp3"]),s.__metadata("design:type",Array)],o,"lowPitchJump",void 0),s.__decorate([(0,n.asset)(["sounds/drowning/drowning.mp3"]),s.__metadata("design:type",Array)],o,"lowPitchDrown",void 0),s.__decorate([(0,n.asset)(["sounds/jumping/landing.mp3"]),s.__metadata("design:type",Array)],o,"lowPitchLand",void 0),s.__decorate([(0,n.asset)(["sounds/throwing/throwing.mp3"]),s.__metadata("design:type",Array)],o,"lowPitchThrow",void 0),s.__decorate([(0,n.asset)(["sounds/jumping/jump_female_01.ogg"]),s.__metadata("design:type",Array)],o,"highPitchJump",void 0),s.__decorate([(0,n.asset)(["sounds/drowning/drowning.mp3"]),s.__metadata("design:type",Array)],o,"highPitchDrown",void 0),s.__decorate([(0,n.asset)(["sounds/jumping/landing.mp3"]),s.__metadata("design:type",Array)],o,"highPitchLand",void 0),s.__decorate([(0,n.asset)(["sounds/throwing/throwing.mp3"]),s.__metadata("design:type",Array)],o,"highPitchThrow",void 0)},3613:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorGradient=void 0;const s=i(8557),n=i(6070);class a{constructor(e){this.mapping=e}get(e){return this.mapping((0,n.clamp)(e,0,.9999999999))}getCss(e){const t=this.get(e);return`rgba(${t[0]},${t[1]},${t[2]},${t[3]})`}static fromTable(e){const t=e.length;return new a((i=>{const s=Math.floor(i*t);return e[s]}))}static fromImage(e){const t=(0,s.getImageData)(e).data,i=e.naturalWidth,r=e.naturalHeight;let o=0;if(1===r){const e=[];for(let s=0;s<i;s++)e.push([t[o++],t[o++],t[o++],t[o++]]);return a.fromTable(e)}{const e=[];for(let s=0;s<i;s++){e[s]=[];for(let n=0;n<r;n++){const a=4*(s+i*n);e[s].push([t[a],t[a+1],t[a+2],t[a+3]])}}const s=i;return new a((t=>{const i=Math.floor(t*s);return(0,n.rndItem)(e[i])}))}}}t.ColorGradient=a},3595:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConversationLine=t.Conversation=void 0;const i=new Set(["angry","sad","amused","neutral","bored"]);class s{constructor(e,t){this.npc=t,this.stateIndex=0,this.endConversation=!1,this.localVariables={},this.skippedLines=0,this.states=Object.keys(e),this.data={};for(const t of this.states)this.data[t]=e[t].map((e=>new n(e,this)));this.setState("entry"),this.endConversation=!1}setState(e="entry"){if(!this.states.includes(e))throw new Error(`State name ${e} does not exist in conversation`);this.state=e,this.stateIndex=0}getNextInteraction(){if(this.endConversation)return this.endConversation=!1,null;this.skippedLines=0;const e={npcLine:null,options:[],spoiledOptions:[]},t=this.getNextLine();if(null==t)return null;t.isNpc?e.npcLine=t:this.goBack(1+this.skippedLines),this.skippedLines=0;let i=this.getNextLine();for(;i&&!i.isNpc;)e.options.push(i),this.skippedLines=0,i=this.getNextLine();return i&&!i.isNpc?this.goBack():this.goBack(1+this.skippedLines),this.skippedLines=0,e}runAction(e){switch(e[0]){case"end":this.endConversation=!0;break;case"set":this.setVariable(e[1],e[2]);break;default:this.npc.scene.game.campaign.runAction(e[0],this.npc,e.slice(1))}}setVariable(e="",t="true"){e.startsWith("$")?s.globalVariables[e]=t:this.localVariables[e]=t}static setGlobal(e,t="true"){e.startsWith("$")||(e="$"+e),s.globalVariables[e]=t}static getGlobals(){return s.globalVariables}static resetGlobals(){s.globalVariables={}}getVariable(e){return e.startsWith("$")?s.globalVariables[e]:this.localVariables[e]}goBack(e=1){e<=0||(this.stateIndex-=e,this.skippedLines=0)}getNextLine(e=!1){if(this.stateIndex>=this.data[this.state].length)return null;const t=this.data[this.state][this.stateIndex++];return null==t.condition||e||this.testCondition(t.condition)?t:(this.skippedLines++,this.getNextLine(e))}testCondition(e){const t=this;return e.split(",").some((function e(i){if(i.startsWith("not "))return!e(i.substring(4));if(i.includes("!=")){const e=i.split("!=").map((e=>e.trim()));return t.getVariable(e[0])!==e[1]}if(i.includes("=")){const e=i.split("=").map((e=>e.trim()));return t.getVariable(e[0])===e[1]}if(i.includes(">")){const e=i.split(">").map((e=>e.trim()));return parseFloat(t.getVariable(e[0]))>parseFloat(e[1])}if(i.includes("<")){const e=i.split("<").map((e=>e.trim()));return parseFloat(t.getVariable(e[0]))<parseFloat(e[1])}const s=t.getVariable(i.trim());return null!=s&&""!==s&&"0"!==s&&"false"!==s}))}hasEnded(){return this.endConversation}}t.Conversation=s,s.globalVariables={};class n{constructor(e,t){this.full=e,this.conversation=t,this.visited=!1,this.isNpc=!e.startsWith(""),this.line=n.extractText(e,this.isNpc),this.condition=n.extractCondition(e),this.targetState=n.extractState(e),this.actions=n.extractActions(e),this.visited=!1}executeBeforeLine(){if(this.actions.length>0)for(const e of this.actions)this.isEarlyAction(e[0])&&this.conversation.runAction(e)}execute(){if(this.visited=!0,null!=this.targetState&&this.conversation.setState(this.targetState),this.actions.length>0)for(const e of this.actions)this.isEarlyAction(e[0])||this.conversation.runAction(e)}isEarlyAction(e){return i.has(e)}wasVisited(){return this.visited}static extractText(e,t=!1){e.startsWith(n.OPTION_MARKER)&&(e=e.substring(1)),e.trim().startsWith("[")&&e.includes("]")&&(e=e.substring(e.indexOf("]")+1).trim());const i=e.indexOf("@"),s=e.search(/\![a-zA-Z]/);if(i>=0||s>=0){const t=i>=0&&s>=0?Math.min(i,s):i>=0?i:s;e=e.substring(0,t).trim()}return t?n.wrapString(e,50):e}static extractCondition(e){const t=e.match(/\[[a-zA-Z0-9\_\<\>\!\=\$ ]+\]/g);return t&&t[0]?t[0].substring(1,t[0].length-1):null}static extractState(e){const t=e.match(/(@[a-zA-Z0-9\_]+)/g);return t&&t.length>0?t[0].substring(1):null}static extractActions(e){return e.match(/(\![a-zA-Z][a-zA-Z0-9\_\$ ]*)+/g)?.join(" ").split("!").map((e=>e.trim())).filter((e=>e.length>0)).map((e=>e.split(" ")))??[]}static wrapString(e,t){let i=0,s=-1;for(let n=0;n<e.length;n++){const a=e[n];"\n"===a?i=0:(" "===a&&(s=n),i++,i>=t&&(s>=0?(e=e.substring(0,s)+"\n"+e.substring(s+1),i=n-s,s=-1):(e=e.substring(0,n+1)+"\n"+e.substring(n+1),i=0)))}return e}}t.ConversationLine=n,n.OPTION_MARKER=""},1735:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Dance=void 0;const s=i(7582),n=i(9797),a=i(5943),r=i(1531),o=i(6038),h=i(3121),l=i(225);class d{constructor(e,t,i,s=128,n="",a=8,r=3,o=.75,l=!0,d=1){this.scene=e,this.x=t,this.y=i,this.bpm=s,this.warmupBeats=a,this.allowedMistakes=r,this.timeTolerance=o,this.withMusic=l,this.musicIndex=d,this.progress=0,this.currentKey="",this.currentDistanceToIdealTime=0,this.allKeys=["1","2"],this.mistakes=0,this.lastMistake=0,this.lastSuccess=0,this.performance=[],this.currentIndex=0,this.success=!1,this.duration=n.length,this.keys=[],this.performance=[];for(let e=0;e<n.length;e++){const t=n[e];this.keys[e]=" "===t?"":"3"===t?"12":t,this.performance[e]={}}this.begin(),this.alphaCurve=h.valueCurves.cos(.15)}wasSuccessful(){return this.success}hasStarted(){return this.progress>0}getTimeSinceLastMistake(){return this.progress-this.lastMistake}getTimeSinceLastSuccess(){return this.progress-this.lastSuccess}begin(){this.openTime=this.scene.gameTime,this.startTime=this.openTime+this.warmupBeats/this.bpm*60,this.currentKey="",this.currentDistanceToIdealTime=0,this.mistakes=0,this.lastMistake=-1/0,this.lastSuccess=-1/0,this.currentIndex=0,this.performance=this.performance.map((()=>({}))),this.success=!1,d.raindance_music.stop(),d.raindance_music.setVolume(0),d.treedance_music.stop(),d.treedance_music.setVolume(0)}setPosition(e,t){this.x=e,this.y=t}handleButtonDown(e){if(!e.repeat&&this.hasStarted()){const t=e.isPlayerDance1?"1":"2";if(this.allKeys.indexOf(t)>=0){if(this.currentKey.includes(t)&&this.currentDistanceToIdealTime<=this.timeTolerance)return void this.keySuccess(t);const e=this.currentIndex+1;if(this.keys[e]&&this.keys[e].includes(t)&&this.progress-(e+.5)<this.timeTolerance)return void this.keySuccess(t,e);this.keyFailure(t)}}}keySuccess(e,t=this.currentIndex){for(const i of e)t===this.currentIndex&&(this.currentKey=this.currentKey.replace(i,"")),this.performance[t][i]=!0;(t===this.currentIndex&&0===this.currentKey.length||0===this.keys[t].length)&&(this.lastSuccess=this.progress,d.successSound.stop())}keyFailure(e){this.currentKey.includes(e)||(this.registerMistake(),d.failSound.play())}keyMissed(e){if(null!=this.performance[this.currentIndex])for(const t of e)this.performance[this.currentIndex][t]=!1;this.registerMistake()}registerMistake(){this.mistakes++,this.lastMistake=this.progress,d.failSound.play(),this.mistakes>this.allowedMistakes&&this.loseGame()}loseGame(){this.begin()}update(){const e=this.scene.gameTime-this.startTime;this.progress=e*this.bpm/60;const t=this.currentIndex;if(this.currentIndex=Math.floor(this.progress),this.updateMusic(),this.currentIndex>t){if(this.currentKey.length>0)return this.keyMissed(this.currentKey),this.currentKey="",!1;this.currentKey=this.keys[this.currentIndex]||"";for(const e of this.currentKey)null!=this.performance[this.currentIndex]&&this.performance[this.currentIndex][e]&&(this.currentKey=this.currentKey.replace(e,""))}return this.progress>=this.duration?(this.success=!0,this.resetMusic(),!0):(this.currentKey?this.currentDistanceToIdealTime=Math.abs(this.progress-(this.currentIndex+.5)):this.currentDistanceToIdealTime=0,!1)}updateMusic(){if(this.withMusic)if(this.progress<0&&!d.raindance_music.isPlaying()){const e=-this.progress/this.warmupBeats;this.scene.fadeActiveBackgroundTrack(e)}else 0!==this.musicIndex||d.treedance_music.isPlaying()||(d.treedance_music.setVolume(.8),d.treedance_music.play(),this.scene.setBgmVolume(0)),1!==this.musicIndex||d.raindance_music.isPlaying()||(d.raindance_music.setVolume(.8),d.raindance_music.play(),this.scene.setBgmVolume(0))}resetMusic(){d.raindance_music.stop(),d.treedance_music.stop(),this.scene.resetMusicVolumes()}addDanceToRenderQueue(){this.scene.renderer.add({type:l.RenderingType.DANCE,layer:l.RenderingLayer.UI,dance:this})}draw(e){const t=o.ControllerManager.getInstance().controllerSprite;e.save(),e.translate(this.x,-this.y);e.drawImage(d.bar,d.bar.width/-2,1+d.bar.height/-2),this.progress-this.lastMistake<1&&(e.fillStyle="red",e.globalAlpha=.6*(1-this.progress+this.lastMistake),e.fillRect(-48,-8,96,18)),this.progress-this.lastSuccess<1&&(e.fillStyle="green",e.globalAlpha=.1*(1-this.progress+this.lastSuccess),e.fillRect(-48,-8,96,18)),e.globalAlpha=1,e.textAlign="center",e.fillStyle="black";for(let i=Math.floor(this.progress)-2;i<this.progress+8;i++){const s=this.keys[i];if(s){const n=34-20*(i-this.progress)-6,a=(n- -50)/100,r=this.alphaCurve.get(a);e.globalAlpha=r,s.includes("1")&&(e.strokeStyle="#ff8010",null!=this.performance[i][1]?(e.fillStyle=this.performance[i][1]?"#70F070":"#F06060",e.fillRect(n-4,-8,9,9)):d.keys.drawTag(e,`${t}-dance1`,n+d.keys.width/-2,-8)),s.includes("2")&&(e.strokeStyle="blue",null!=this.performance[i][2]?(e.fillStyle=this.performance[i][2]?"#70F070":"#F06060",e.fillRect(n-4,1,9,9)):d.keys.drawTag(e,`${t}-dance2`,n+d.keys.width/-2,1))}}e.globalAlpha=1,e.drawImage(d.indicator,26,1+d.indicator.height/-2),e.drawImage(d.indicator,38,1+d.indicator.height/-2),e.restore()}}t.Dance=d,s.__decorate([(0,a.asset)("sounds/dancing/success.mp3"),s.__metadata("design:type",r.Sound)],d,"successSound",void 0),s.__decorate([(0,a.asset)("sounds/dancing/fail.mp3"),s.__metadata("design:type",r.Sound)],d,"failSound",void 0),s.__decorate([(0,a.asset)("music/raindance.ogg"),s.__metadata("design:type",r.Sound)],d,"raindance_music",void 0),s.__decorate([(0,a.asset)("music/dancing_queen.ogg"),s.__metadata("design:type",r.Sound)],d,"treedance_music",void 0),s.__decorate([(0,a.asset)("images/dancing_ui_bar.png"),s.__metadata("design:type",HTMLImageElement)],d,"bar",void 0),s.__decorate([(0,a.asset)("images/dancing_ui_indicator.png"),s.__metadata("design:type",HTMLImageElement)],d,"indicator",void 0),s.__decorate([(0,a.asset)("sprites/dancing_ui_keys.aseprite.json"),s.__metadata("design:type",n.Aseprite)],d,"keys",void 0)},9430:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DialoguePrompt=void 0;const s=i(7582),n=i(9797),a=i(5943),r=i(225);class o{constructor(e,t,i){this.timeAlive=0,this.floatAmount=2,this.floatSpeed=5,this.scene=e,this.x=t,this.y=i}draw(){const e=Math.sin(this.timeAlive*this.floatSpeed)*this.floatAmount;this.scene.renderer.addAseprite(o.sprite,"idle",this.x,this.y-e,r.RenderingLayer.ENTITIES)}update(e,t,i){this.timeAlive+=e,this.x=t,this.y=i}}t.DialoguePrompt=o,s.__decorate([(0,a.asset)("sprites/dialogue.aseprite.json"),s.__metadata("design:type",n.Aseprite)],o,"sprite",void 0)},6867:(e,t,i)=>{var s,n,a,r;Object.defineProperty(t,"__esModule",{value:!0}),t.DisplayManager=t.DEFAULT_RENDER_MODE=t.RenderMode=void 0;const o=i(7582),h=i(69),l=i(9406);var d;!function(e){e.PIXEL_IMPERFECT="pixel-imperfect",e.PIXEL_PERFECT="pixel-perfect",e.NATIVE="native"}(d||(t.RenderMode=d={})),t.DEFAULT_RENDER_MODE=d.PIXEL_IMPERFECT;const u="display.renderMode";class c{constructor(){null==window.localStorage.getItem(u)&&(this.renderMode=t.DEFAULT_RENDER_MODE)}get renderMode(){return window.localStorage.getItem(u)??t.DEFAULT_RENDER_MODE}set renderMode(e){window.localStorage.setItem(u,e)}}class p{static getInstance(){return o.__classPrivateFieldGet(s,s,"f",n)}constructor(e){a.set(this,void 0),r.set(this,new c),this.onChange=new l.Signal,o.__classPrivateFieldSet(this,a,e,"f")}async setFullscreenEnabled(e){return o.__classPrivateFieldGet(this,a,"f").setEnabled(e)}async isFullscreenEnabled(){return o.__classPrivateFieldGet(this,a,"f").isEnabled()}setRenderMode(e){o.__classPrivateFieldGet(this,r,"f").renderMode=e,this.onChange.emit()}getRenderMode(){return o.__classPrivateFieldGet(this,r,"f").renderMode}}t.DisplayManager=p,s=p,a=new WeakMap,r=new WeakMap,n={value:new s(h.FullscreenManager.getInstance())}},1809:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Entity=t.createEntity=t.entity=void 0;const s=i(2571),n=new Map;t.entity=function(e){return t=>{n.set(e,t)}},t.createEntity=function(e,t){const i=n.get(e);if(!i)throw new Error("Entity not found: "+e);return new i(t)};class a{constructor({scene:e,x:t,y:i,width:n=0,height:a=0,isTrigger:r=!0}){this.timeAlive=0,this.animator=new s.Animator(this),this.scene=e,this.x=t,this.y=i,this.width=n,this.height=a,this.isTrigger=r}update(e){this.timeAlive+=e}distanceTo(e){const t=this.x-e.x,i=this.y-e.y;return Math.sqrt(t*t+i*i)}get distanceToPlayer(){return this.distanceTo(this.scene.player)}getClosestEntityInRange(e){const t=this.getEntitiesInRange(e).sort(((e,t)=>e.distance-t.distance));return null!=t[0]?t[0].target:null}getEntitiesInRange(e){const t=[];return this.scene.gameObjects.forEach((i=>{if(i instanceof a&&i!==this){const s=this.distanceTo(i);s<e&&t.push({source:this,target:i,distance:s})}})),t}getClosestEntity(){const e=[];return this.scene.gameObjects.forEach((t=>{if(t instanceof a&&t!==this){const i=this.distanceTo(t);e.push({source:this,target:t,distance:i})}})),e.sort(((e,t)=>e.distance-t.distance)),e[0].target}getBounds(e=0){const t=this.width+2*e,i=this.height+2*e;return{x:this.x-this.width/2-e,y:this.y- -this.height+e,width:t,height:i}}isCollidingWithTrigger(e){const t=this.scene.world.getTriggerCollisions(this);return 0!==t.length&&t.findIndex((t=>t.name===e))>-1}remove(){this.scene.removeGameObject(this)}}t.Entity=a},6607:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Face=t.EyeType=t.FaceModes=void 0;const s=i(7582),n=i(5943),a=i(225);var r,o;!function(e){e.BLINK="blink",e.NEUTRAL="neutral",e.ANGRY="angry",e.BORED="bored",e.AMUSED="amused",e.SAD="sad",e.DISGUSTED="disgusted"}(r||(t.FaceModes=r={})),function(e){e[e.STANDARD=0]="STANDARD",e[e.TREE=1]="TREE",e[e.STONE=2]="STONE",e[e.FLAMEBOY=3]="FLAMEBOY",e[e.STONEDISCIPLE=4]="STONEDISCIPLE",e[e.FLAMEBOY2=5]="FLAMEBOY2"}(o||(t.EyeType=o={}));class h{constructor(e,t,i,s=0,n=20){this.scene=e,this.owner=t,this.eyeType=i,this.offX=s,this.offY=n,this.mode=r.NEUTRAL,this.direction=1}setMode(e){this.mode=e}setOffY(e){this.offY=e}draw(e){const t=h.sprites[this.eyeType];this.scene.renderer.add({type:a.RenderingType.ASEPRITE,layer:a.RenderingLayer.ENTITIES,asset:t,scale:{x:this.direction,y:1},translation:{x:this.owner.x+this.offX,y:-this.owner.y-this.offY},position:{x:-t.width>>1,y:-t.height},animationTag:this.mode,time:1e3*this.scene.gameTime})}toggleDirection(e=(this.direction>0?-1:1)){e!==this.direction&&(this.direction=e)}setDirection(e){this.direction=e}}t.Face=h,s.__decorate([(0,n.asset)(["sprites/eyes/standard.aseprite.json","sprites/eyes/tree.aseprite.json","sprites/eyes/stone.aseprite.json","sprites/eyes/flameboy.aseprite.json","sprites/eyes/stonedisciple.aseprite.json","sprites/eyes/flameboy2.aseprite.json"]),s.__metadata("design:type",Array)],h,"sprites",void 0)},1344:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FireGfx=void 0;const s=i(7582),n=i(5943),a=i(3613),r=i(6070);class o{constructor(e=48,t=64,i=!0,s=33){this.w=e,this.h=t,this.coneShaped=i,this.updateMs=s,this.returnColor=[0,0,0,255],this.bottomLine=[],this.nextUpdate=-1/0,this.age=0,this.startTime=0,this.canvas=document.createElement("canvas"),this.canvas.width=this.w,this.canvas.height=this.h,this.context=this.canvas.getContext("2d"),this.imageData=this.context.getImageData(0,0,this.w,this.h),this.data=[],this.decayData=[],this.init()}init(){this.age=0,this.nextUpdate=-1/0,this.startTime=Date.now();const e=this.decayData,t=this.data;for(let i=0;i<this.h;i++){const s=t[i]=[],n=e[i]=[],a=i/(this.h-1);for(let e=0;e<this.w;e++)s[e]=0,n[e]=this.getDecay(e/(this.w-1),a)}const i=t[this.h-1];for(let e=0;e<this.w;e++){const t=e/(this.w-1),s=this.coneShaped?(0,r.clamp)(2*t-.5,0,1):t,n=.5-.5*Math.cos(2*Math.PI*s);i[e]=1.25*Math.pow(n,.5)}this.bottomLine=i.slice()}getDecay(e,t){return e>.5&&(e=1-e),this.coneShaped&&(t*=1.2)>1?.02:.02+.1*(.5-e)+Math.pow(1-t,8)}update(){const e=Date.now();this.age=e-this.startTime,e>=this.nextUpdate&&(this.nextUpdate=e+this.updateMs,this.updateStep(),this.render())}updateStep(){const e=this.data;let t=e[0],i=0,s=0,n=1;const a=.5*(this.w-1),o=this.coneShaped?.8*this.h:1/0;for(let h=0;h<this.h-1;h++){const l=t,d=this.decayData[h];if(t=e[h+1],h>o){const e=(h-o)/(this.h-o);s=.15*e*e,n=1-s}for(let e=0;e<this.w;e++){i=(0,r.clamp)(e+(0,r.rnd)(-1,1)*(0,r.rnd)(),.3,this.w-1.3),s&&(i=s*a+n*i);const o=Math.floor(i),h=i-o,u=h*t[o+1]+(1-h)*t[o]-d[e]+(0,r.rnd)(-.03,.02);l[e]=(0,r.clamp)(u,0,1/0)}}const h=e[this.h-1],l=6*this.age/1e3,d=.5*(0,r.orientPow)(Math.sin(l)*Math.sin(.353*l)*Math.sin(.764*l)*Math.sin(.5433*l)*Math.sin(1.634*l)*Math.sin(1.342*l),1.5),u=d>0?1+d:1/(1-d);for(let e=0;e<this.w;e++){const t=1.2+(.8*Math.sin(l)*Math.sin(.1*e*l)*Math.sin(-.07*e*l))**2,i=Math.floor((this.w-1)*(e/(this.w-1))**u);h[e]=this.bottomLine[i]*t}}render(){const e=this.imageData.data,t=this.data;let i=0,s=[0];for(let n=0;n<this.h;n++){const a=t[n];for(let t=0;t<this.w;t++)s=this.valueToColor(a[t]),e[i++]=s[0],e[i++]=s[1],e[i++]=s[2],e[i++]=s[3]}this.context.putImageData(this.imageData,0,0)}valueToColor(e){return o.gradient.get((0,r.clamp)(e,0,1))}oldValueToColor(e){const t=255*(e=(0,r.clamp)(e,0,1));return this.returnColor[0]=255,this.returnColor[1]=t,this.returnColor[2]=t*e,this.returnColor[3]=t,this.returnColor}getImage(){return this.canvas}draw(e,t=0,i=0){const s=this.getImage();e.drawImage(s,t-s.width/2,-i-s.height)}}t.FireGfx=o,s.__decorate([(0,n.asset)("gradients/fire.png",{map:e=>a.ColorGradient.fromImage(e)}),s.__metadata("design:type",a.ColorGradient)],o,"gradient",void 0)},2821:(e,t,i)=>{var s,n,a,r;Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const o=i(7582),h=i(4488),l=i(5943),d=i(3888),u=i(815),c=i(5744),p=i(69),g=i(6867),m=i(8557),y=i(6038),f=i(5709),_=i(8738),w=i(7419),v=i(408),b=i(6070);t.Game=class{constructor(e=h.GAME_CANVAS_WIDTH,t=h.GAME_CANVAS_HEIGHT){this.width=e,this.height=t,this.controllerManager=y.ControllerManager.getInstance(),this.keyboard=new _.Keyboard,this.gamepad=new f.GamepadInput,this.scenes=new w.Scenes(this),this.assets=new l.Assets,this.campaign=new u.Campaign(this),this.characterSounds=new c.CharacterSounds,this.backgroundColor="black",this.gameLoopCallback=this.gameLoop.bind(this),this.gameLoopId=null,this.lastUpdateTime=performance.now(),this.mouseTimeout=2,s.set(this,void 0),n.set(this,void 0),a.set(this,void 0),r.set(this,void 0);const i=this.canvas=(0,m.getGameCanvas)(e,t);o.__classPrivateFieldSet(this,s,g.DisplayManager.getInstance(),"f"),o.__classPrivateFieldGet(this,s,"f").onChange.connect(this.updateCanvas,this),o.__classPrivateFieldSet(this,n,v.SteamworksApi.getInstance(),"f"),o.__classPrivateFieldSet(this,a,d.AudioManager.getInstance(),"f"),o.__classPrivateFieldSet(this,r,p.FullscreenManager.getInstance(),"f"),this.ctx=(0,m.getRenderingContext)(i,"2d",{alpha:!1,desynchronized:!1});const b=i.style;b.position="absolute",b.margin="auto",b.left=b.top=b.right=b.bottom="0",document.body.appendChild(this.canvas),this.updateCanvas(),window.addEventListener("resize",(()=>this.updateCanvas())),window.addEventListener("pointermove",(()=>this.mouseMoved())),window.addEventListener("keydown",(async e=>{if(e.altKey&&"Enter"===e.key){const e="keyboard"in navigator&&"lock"in navigator.keyboard&&"function"==typeof navigator.keyboard.lock;window.matchMedia("(display-mode: fullscreen)").matches&&null!=document.fullscreenElement?(e&&navigator.keyboard.unlock(),await document.exitFullscreen()):(e&&await navigator.keyboard.lock(["Escape"]),await document.body.requestFullscreen())}}))}get displayManager(){return o.__classPrivateFieldGet(this,s,"f")}get steamworks(){return o.__classPrivateFieldGet(this,n,"f")}get audioManager(){return o.__classPrivateFieldGet(this,a,"f")}get fullscreenManager(){return o.__classPrivateFieldGet(this,r,"f")}mouseMoved(){this.canvas.style.cursor="default",this.mouseTimeout=2}updateMouse(e){this.mouseTimeout>0&&(this.mouseTimeout=Math.max(0,this.mouseTimeout-e),0===this.mouseTimeout&&(this.canvas.style.cursor="none"))}updateCanvas(){const{width:e,height:t}=this,i=this.displayManager.getRenderMode();let s=Math.min(window.innerWidth/e,window.innerHeight/t);i===g.RenderMode.PIXEL_PERFECT&&(s=Math.max(1,Math.floor(s)));const n=this.canvas,a=n.style;if(i===g.RenderMode.NATIVE){const i=window.devicePixelRatio;n.width=e*s*i,n.height=t*s*i,a.imageRendering="auto"}else n.width=e,n.height=t,a.imageRendering="pixelated",a.imageRendering="crisp-edges";a.width=Math.round(e*s)+"px",a.height=Math.round(t*s)+"px"}gameLoop(){const e=performance.now(),t=(0,b.clamp)((e-this.lastUpdateTime)/1e3,0,.1);this.update(t),this.lastUpdateTime=e;const i=this.displayManager.getRenderMode(),{ctx:s,width:n,height:a}=this;s.save(),i===g.RenderMode.NATIVE?(s.scale(s.canvas.width/n,s.canvas.height/a),s.imageSmoothingEnabled=!0,s.imageSmoothingQuality="high"):s.imageSmoothingEnabled=!1,s.fillStyle=this.backgroundColor,s.fillRect(0,0,n,a),this.draw(s,n,a),s.restore(),this.nextFrame()}nextFrame(){this.gameLoopId=requestAnimationFrame(this.gameLoopCallback)}update(e){this.gamepad.update(),this.updateMouse(e),this.scenes.update(e)}draw(e,t,i){this.scenes.draw(e,t,i)}start(){null==this.gameLoopId&&(this.lastUpdateTime=performance.now(),this.nextFrame())}stop(){null!=this.gameLoopId&&(cancelAnimationFrame(this.gameLoopId),this.gameLoopId=null)}},s=new WeakMap,n=new WeakMap,a=new WeakMap,r=new WeakMap},4919:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalState=void 0,function(e){e.BEAT_GAME_ONCE="beatGame",e.ACHIEVED_ENDINGS="achievedEndings"}(i||(i={}));class s{static getParsedValueByKey(e,t){const i=localStorage.getItem(e);if(null==i)return t;try{return JSON.parse(i)??t}catch(e){return console.error(e),t}}static setKeyValuePair(e,t){try{const i=JSON.stringify(t);localStorage.setItem(e,i)}catch(e){console.error(e)}}static getHasBeatenGame(){return s.getParsedValueByKey(i.BEAT_GAME_ONCE,!1)}static setHasBeatenGame(){s.setKeyValuePair(i.BEAT_GAME_ONCE,!0)}static getAchievedEndings(){return s.getParsedValueByKey(i.ACHIEVED_ENDINGS,[])}static setAchievedEnding(e){const t=s.getParsedValueByKey(i.ACHIEVED_ENDINGS,[]);t.includes(e)||(t.push(e),s.setKeyValuePair(i.ACHIEVED_ENDINGS,t))}}t.GlobalState=s},9975:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MapInfo=t.MapObjectType=void 0;const s=i(7582),n=i(4615),a=s.__importDefault(i(6107));var r;!function(e){e.ENTITY="entity",e.TRIGGER="trigger",e.POINTER="pointer",e.GATE="gate",e.BOUNDS="bounds",e.SOUND="sound"}(r||(t.MapObjectType=r={})),t.MapInfo=class{getObjects(e){const t=a.default.layers.filter(n.isObjectGroup).flatMap((e=>e.objects));return null==e?t:t.filter((t=>t.type===e))}getGameObjectInfos(e){const t=a.default.height*a.default.tileheight;return this.getObjects(e).map((e=>({name:e.name??"",x:e.x,y:t-e.y,type:e.type??"",width:e.width??0,height:e.height??0,properties:(e.properties??[]).reduce(((e,t)=>(e[t.name]=t.value,e)),{})})))}getEntities(){return this.getGameObjectInfos(r.ENTITY)}getSounds(){return this.getGameObjectInfos(r.SOUND)}getPointers(){return this.getGameObjectInfos(r.POINTER)}getTriggerObjects(){return this.getGameObjectInfos(r.TRIGGER)}getBoundObjects(){return this.getGameObjectInfos(r.BOUNDS)}getGateObjects(){return this.getGameObjectInfos(r.GATE)}}},2311:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MenuList=t.SelectMenuItem=t.CheckboxMenuItem=t.SliderMenuItem=t.MenuItem=t.MenuAlignment=void 0;const s=i(7582),n=i(5943),a=i(1531),r=i(1772),o=i(9406);var h;!function(e){e[e.LEFT=0]="LEFT",e[e.CENTER=1]="CENTER",e[e.RIGHT=2]="RIGHT"}(h||(t.MenuAlignment=h={}));class l{constructor(e,t,i,s,n,a,r=null){this.enabled=!0,this.id=e,this.label=t,this.font=i,this.color=s,this.x=n,this.y=a,this.focused=!1,this.data=r}draw(e,t){e.save();const i=this.enabled?1:.35;let s=this.x;const n=this.y,a=this.label,r=this.font.measureText(a).width;t===h.CENTER&&(s-=Math.round(r/2)),this.font.drawText(e,a,s,n,this.color,0,i),this.focused&&e.drawImage(l.selectorImage,s-13,n+2),e.restore()}}t.MenuItem=l,s.__decorate([(0,n.asset)("images/menu_selector.png"),s.__metadata("design:type",HTMLImageElement)],l,"selectorImage",void 0);class d extends l{constructor(e){super(e.id,e.label,e.font,e.color,e.x,e.y,e.data),this.value=e.initialValue,this.minValue=e.minValue,this.maxValue=e.maxValue,this.increment=e.increment,this.rightActionCallback=e.rightActionCallback,this.leftActionCallback=e.leftActionCallback}getValue(){return this.value}setValue(e){this.value=Math.min(this.maxValue,Math.max(this.minValue,e))}increaseValue(){this.setValue(this.value+this.increment),this.rightActionCallback(this.value,this.data)}decreaseValue(){this.setValue(this.value-this.increment),this.leftActionCallback(this.value,this.data)}draw(e){e.save();const t=this.enabled?1:.35,i=this.x,s=this.y,n=this.label;this.font.drawText(e,n,i,s,this.color,0,t);const a=`${this.getValue()} %`,r=this.font.measureText(a).width;this.font.drawText(e,a,i+250-r,s,this.color,0,t),this.focused&&e.drawImage(l.selectorImage,i-13,s+2),e.restore()}}t.SliderMenuItem=d;class u extends l{constructor(e){super(e.id,e.label,e.font,e.color,e.x,e.y,e.data),this.value=e.initialValue,this.actionCallback=e.actionCallback}getValue(){return this.value}setValue(e){this.value=e,this.actionCallback(this.value,this.data)}toggleValue(){this.setValue(!this.getValue())}draw(e){e.save();const t=this.enabled?1:.35,i=this.x,s=this.y,n=this.label;this.font.drawText(e,n,i,s,this.color,0,t);const a=this.value?"On":"Off",r=this.font.measureText(a).width;this.font.drawText(e,a,i+250-r,s,this.color,0,t),this.focused&&e.drawImage(l.selectorImage,i-13,s+2),e.restore()}}t.CheckboxMenuItem=u;class c extends l{constructor(e){super(e.id,e.label,e.font,e.color,e.x,e.y,e.data),this.values=e.values,this.value=e.initialValue,this.valueLabels=e.valueLabels,this.actionCallback=e.actionCallback}getValue(){return this.value}setValue(e){this.value=e,this.actionCallback(this.value,this.data)}cycleValue(){const e=this.values.indexOf(this.value);this.setValue(this.values[e<this.values.length-1?e+1:0])}nextValue(){const e=this.values.indexOf(this.value);e<this.values.length-1&&this.setValue(this.values[e+1])}previousValue(){const e=this.values.indexOf(this.value);e>0&&this.setValue(this.values[e-1])}draw(e){e.save();const t=this.enabled?1:.35,i=this.x,s=this.y,n=this.label;this.font.drawText(e,n,i,s,this.color,0,t);const a=this.valueLabels[this.value]??this.value,r=this.font.measureText(a).width;this.font.drawText(e,a,i+250-r,s,this.color,0,t),this.focused&&e.drawImage(l.selectorImage,i-13,s+2),e.restore()}}t.SelectMenuItem=c;class p extends r.SceneNode{constructor({align:e=h.LEFT,...t}={}){super(t),this.items=[],this.onActivated=new o.Signal,this.onRightAction=new o.Signal,this.onLeftAction=new o.Signal,this.align=e}addItems(...e){this.items.push(...e),this.focusFirstItem()}reset(){this.items=[]}setItems(...e){return this.items=[...e],this.focusFirstItem(),this}focusFirstItem(){if(!this.getFocusedItem()){const e=this.items.findIndex((e=>e.enabled));e>-1&&(this.items[e].focused=!0)}}getFocusedItem(){return this.items.find((e=>e.focused))}getFocusedItemIndex(){return this.items.findIndex((e=>e.focused))}unfocusAllItems(){this.items.forEach((e=>{e.focused=!1}))}focusItem(e){this.unfocusAllItems(),e.focused=!0}findAndFocusNextItem(e,t){const i=t>0?0:this.items.length-1,s=e===(t>0?this.items.length-1:0)?i:e+t;this.items[s].enabled?this.focusItem(this.items[s]):this.findAndFocusNextItem(s,t),p.click.stop(),p.click.play()}next(){this.findAndFocusNextItem(this.getFocusedItemIndex(),1)}prev(){this.findAndFocusNextItem(this.getFocusedItemIndex(),-1)}executeAction(e=p.confirm){const t=this.getFocusedItem();t&&t.enabled&&(e.stop(),e.play(),this.onActivated.emit(t.id),t instanceof u?t.toggleValue():t instanceof c&&t.cycleValue())}executeRightAction(e=p.click){const t=this.getFocusedItem();t&&t.enabled&&(e.stop(),e.play(),this.onRightAction.emit(t.id),t instanceof d?t.increaseValue():t instanceof c&&t.nextValue())}executeLeftAction(e=p.click){const t=this.getFocusedItem();t&&t.enabled&&(e.stop(),e.play(),this.onLeftAction.emit(t.id),t instanceof d?t.decreaseValue():t instanceof c&&t.previousValue())}draw(e){this.items.forEach((t=>{t.draw(e,this.align)}))}}t.MenuList=p,s.__decorate([(0,n.asset)("sounds/interface/click.mp3"),s.__metadata("design:type",a.Sound)],p,"click",void 0),s.__decorate([(0,n.asset)("sounds/interface/confirm.mp3"),s.__metadata("design:type",a.Sound)],p,"confirm",void 0),s.__decorate([(0,n.asset)("sounds/interface/select.mp3"),s.__metadata("design:type",a.Sound)],p,"select",void 0),s.__decorate([(0,n.asset)("sounds/interface/bass.mp3"),s.__metadata("design:type",a.Sound)],p,"pause",void 0)},6820:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MountainRiddle=void 0;const s=i(7582),n=i(5943),a=i(1531),r=i(3595);class o{constructor(){this.attemptCount=0,this.failed=!1,this.cleared=!1,this.solution=this.getRandomizedSolution()}getRandomizedSolution(){const e=[];for(let t=0;t<5;t++)e.push(Math.floor(Math.random()*Math.floor(3)));return e}isCorrectGate(e,t){return this.solution[t]===e}checkGate(e,t){this.failed||this.cleared||this.isCorrectGate(e,t)||this.failRiddle()}wasAttempted(){return this.attemptCount>0}registerAttempt(){this.attemptCount++}failRiddle(){r.Conversation.setGlobal("gotTeleported","true"),this.failed=!0,this.registerAttempt(),o.wrong.play()}isFailed(){return this.failed}resetRiddle(){this.failed&&!this.cleared&&(this.solution=this.getRandomizedSolution(),this.failed=!1)}isCleared(){return this.cleared}clearRiddle(){this.cleared||(o.sound.play(),this.failed=!1,this.cleared=!0)}}t.MountainRiddle=o,s.__decorate([(0,n.asset)("sounds/item/fanfare.mp3"),s.__metadata("design:type",a.Sound)],o,"sound",void 0),s.__decorate([(0,n.asset)("sounds/gate/wrong.ogg"),s.__metadata("design:type",a.Sound)],o,"wrong",void 0)},3121:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.valueCurves=t.ValueCurve=t.Particle=t.ParticleEmitter=t.Particles=void 0;const s=i(4488),n=i(9797),a=i(225);t.Particles=class{constructor(e){this.emitters=[],this.scene=e}update(e){this.emitters.forEach((t=>t.update(e)))}addEmittersToRenderingQueue(){this.emitters.forEach((e=>{this.scene.renderer.add({type:a.RenderingType.PARTICLE_EMITTER,layer:e.renderingLayer,zIndex:e.zIndex,emitter:e})}))}draw(e){}addEmitter(e){this.emitters.push(e)}dropEmitter(e){const t=this.emitters.indexOf(e);return t>=0&&(this.emitters.splice(t,1),!0)}createEmitter(e){const t=new r(e);return this.addEmitter(t),t}};class r{constructor(e){function i(e){return e instanceof Function?e:()=>e}this.particles=[],this.x=e.position.x,this.y=e.position.y,this.offsetGenerator=i(e.offset??{x:0,y:0}),this.velocityGenerator=i(e.velocity??{x:0,y:0}),this.colorGenerator=i(e.color??"white"),this.alphaGenerator=i(e.alpha??1),this.sizeGenerator=i(e.size??4),this.gravityGenerator=i(e.gravity??{x:0,y:s.GRAVITY}),this.lifetimeGenerator=i(e.lifetime??5),this.angleGenerator=i(e.angle??0),this.angleSpeedGenerator=i(e.angleSpeed??0),this.gravity=this.gravityGenerator(),this.breakFactor=e.breakFactor??1,this.blendMode=e.blendMode??"source-over",this.alphaCurve=e.alphaCurve??t.valueCurves.constant,this.sizeCurve=e.sizeCurve??t.valueCurves.constant,this.renderingLayer=e.renderingLayer??a.RenderingLayer.PARTICLES,this.zIndex=e.zIndex??0,this.updateMethod=e.update}setPosition(e,t){this.x=e,this.y=t}clear(){this.particles=[]}emit(e=1){for(let t=0;t<e;t++)this.emitSingle()}emitSingle(){const e=this.velocityGenerator(),t=this.offsetGenerator(),i=new o(this,this.x+t.x,this.y+t.y,e.x,e.y,this.angleGenerator(),this.angleSpeedGenerator(),this.colorGenerator(),this.sizeGenerator(),this.lifetimeGenerator(),this.alphaGenerator());return this.particles.push(i),i}update(e){this.gravity=this.gravityGenerator();for(let t=this.particles.length-1;t>=0;t--)this.particles[t].update(e)&&this.particles.splice(t,1);if(this.updateMethod)for(const e of this.particles)this.updateMethod(e)}draw(e){e.save(),e.globalCompositeOperation=this.blendMode,this.particles.forEach((t=>t.draw(e))),e.restore()}}t.ParticleEmitter=r;class o{constructor(e,t,i,s=0,n=0,a=0,r=0,o="white",h=4,l=1,d=1){this.emitter=e,this.x=t,this.y=i,this.vx=s,this.vy=n,this.angle=a,this.angleSpeed=r,this.imageOrColor=o,this.size=h,this.lifetime=l,this.alpha=d,this.progress=0,this.halfSize=this.size/2,this.originalLifetime=this.lifetime,this.progress=0}update(e){if(this.lifetime-=e,this.lifetime<=0)return!0;if(this.progress=1-this.lifetime/this.originalLifetime,this.vx+=this.emitter.gravity.x*e,this.vy+=this.emitter.gravity.y*e,1!==this.emitter.breakFactor){const t=this.emitter.breakFactor**e;this.vx*=t,this.vy*=t}return this.x+=this.vx*e,this.y+=this.vy*e,this.angle+=this.angleSpeed*e,!1}draw(e){if(e.save(),e.globalAlpha=this.alpha*this.emitter.alphaCurve.get(this.progress),e.translate(this.x,-this.y),this.angle&&e.rotate(this.angle),this.imageOrColor instanceof Object){const t=this.imageOrColor,i=t instanceof HTMLImageElement?t.naturalWidth:t.width,s=t instanceof HTMLImageElement?t.naturalHeight:t.height,a=Math.max(i,s);t instanceof n.Aseprite?(e.save(),e.scale(i/a,s/a),t.draw(e,-this.halfSize,-this.halfSize),e.restore()):e.drawImage(t,-this.halfSize,-this.halfSize,this.size*i/a,this.size*s/a)}else e.fillStyle=this.imageOrColor,e.fillRect(-this.halfSize,-this.halfSize,this.size,this.size);e.restore()}}t.Particle=o;class h{constructor(e,t=1023){this.func=e,this.steps=t,this.mapping=[];for(let i=0;i<=t;i++)this.mapping[i]=e(i/t)}get(e){const t=Math.round(e*this.steps);return this.mapping[t<0?0:t>this.steps?this.steps:t]}getExact(e){return this.func(e)}invert(){return new h((e=>this.getExact(1-e)),this.steps)}append(e,t=1){const i=1+t,s=(i-t)/i;return new h((i=>i<s?this.getExact(i/s):e.getExact((i-s)/t)),Math.max(this.steps,e.steps))}}function l(e,t=e){return i=>i<e?i/e:i>1-t?(1-i)/t:1}t.ValueCurve=h,t.valueCurves={constant:new h((e=>1),1),linear:new h((e=>e)),trapeze:(e=.1,t=e)=>new h(l(e,t)),cos:(e=.1,t=e)=>new h((i=>.5-.5*Math.cos(Math.PI*l(e,t)(i)))),cubic:new h((e=>3*e*e-2*e*e*e))}},3577:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerConversation=void 0;const s=i(2311);t.PlayerConversation=class{constructor(e,t,i,s=!0){if(this.player=e,this.npc=t,this.conversation=i,this.autoMove=s,this.interaction=null,this.selectedOption=-1,this.interaction=this.conversation.getNextInteraction(),this.setSelectedOption(0),this.setBubblesContent(),this.interaction?.npcLine?.executeBeforeLine(),t.meet(),this.autoMove){const i=20;Math.abs(e.x-t.x)<i&&(e.x<t.x?e.startAutoMove(t.x-i,!0):e.startAutoMove(t.x+i,!0))}}update(){return!this.interaction||this.conversation.hasEnded()?(null!=this.player.playerConversation&&this.endConversation(),!0):(this.player.scene.camera.setCinematicBar(1),!1)}setBubblesContent(){if(this.interaction){const e=this.interaction.options.map((e=>e.line));this.interaction.npcLine&&(this.npc.speechBubble.setMessage(this.interaction.npcLine.line),this.npc.speechBubble.show()),e.length>0&&(this.setSelectedOption(0),this.player.speechBubble.setOptions(e,this.npc.speechBubble),this.player.speechBubble.show())}}setSelectedOption(e=0){if(null!=this.interaction&&null!=this.interaction.options&&this.interaction.options.length>0){let t=e%this.interaction.options.length;t<0&&(t+=this.interaction.options.length),this.selectedOption=t}else this.selectedOption=-1;return this.player.speechBubble.selectedOptionIndex=this.selectedOption,this.selectedOption}handleButton(e){if(e.isAbort&&!e.isPause)this.endConversation();else if(!e.repeat){e.isConfirm&&this.proceed();const t=(e.isMenuDown?1:0)-(e.isMenuUp?1:0);0!==t&&(s.MenuList.click.stop(),s.MenuList.click.play(),this.setSelectedOption(this.selectedOption+t))}}proceed(){if(this.interaction){if(this.npc.speechBubble.isCurrentlyWriting||this.npc.speechBubble.preventUnwantedSelection)return void(this.npc.speechBubble.isCurrentlyWriting=!1);const e=this.interaction.options;if(null!=e&&e.length>0){const t=1===e.length?0:this.selectedOption,i=e[t];null!=i?(s.MenuList.select.play(),i.execute()):console.error(`Tried to execute invalid option at index ${t} in interaction around line: ${this.interaction?.npcLine?.toString()}`)}this.interaction.npcLine&&(s.MenuList.click.stop(),s.MenuList.click.play(),this.interaction.npcLine.execute()),this.interaction=this.conversation.getNextInteraction(),this.setSelectedOption(-1),this.setBubblesContent()}this.interaction?this.interaction.npcLine&&(this.npc.face?.setMode(this.npc.defaultFaceMode),this.interaction.npcLine.executeBeforeLine()):this.endConversation()}endConversation(){this.player.playerConversation=null,this.player.speechBubble.hide(),this.npc.speechBubble.hide(),this.npc.registerEndedConversation()}}},8129:(e,t)=>{var i,s,n,a,r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.QuestE=t.QuestD=t.QuestC=t.QuestB=t.QuestA=t.Quest=t.QuestETrigger=t.QuestDTrigger=t.QuestCTrigger=t.QuestBTrigger=t.QuestATrigger=t.QuestKey=void 0,function(e){e.A="questA",e.B="questB",e.C="questC",e.D="questD",e.E="questE"}(i||(t.QuestKey=i={})),function(e){e[e.JUST_ARRIVED=0]="JUST_ARRIVED",e[e.TALKED_TO_FIRE=1]="TALKED_TO_FIRE",e[e.GOT_QUEST_FROM_FIRE=2]="GOT_QUEST_FROM_FIRE",e[e.GOT_RUNNING_ABILITY=3]="GOT_RUNNING_ABILITY",e[e.TALKED_TO_TREE=4]="TALKED_TO_TREE",e[e.GOT_QUEST_FROM_TREE=5]="GOT_QUEST_FROM_TREE",e[e.GOT_SEED=6]="GOT_SEED",e[e.PLANTED_SEED=7]="PLANTED_SEED",e[e.TALKED_TO_STONE=8]="TALKED_TO_STONE",e[e.GOT_STONE=9]="GOT_STONE",e[e.THROWN_STONE_INTO_WATER=10]="THROWN_STONE_INTO_WATER",e[e.GOT_MULTIJUMP=11]="GOT_MULTIJUMP",e[e.LEARNED_RAIN_DANCE=12]="LEARNED_RAIN_DANCE",e[e.MADE_RAIN=13]="MADE_RAIN",e[e.TREE_DROPPED_WOOD=14]="TREE_DROPPED_WOOD",e[e.GOT_WOOD=15]="GOT_WOOD",e[e.TALKED_TO_FIRE_WITH_WOOD=16]="TALKED_TO_FIRE_WITH_WOOD",e[e.THROWN_WOOD_INTO_FIRE=17]="THROWN_WOOD_INTO_FIRE",e[e.APOCALYPSE_STARTED=18]="APOCALYPSE_STARTED",e[e.BEAT_FIRE=19]="BEAT_FIRE",e[e.BEAT_GAME=20]="BEAT_GAME"}(s||(t.QuestATrigger=s={})),function(e){e[e.ENDING_TRIGGERED=0]="ENDING_TRIGGERED"}(n||(t.QuestBTrigger=n={})),function(e){e[e.ENDING_TRIGGERED=0]="ENDING_TRIGGERED"}(a||(t.QuestCTrigger=a={})),function(e){e[e.ENDING_TRIGGERED=0]="ENDING_TRIGGERED"}(r||(t.QuestDTrigger=r={})),function(e){e[e.ENDING_TRIGGERED=0]="ENDING_TRIGGERED"}(o||(t.QuestETrigger=o={}));class h{constructor(e,t,i,s){this.triggers=[],this.finished=!1,this.key=e,this.campaign=t,this.title=i,this.triggers=s.map((e=>({index:e,isTriggered:!1})))}reset(){this.finished=!1,this.triggers.forEach(((e,t)=>{this.untrigger(t)}))}trigger(e){null!=this.triggers[e]&&(this.triggers[e].isTriggered=!0)}untrigger(e){null!=this.triggers[e]&&(this.triggers[e].isTriggered=!1)}getTriggers(){return this.triggers}isTriggered(e){return this.triggers[e].isTriggered||!1}allTriggered(){return this.triggers.every((e=>e.isTriggered))}getHighestTriggerIndex(){return Math.max(...this.triggers.filter((e=>e.isTriggered)).map((e=>e.index)),-1)}finish(){this.finished=!0}isFinished(){return this.finished}}t.Quest=h,t.QuestA=class extends h{constructor(e){super(i.A,e,"[A]POCALYPSE NOT NOW",Object.values(s).filter((e=>"number"==typeof e)))}},t.QuestB=class extends h{constructor(e){super(i.B,e,"GOOD [B]OY",Object.values(n).filter((e=>"number"==typeof e)))}},t.QuestC=class extends h{constructor(e){super(i.C,e,"SOFT LO[C]KED",Object.values(a).filter((e=>"number"==typeof e)))}},t.QuestD=class extends h{constructor(e){super(i.D,e,"[D]ROWNED IN ECSTASY",Object.values(r).filter((e=>"number"==typeof e)))}},t.QuestE=class extends h{constructor(e){super(i.E,e,"AWAK[E]",Object.values(o).filter((e=>"number"==typeof e)))}}},225:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=t.LAYER_ORDER=t.RenderingLayer=t.RenderingType=void 0;const s=i(4488),n=i(6070);var a,r;!function(e){e[e.PARTICLE_EMITTER=0]="PARTICLE_EMITTER",e[e.FIRE=1]="FIRE",e[e.DANCE=2]="DANCE",e[e.BLACK_BARS=3]="BLACK_BARS",e[e.DRAW_IMAGE=4]="DRAW_IMAGE",e[e.ASEPRITE=5]="ASEPRITE",e[e.RECT=6]="RECT",e[e.SPEECH_BUBBLE=7]="SPEECH_BUBBLE",e[e.TEXT=8]="TEXT",e[e.RAW=9]="RAW"}(a||(t.RenderingType=a={})),function(e){e.DEBUG="debug",e.FULLSCREEN_FX="fullscreenFX",e.UI="ui",e.BLACK_BARS="blackBars",e.TILEMAP_FOREGROUND="tilemapForeground",e.PLAYER="player",e.ENTITIES="entities",e.PLATFORMS="platforms",e.TILEMAP_MAP="tilemapMap",e.TILEMAP_BACKGROUND="tilemapBackground",e.PARTICLES="particles"}(r||(t.RenderingLayer=r={})),t.LAYER_ORDER=[r.DEBUG,r.FULLSCREEN_FX,r.UI,r.BLACK_BARS,r.TILEMAP_FOREGROUND,r.PLAYER,r.ENTITIES,r.PARTICLES,r.PLATFORMS,r.TILEMAP_MAP,r.TILEMAP_BACKGROUND],t.Renderer=class{constructor(e){this.layers=t.LAYER_ORDER,this.queue=[],this.scene=e}draw(e){[...this.layers].reverse().forEach((t=>{this.queue.filter((e=>e.layer===t)).forEach((t=>{if(t.type===a.BLACK_BARS)this.scene.camera.drawBars(e);else if(t.type===a.PARTICLE_EMITTER)t.emitter.draw(e);else if(t.type===a.FIRE)t.entity.drawToCanvas(e);else if(t.type===a.DANCE)t.dance.draw(e);else if(t.type===a.RAW)t.draw(e);else{switch(e.save(),t.translation&&e.translate(t.translation.x,t.translation.y),t.scale&&e.scale(t.scale.x,t.scale.y),!0===t.relativeToScreen&&(this.scene.camera.unapplyTransform(e),e.translate(-s.GAME_CANVAS_WIDTH/2,-s.GAME_CANVAS_HEIGHT/2)),t.globalCompositeOperation&&(e.globalCompositeOperation=t.globalCompositeOperation),void 0!==t.alpha&&(e.globalAlpha=t.alpha),t.type){case a.DRAW_IMAGE:e.drawImage(t.asset,t.position.x,t.position.y);break;case a.ASEPRITE:t.asset.drawTag(e,t.animationTag,t.position.x,t.position.y,t.time);break;case a.RECT:null!=t.lineColor?(e.strokeStyle=t.lineColor,e.lineWidth=t.lineWidth??1,e.strokeRect(t.position.x,t.position.y,t.dimension.width,t.dimension.height)):null!=t.fillColor&&(e.fillStyle=t.fillColor,e.fillRect(t.position.x,t.position.y,t.dimension.width,t.dimension.height));break;case a.SPEECH_BUBBLE:e.beginPath(),(e=(0,n.roundRect)(e,Math.round(t.position.x),Math.round(t.position.y),Math.round(t.dimension.width),Math.round(t.dimension.height),t.radius,t.up,Math.round(t.offsetX))).fillStyle=t.fillColor,e.fill(),e.closePath();break;case a.TEXT:null!=t.outlineColor?t.asset.drawTextWithOutline(e,t.text,t.position.x,t.position.y,t.textColor,t.outlineColor):t.asset.drawText(e,t.text,t.position.x,t.position.y,t.textColor)}e.restore()}}))})),this.queue=[]}add(e){this.queue.push(e)}addAseprite(e,t,i,s,n,r=1,o,h){const l=r<0?{x:-1,y:1}:void 0;this.add({type:a.ASEPRITE,layer:n,translation:{x:i,y:-s},position:{x:-e.width>>1,y:-e.height},scale:l,alpha:h,asset:e,animationTag:t,time:o??1e3*this.scene.gameTime})}}},2346:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Scene=void 0;const s=i(6038),n=i(4237);t.Scene=class{constructor(e){this.game=e,this.zIndex=0,this.currentTransition=null,this.inTransition=null,this.outTransition=null,this.usedLayers=0,this.hiddenLayers=0,this.backgroundStyle=null,this.rootNode=new n.RootNode(this,((e,t)=>{this.updateRootNode=e,this.drawRootNode=t})),this.rootNode.resizeTo(this.game.width,this.game.height)}get keyboard(){return this.game.keyboard}get input(){return s.ControllerManager.getInstance()}get scenes(){return this.game.scenes}get urlFragment(){return"#"}showLayer(e){return this.hiddenLayers&=~(1<<e),this}hideLayer(e){return this.hiddenLayers|=1<<e,this}isLayerHidden(e){return 0!=(this.hiddenLayers&1<<e)}isLayerShown(e){return 0==(this.hiddenLayers&1<<e)}getNodeById(e){return this.rootNode.getDescendantById(e)}getBackgroundStyle(){return this.backgroundStyle}setBackgroundStyle(e){return this.backgroundStyle=e,this}isActive(){return this.scenes.activeScene===this}setup(e){}activate(){}deactivate(){}cleanup(){}update(e){this.usedLayers=this.updateRootNode(e)}draw(e,t,i){null!=this.backgroundStyle&&(e.save(),e.fillStyle=this.backgroundStyle,e.fillRect(0,0,t,i));let s=1,n=this.usedLayers&~this.hiddenLayers;for(;0!==n;)1==(1&n)&&this.drawRootNode(e,s,t,i),n>>>=1,s<<=1;null!=this.backgroundStyle&&e.restore()}}},7419:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Scenes=void 0;const n=i(7582);t.Scenes=class{set activeScene(e){n.__classPrivateFieldSet(this,s,e,"f"),window.history.replaceState(null,"",e?.urlFragment??"#")}get activeScene(){return n.__classPrivateFieldGet(this,s,"f")}constructor(e){this.game=e,s.set(this,null),this.sceneCache=new WeakMap,this.scenes=[],this.sortedScenes=[]}createScene(e){let t=this.sceneCache.get(e);return null==t&&(t=new e(this.game),this.sceneCache.set(e,t)),t}async pushScene(e,t){null!=this.activeScene&&await this.activeScene.deactivate();const i=this.createScene(e);await i.setup(t),this.scenes.push(i),this.updateSortedScenes(),null!=i.inTransition&&(i.currentTransition=i.inTransition,await i.currentTransition.start("in"),i.currentTransition=null),await i.activate(),this.activeScene=i}getPreviousScene(){return this.scenes[this.scenes.length-2]??null}async popScene({noTransition:e=!1}={}){const t=this.activeScene;return null!=t&&(await t.deactivate(),e||null==t.outTransition||(t.currentTransition=t.outTransition,await t.currentTransition.start("out"),t.currentTransition=null),this.scenes.pop(),this.updateSortedScenes(),await t.cleanup(),this.activeScene=this.scenes[this.scenes.length-1]??null,null!=this.activeScene&&await this.activeScene.activate()),t}async setScene(e,t){const i=this.activeScene;if(null==i)return this.pushScene(e,t);await i.deactivate();let s=null;i.outTransition&&(i.currentTransition=i.outTransition,s=i.currentTransition.start("out"));const n=this.scenes.length-1,a=this.createScene(e);await a.setup(t),this.scenes.push(a),this.updateSortedScenes(),null!=a.inTransition&&(a.currentTransition=a.inTransition,await a.currentTransition.start("in"),a.currentTransition=null),await a.activate(),this.activeScene=a,null!=s&&(await s,i.currentTransition=null),this.scenes.splice(n,1),this.updateSortedScenes(),await i.cleanup()}updateSortedScenes(){this.sortedScenes=this.scenes.slice().sort(((e,t)=>e.zIndex===t.zIndex?this.scenes.indexOf(e)-this.scenes.indexOf(t):e.zIndex-t.zIndex))}update(e){this.sortedScenes.forEach((t=>{t.currentTransition?.update(e),t.update(e)}))}draw(e,t,i){this.sortedScenes.forEach((s=>{e.save(),null!=s.currentTransition?s.currentTransition.draw(e,(()=>s.draw(e,t,i)),t,i):s.draw(e,t,i),e.restore()}))}},s=new WeakMap},9406:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Signal=void 0;class i{constructor(e,t){this.callback=e,this.context=t}call(e){this.callback.call(this.context,e)}}class s{constructor(e){this.slots=[],this.onDone=null,this.onInit=e??null}connect(e,t){return null!=this.onInit&&0===this.slots.length&&(this.onDone=this.onInit(this)||null),this.slots.push(new i(e,t)),()=>this.disconnect(e,t)}disconnect(e,t){const i=this.slots.findIndex((i=>i.callback===e&&i.context===t));i>=0&&this.slots.splice(i,1),null!=this.onDone&&0===this.slots.length&&(this.onDone(this),this.onDone=null)}emit(e){this.slots.forEach((t=>t.call(e)))}filter(e){return new s((t=>this.connect((i=>{e(i)&&t.emit(i)}))))}map(e){return new s((t=>this.connect((i=>t.emit(e(i))))))}}t.Signal=s},617:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpeechBubble=void 0;const s=i(7582),n=i(4488),a=i(5943),r=i(8585),o=i(3595),h=i(225),l=i(6070);class d{constructor(e,t,i,s=!1){this.scene=e,this.anchorX=t,this.anchorY=i,this.up=s,this.messageLines=[],this.options=[],this.selectedOptionIndex=-1,this.fontSize=d.font.charHeight,this.lineHeight=this.fontSize,this.height=0,this.offset={x:0,y:40},this.messageVelocity=20,this.isCurrentlyWriting=!1,this.preventUnwantedSelection=!1,this.isVisible=!1,this.content=[],this.longestLine=0,this.partnersBubble=null,this.lineHeightFactor=1,this.paddingTop=3,this.paddingBottom=4,this.paddingLeft=7,this.paddingRight=7,this.color="white",this.x=Math.round(t+this.offset.x),this.y=Math.round(i+this.offset.y),this.lineHeight=Math.round(this.fontSize*this.lineHeightFactor),this.paddingHorizontal=this.paddingLeft+this.paddingRight,this.paddingVertical=this.paddingTop+this.paddingBottom}show(){this.isVisible=!0}hide(){this.isVisible=!1}hasContent(){return this.content.length>0&&(!this.partnersBubble||!this.partnersBubble.isCurrentlyWriting&&this.selectedOptionIndex>-1)}async setMessage(e){this.messageLines=[""],this.isCurrentlyWriting=!0,this.longestLine=this.determineMaxLineLength(e.split("\n"));let t=0;for(const i of e)i?"\n"!==i?(this.messageLines[t]+=i,this.isCurrentlyWriting&&await(0,l.sleep)(this.messageVelocity),this.updateContent()):(t++,this.messageLines.push("")):t++;this.preventUnwantedSelection=!0,this.updateContent(),this.isCurrentlyWriting=!1,await(0,l.sleep)(300),this.preventUnwantedSelection=!1}setOptions(e,t){this.partnersBubble=t,this.options=e,this.selectedOptionIndex=this.options.length>0?0:-1,this.updateContent(),this.longestLine=this.determineMaxLineLength(this.messageLines)}updateContent(){this.content=this.messageLines.concat(this.options),this.height=(this.content.length-1)*this.lineHeight+this.fontSize+this.paddingVertical}draw(e){if(!(this.isVisible&&this.hasContent()&&this.scene.camera.isOnTarget()&&this.scene.isActive()))return;let t=this.x;const i=this.y;let s=0;const a=t-this.scene.camera.getVisibleRect().x,r=Math.max(this.longestLine/2+a-n.GAME_CANVAS_WIDTH,0)||Math.min(a-this.longestLine/2,0);0!==r&&(s=r+10*Math.sign(r)),t-=s;const l=t-Math.round(this.longestLine/2)-this.paddingLeft,u=this.up?45-i:-i-this.height;this.scene.renderer.add({type:h.RenderingType.SPEECH_BUBBLE,layer:h.RenderingLayer.UI,fillColor:this.color,position:{x:l,y:u},dimension:{width:this.longestLine+this.paddingHorizontal,height:this.height},radius:5,up:this.up,offsetX:s});const c=l+this.paddingLeft,p="black";for(let e=0;e<this.messageLines.length;e++){const t=Math.round(u+this.paddingTop+e*this.lineHeight);this.scene.renderer.add({type:h.RenderingType.TEXT,layer:h.RenderingLayer.UI,text:this.messageLines[e],textColor:p,position:{x:c,y:t},asset:d.font})}for(let e=0;e<this.options.length;e++){const t=this.selectedOptionIndex===e,i=Math.round(u+this.paddingTop+e*this.lineHeight);t&&this.scene.renderer.add({type:h.RenderingType.TEXT,layer:h.RenderingLayer.UI,text:o.ConversationLine.OPTION_MARKER,textColor:p,position:{x:c,y:i},asset:d.font}),this.scene.renderer.add({type:h.RenderingType.TEXT,layer:h.RenderingLayer.UI,text:this.options[e],textColor:p,position:{x:c+d.OPTION_BUBBLE_INDENTATION,y:i},asset:d.font})}}update(e,t){this.x=Math.round(e+this.offset.x),this.y=Math.round(t+this.offset.y)}determineMaxLineLength(e){let t=e.map((e=>d.font.measureText(e).width));return t=t.concat(this.options.map((e=>d.font.measureText(e).width+d.OPTION_BUBBLE_INDENTATION))),Math.max(...t)}}t.SpeechBubble=d,d.OPTION_BUBBLE_INDENTATION=11,s.__decorate([(0,a.asset)(n.DIALOG_FONT),s.__metadata("design:type",r.BitmapFont)],d,"font",void 0)},7391:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Transition=void 0;const s=i(8946),n=i(6070);t.Transition=class{constructor({duration:e=.5,easing:t=s.linear}={}){this.type="out",this.elapsed=0,this.resolve=null,this.promise=null,this.duration=e,this.easing=t}valueOf(){const e=this.easing((0,n.clamp)(this.elapsed/this.duration,0,1));return"out"===this.type?e:1-e}update(e){null!=this.promise&&(this.elapsed+=e,this.elapsed>=this.duration&&this.stop())}async start(e){return null==this.promise&&(this.type=e,this.elapsed=0,this.promise=new Promise((e=>{this.resolve=e}))),this.promise}stop(){null!=this.resolve&&(this.resolve(),this.resolve=null,this.promise=null)}}},8875:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.World=t.validEnvironments=t.Environment=void 0;const s=i(7582),n=i(4488),a=i(5943),r=i(1809),o=i(8557),h=i(3121),l=i(225),d=i(1193),u=i(6070);var c;!function(e){e[e.AIR=0]="AIR",e[e.SOLID=4278190080]="SOLID",e[e.PLATFORM=4286545791]="PLATFORM",e[e.BOUNCE=4294901760]="BOUNCE",e[e.WATER=4278190335]="WATER",e[e.SOIL=4294967040]="SOIL",e[e.RAINCLOUD=4278255360]="RAINCLOUD"}(c||(t.Environment=c={})),t.validEnvironments=Object.values(c);class p{constructor(e){this.raining=!1,this.scene=e;const t=this.scene.pointsOfInterest.find((e=>"rain_spawn_position"===e.name));if(!t)throw new Error("Missing 'rain_spawn_position' point in map data to place rain emitter");this.rainEmitter=this.scene.particles.createEmitter({position:{x:t.x,y:t.y},offset:()=>({x:26*(0,u.rnd)(-1,1),y:5*(0,u.rnd)(-1,1)}),velocity:()=>({x:5*(0,u.rnd)(-1,1),y:-(0,u.rnd)(50,80)}),color:()=>p.raindrop,size:4,gravity:{x:0,y:-100},lifetime:()=>3,alpha:.6,alphaCurve:h.valueCurves.linear.invert()})}getWidth(){return p.foreground.width}getHeight(){return p.foreground.height}update(){this.raining&&this.rainEmitter.emit((0,u.rndInt)(1,4))}draw(e,t,i){const s=this.scene.camera,a=s.x,r=s.y,o=1-a/this.getWidth()*2,h=1-r/this.getHeight()*2;let d=1;if(this.scene.pettingCutscene&&(d=Math.max(0,1-this.scene.pettingCutsceneTime/n.PETTING_ENDING_CUTSCENE_DURATION)),this.scene.windowCutscene&&(d=Math.max(0,1-this.scene.windowCutsceneTime/(n.WINDOW_ENDING_CUTSCENE_DURATION/1.5))),this.scene.renderer.add({type:l.RenderingType.DRAW_IMAGE,layer:l.RenderingLayer.TILEMAP_MAP,translation:{x:a,y:-r},position:{x:-a,y:-this.getHeight()+r},asset:p.foreground,alpha:d}),s.isZoomingOut()){const e=p.debugBackground,t=this.getWidth()/e.width,i=this.getHeight()/e.height;this.scene.renderer.add({type:l.RenderingType.DRAW_IMAGE,layer:l.RenderingLayer.TILEMAP_BACKGROUND,translation:{x:a,y:-r},position:{x:-a/t,y:(-this.getHeight()+r)/i},scale:{x:t,y:i},asset:e})}else for(const e of p.backgrounds){const s=this.getWidth()/e.width,n=this.getHeight()/e.height;this.scene.renderer.add({type:l.RenderingType.DRAW_IMAGE,layer:l.RenderingLayer.TILEMAP_BACKGROUND,translation:{x:a,y:-r},position:{x:-a/s+t/2*-o,y:(-this.getHeight()+r)/n-i/2*-h},asset:e,alpha:d})}}getEnvironment(e,t){const i=(this.getHeight()-1-Math.round(t))*this.getWidth()+Math.round(e);return i<0||i>=p.collisionMap.length?c.AIR:p.collisionMap[i]}collidesWith(e,i,s=[],n=[]){for(const t of this.scene.gameObjects)if(t!==this&&!s.includes(t)&&(0,d.isCollidableGameObject)(t)){const s=t.collidesWith(e,i);if(s!==c.AIR&&!n.includes(s))return s}const a=(this.getHeight()-1-Math.round(i))*this.getWidth()+Math.round(e);if(a<0||a>=p.collisionMap.length)return 0;const r=this.getEnvironment(e,i);return!t.validEnvironments.includes(r)||null!=n&&n.includes(r)?c.AIR:p.collisionMap[a]}getEntityCollisions(e,t=0,i=[]){const s=[];for(const n of this.scene.gameObjects)n!==e&&!(n instanceof h.Particles)&&n instanceof r.Entity&&n.isTrigger&&!i.includes(n)&&this.boundingBoxesCollide(e.getBounds(t),n.getBounds(t))&&s.push(n);return s}getTriggerCollisions(e){const t=[];for(const i of this.scene.triggerObjects)this.boundingBoxesCollide(e.getBounds(),(0,u.boundsFromMapObject)(i))&&this.entityIsAvailableInNewGameState(i.properties.newGamePlus)&&t.push(i);return t}entityIsAvailableInNewGameState(e){return void 0===e||!1===e&&!this.scene.game.campaign.isNewGamePlus||!0===e&&this.scene.game.campaign.isNewGamePlus}getGateCollisions(e){const t=[];for(const i of this.scene.gateObjects)this.boundingBoxesCollide(e.getBounds(),(0,u.boundsFromMapObject)(i,0))&&!0!==i.properties.disabled&&this.entityIsAvailableInNewGameState(i.properties.newGamePlus)&&t.push(i);return t}getCameraBounds(e){const t=[];for(const i of this.scene.boundObjects)this.boundingBoxesCollide(e.getBounds(),(0,u.boundsFromMapObject)(i))&&t.push(i);return t}boundingBoxesCollide(e,t){return!(e.y-e.height>t.y||e.y<t.y-t.height||e.x+e.width<t.x||e.x>t.x+t.width)}getObjectAt(e,t,i=[],s=[]){for(const n of this.scene.gameObjects)if(n!==this&&!i.includes(n)&&(0,d.isCollidableGameObject)(n)){const i=n.collidesWith(e,t);if(i!==c.AIR&&!s.includes(i))return n}return null}collidesWithVerticalLine(e,t,i,s,n){for(let a=0;a<i;a++){const i=this.collidesWith(e,t-a,s,n);if(i)return i}return 0}getGround(e,t,i,s){for(;t>0&&!this.collidesWith(e,t,i,s);)t--;return t}startRain(){this.raining=!0}stopRain(){this.raining=!1}isRaining(){return this.raining}}t.World=p,s.__decorate([(0,a.asset)("maps/level.png"),s.__metadata("design:type",HTMLImageElement)],p,"foreground",void 0),s.__decorate([(0,a.asset)("maps/level_collision.png",{map:e=>new Uint32Array((0,o.getImageData)(e).data.buffer)}),s.__metadata("design:type",Uint32Array)],p,"collisionMap",void 0),s.__decorate([(0,a.asset)(["maps/bg.png","maps/bg2.png","maps/bg3.png"]),s.__metadata("design:type",Array)],p,"backgrounds",void 0),s.__decorate([(0,a.asset)("maps/bg-debug.png"),s.__metadata("design:type",HTMLImageElement)],p,"debugBackground",void 0),s.__decorate([(0,a.asset)("images/raindrop.png"),s.__metadata("design:type",HTMLImageElement)],p,"raindrop",void 0)},8482:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAudioContext=void 0;const s=i(6038),n=window.AudioContext??window.webkitAudioContext;let a=null;t.getAudioContext=function(e=s.ControllerManager.getInstance()){if(null==a&&(a=new n,"suspended"===a.state)){const t=()=>{a?.resume()};e.onButtonDown.connect(t),document.addEventListener("pointerdown",t),a.addEventListener("statechange",(()=>{"running"===a?.state&&(e.onButtonDown.disconnect(t),document.removeEventListener("pointerdown",t))}))}return a}},3888:(e,t,i)=>{var s,n,a,r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.AudioManager=void 0;const h=i(7582),l=i(6673),d=i(6070),u=i(8482),c=i(3860);class p{static getInstance(){return h.__classPrivateFieldGet(s,s,"f",n)}constructor(e){a.set(this,void 0),r.set(this,void 0),o.set(this,void 0),h.__classPrivateFieldSet(this,a,e,"f");const t=(0,u.getAudioContext)();h.__classPrivateFieldSet(this,r,t.createGain(),"f"),h.__classPrivateFieldGet(this,r,"f").connect(t.destination),h.__classPrivateFieldGet(this,r,"f").gain.value=e.music.gain,h.__classPrivateFieldSet(this,o,t.createGain(),"f"),h.__classPrivateFieldGet(this,o,"f").connect(t.destination),h.__classPrivateFieldGet(this,o,"f").gain.value=e.sfx.gain}get musicGainNode(){return h.__classPrivateFieldGet(this,r,"f")}get sfxGainNode(){return h.__classPrivateFieldGet(this,o,"f")}get musicGain(){return h.__classPrivateFieldGet(this,r,"f").gain.value}set musicGain(e){e=(0,d.clamp)(e,c.MIN_GAIN_VALUE,c.MAX_GAIN_VALUE),h.__classPrivateFieldGet(this,a,"f").music.gain=e,h.__classPrivateFieldGet(this,r,"f").gain.value!==e&&(h.__classPrivateFieldGet(this,r,"f").gain.value=e)}get sfxGain(){return h.__classPrivateFieldGet(this,o,"f").gain.value}set sfxGain(e){e=(0,d.clamp)(e,c.MIN_GAIN_VALUE,c.MAX_GAIN_VALUE),h.__classPrivateFieldGet(this,a,"f").sfx.gain=e,h.__classPrivateFieldGet(this,o,"f").gain.value!==e&&(h.__classPrivateFieldGet(this,o,"f").gain.value=e)}}t.AudioManager=p,s=p,a=new WeakMap,r=new WeakMap,o=new WeakMap,n={value:new s(l.Preferences.getInstance().audio)}},915:(e,t,i)=>{var s,n;Object.defineProperty(t,"__esModule",{value:!0}),t.AudioPreferencesStore=void 0;const a=i(7582),r=i(6070),o=i(3860),h="audio.music.gain",l="audio.sfx.gain";class d{constructor(){null==window.localStorage.getItem(h)&&(this.gain=o.DEFAULT_GAIN_VALUE)}get gain(){return(0,r.clamp)(Number(window.localStorage.getItem(h)??o.DEFAULT_GAIN_VALUE),o.MIN_GAIN_VALUE,o.MAX_GAIN_VALUE)}set gain(e){window.localStorage.setItem(h,e.toFixed(2))}}class u{constructor(){null==window.localStorage.getItem(l)&&(this.gain=o.DEFAULT_GAIN_VALUE)}get gain(){return(0,r.clamp)(Number(window.localStorage.getItem(l)??o.DEFAULT_GAIN_VALUE),o.MIN_GAIN_VALUE,o.MAX_GAIN_VALUE)}set gain(e){window.localStorage.setItem(l,e.toFixed(2))}}t.AudioPreferencesStore=class{get music(){return a.__classPrivateFieldGet(this,s,"f")}get sfx(){return a.__classPrivateFieldGet(this,n,"f")}constructor(){s.set(this,void 0),n.set(this,void 0),a.__classPrivateFieldSet(this,s,new d,"f"),a.__classPrivateFieldSet(this,n,new u,"f")}},s=new WeakMap,n=new WeakMap},1531:(e,t,i)=>{var s,n;Object.defineProperty(t,"__esModule",{value:!0}),t.Sound=void 0;const a=i(7582),r=i(6070),o=i(8482),h=i(3888),l=i(4973);class d{constructor(e,t){let i;switch(this.buffer=e,s.set(this,void 0),n.set(this,void 0),this.source=null,this.loop=!1,a.__classPrivateFieldSet(this,s,h.AudioManager.getInstance(),"f"),a.__classPrivateFieldSet(this,n,t,"f"),this.gainNode=(0,o.getAudioContext)().createGain(),a.__classPrivateFieldGet(this,n,"f")){case l.SoundChannel.MUSIC:i=this.audioManager.musicGainNode;break;case l.SoundChannel.SFX:i=this.audioManager.sfxGainNode;break;default:throw new Error(`Unknown sound channel: ${t}.`)}this.gainNode.connect(i)}get audioManager(){return a.__classPrivateFieldGet(this,s,"f")}static async load(e,t=l.SoundChannel.SFX){const i=await(await fetch(e)).arrayBuffer(),s=await(0,o.getAudioContext)().decodeAudioData(i);return new d(s,t)}isPlaying(){return null!=this.source}play(){if(!this.isPlaying()){const e=(0,o.getAudioContext)().createBufferSource();e.buffer=this.buffer,e.loop=this.loop,e.connect(this.gainNode),e.addEventListener("ended",(()=>{this.source===e&&(this.source=null)})),this.source=e,e.start()}}stop(){if(this.source){try{this.source.stop()}catch(e){}this.source=null}}setLoop(e){this.loop=e,this.source&&(this.source.loop=e)}setVolume(e){const t=this.gainNode.gain;t.value=(0,r.clamp)(e,t.minValue,t.maxValue)}}t.Sound=d,s=new WeakMap,n=new WeakMap},4973:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SoundChannel=void 0,function(e){e.MUSIC="music",e.SFX="sfx"}(i||(t.SoundChannel=i={}))},3882:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SoundEmitter=void 0;const s=i(1809),n=i(6070);class a extends s.Entity{constructor({sound:e,maxVolume:t,intensity:i,...s}){super({width:1,height:1,...s}),this.sound=e,this.maxVolume=t,this.intensity=i}draw(){}update(){const e=this.scene.paused?0:(0,n.calculateVolume)(this.distanceToPlayer,this.maxVolume,this.intensity);e?(this.sound.setVolume(e),this.sound.isPlaying()||this.sound.play()):this.sound.stop()}static fromGameObjectInfo(e,t){const i=t.properties.sound,s=t.properties.volume??1,n=t.properties.intensity??1;if(null!=i){const r=e.ambientSounds[i];if(null!=r)return new a({scene:e,x:t.x,y:t.y,sound:r,maxVolume:s,intensity:n});throw new Error(`Cannot create sound emitter because '${i}' is not a valid ambient sound ID.`)}throw new Error("Cannot create sound emitter because 'sound' property is empty.")}}t.SoundEmitter=a},3860:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_GAIN_VALUE=t.MAX_GAIN_VALUE=t.MIN_GAIN_VALUE=void 0,t.MIN_GAIN_VALUE=0,t.MAX_GAIN_VALUE=1,t.DEFAULT_GAIN_VALUE=t.MAX_GAIN_VALUE},69:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FullscreenManager=void 0;const s=i(2066);var n;!function(e){e.getInstance=()=>a}(n||(t.FullscreenManager=n={}));const a=new s.WebFullscreenManager},2066:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebFullscreenManager=void 0,t.WebFullscreenManager=class{async isEnabled(){return Promise.resolve(document.fullscreenEnabled&&null!=document.fullscreenElement)}async setEnabled(e){const t=document.fullscreenElement;return document.fullscreenEnabled?e&&t!==document.documentElement?document.documentElement.requestFullscreen({navigationUI:"hide"}):e||null==t?void 0:document.exitFullscreen():Promise.resolve()}}},8946:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.easeInOutBounce=t.easeInBounce=t.easeOutBounce=t.easeInOutElastic=t.easeOutElastic=t.easeInElastic=t.easeInOutBack=t.easeOutBack=t.easeInBack=t.easeInOutCirc=t.easeOutCirc=t.easeInCirc=t.easeInOutExpo=t.easeOutExpo=t.easeInExpo=t.easeInOutQuint=t.easeOutQuint=t.easeInQuint=t.easeInOutQuart=t.easeOutQuart=t.easeInQuart=t.easeInOutCubic=t.easeOutCubic=t.easeInCubic=t.easeInOutQuad=t.easeOutQuad=t.easeInQuad=t.easeInOutSine=t.easeOutSine=t.easeInSine=t.linear=void 0;const{PI:i,cos:s,sin:n}=Math;function a(e){return e<4/11?121*e*e/16:e<8/11?121*e*e/16-33*e/4+3:e<10/11?121*e*e/16-99*e/8+6:121*e*e/16-231*e/16+63/8}function r(e){return 1-a(1-e)}t.linear=function(e){return e},t.easeInSine=function(e){return 1-s(e*i/2)},t.easeOutSine=function(e){return n(e*i/2)},t.easeInOutSine=function(e){return.5-s(i*e)/2},t.easeInQuad=function(e){return e*e},t.easeOutQuad=function(e){return e*(2-e)},t.easeInOutQuad=function(e){return e<.5?2*e*e:4*e-2*e*e-1},t.easeInCubic=function(e){return e**3},t.easeOutCubic=function(e){return e**3+3*(e-e*e)},t.easeInOutCubic=function(e){return e<.5?4*e**3:4*e**3+12*(e-e*e)-3},t.easeInQuart=function(e){return e**4},t.easeOutQuart=function(e){return 1-(e-1)**4},t.easeInOutQuart=function(e){return e<.5?8*e**4:1-8*(e-1)**4},t.easeInQuint=function(e){return e**5},t.easeOutQuint=function(e){return 1+(e-1)**5},t.easeInOutQuint=function(e){return e<.5?16*e**5:1+16*(e-1)**5},t.easeInExpo=function(e){return e<=0?0:2**(10*(e-1))},t.easeOutExpo=function(e){return e>=1?1:1-1/1024**e},t.easeInOutExpo=function(e){return e<=0?0:e>=1?1:e<.5?1048576**e/2048:1-512/1048576**e},t.easeInCirc=function(e){return 1-(1-e*e)**.5},t.easeOutCirc=function(e){return(2*e-e*e)**.5},t.easeInOutCirc=function(e){return e<.5?.5-(.25-e*e)**.5:((4*e*(2-e)-3)**.5+1)/2},t.easeInBack=function(e){return 2.70158*e**3-1.70158*e*e},t.easeOutBack=function(e){return 2.70158*e**3-6.40316*e*e+4.70158*e},t.easeInOutBack=function(e){return e<.5?14.379638*e**3-5.189819*e*e:14.379638*e**3-37.949095*e*e+32.759276*e-8.189819},t.easeInElastic=function(e){return e<=0?0:e>=1?1:1024**(e-1)*-n(i*(20*e/3-43/6))},t.easeOutElastic=function(e){return e<=0?0:e>=1?1:n(i*(20*e/3-.5))/1024**e+1},t.easeInOutElastic=function(e){return e<=0?0:e>=1?1:e<.5?1048576**e/-2048*n(i*(80*e/9-89/18)):512/1048576**e*n(i*(80*e/9-89/18))+1},t.easeOutBounce=a,t.easeInBounce=r,t.easeInOutBounce=function(e){return e<.5?r(2*e)/2:a(2*e-1)/2+.5}},1284:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Bird=void 0;const n=i(7582),a=i(4488),r=n.__importDefault(i(1466)),o=i(9797),h=i(5943),l=i(1531),d=i(3595),u=i(1809),c=i(3121),p=i(225),g=i(6070),m=i(8875),y=i(3995);var f;!function(e){e[e.WAITING_LEFT=0]="WAITING_LEFT",e[e.FLYING_RIGHT=1]="FLYING_RIGHT",e[e.WAITING_RIGHT=2]="WAITING_RIGHT",e[e.FLYING_LEFT=3]="FLYING_LEFT"}(f||(f={}));let _=s=class extends y.NPC{constructor(e){super({width:28,height:24,...e}),this.move=1,this.jumpHeight=1.5,this.waitTimer=0,this.state=f.WAITING_LEFT,this.jumpTimer=0,this.minAltitude=e.y,this.conversation=new d.Conversation(r.default,this),this.doubleJumpEmitter=this.scene.particles.createEmitter({position:{x:this.x,y:this.y},velocity:()=>({x:90*(0,g.rnd)(-1,1),y:100*(0,g.rnd)(-1,0)}),color:()=>(0,g.rndItem)(a.DOUBLE_JUMP_COLORS),size:(0,g.rnd)(1,2),gravity:{x:0,y:-120},lifetime:()=>(0,g.rnd)(.4,.6),alphaCurve:c.valueCurves.trapeze(.05,.2)}),this.setMaxVelocity(4)}isWaiting(){return this.state===f.WAITING_LEFT||this.state===f.WAITING_RIGHT}jump(){if(this.jumpTimer=.3,this.setVelocityY(Math.sqrt(2*this.jumpHeight*a.GRAVITY)),this.doubleJumpEmitter.setPosition(this.x,this.y+20),!this.scene.pettingCutscene){this.doubleJumpEmitter.emit(20);const e=(0,g.calculateVolume)(this.distanceToPlayer,.4);e>0&&(s.jumpSound.setVolume(e),s.jumpSound.stop(),s.jumpSound.play())}}canJump(){return 0===this.jumpTimer}updatePosition(e,t){this.x=e,this.y=t,0===this.pullOutOfGround()&&0===this.pullOutOfCeiling()||this.setVelocityY(0),0!==this.pullOutOfWall()&&this.setVelocityX(0)}pullOutOfGround(){let e=0,t=0;if(this.getVelocityY()<=0){const i=this.scene.world,s=i.getHeight();for(t=i.collidesWith(this.x,this.y,[this],[m.Environment.WATER]);this.y<s&&t;)e++,this.y++,t=i.collidesWith(this.x,this.y)}return e}pullOutOfCeiling(){let e=0;const t=this.scene.world;for(;this.y>0&&t.collidesWith(this.x,this.y+this.height,[this],[m.Environment.PLATFORM,m.Environment.WATER]);)e++,this.y--;return e}pullOutOfWall(){let e=0;const t=this.scene.world;if(this.getVelocityX()>0)for(;t.collidesWithVerticalLine(this.x+this.width/2,this.y+3*this.height/4,this.height/2,[this],[m.Environment.PLATFORM,m.Environment.WATER]);)this.x--,e++;else for(;t.collidesWithVerticalLine(this.x-this.width/2,this.y+3*this.height/4,this.height/2,[this],[m.Environment.PLATFORM,m.Environment.WATER]);)this.x++,e++;return e}nextState(){this.state===f.FLYING_LEFT?this.state=f.WAITING_LEFT:this.state=this.state+1}isReadyForConversation(){return!0===super.isReadyForConversation()&&this.isWaiting()}draw(e){let t;this.scene.pettingCutscene&&(t=Math.max(0,1-this.scene.pettingCutsceneTime/a.PETTING_ENDING_CUTSCENE_DURATION)),this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y,p.RenderingLayer.ENTITIES,this.direction,void 0,t),this.speechBubble.draw(e)}update(e){super.update(e),this.move=0;const t=this.scene.world.getTriggerCollisions(this);this.jumpTimer>0&&(this.jumpTimer-=e,this.jumpTimer<0&&(this.jumpTimer=0)),this.state!==f.WAITING_LEFT&&this.state!==f.WAITING_RIGHT||this.hasActiveConversation()||(this.waitTimer+=e,this.waitTimer>=5&&(this.waitTimer=0,this.nextState())),this.state!==f.FLYING_RIGHT&&this.state!==f.FLYING_LEFT||(this.move=this.state===f.FLYING_RIGHT?1:-1,this.y<this.minAltitude&&this.canJump()&&this.jump(),this.state===f.FLYING_RIGHT&&t.length>0&&t.find((e=>"bird_nest_right"===e.name))&&this.nextState(),this.state===f.FLYING_LEFT&&t.length>0&&t.find((e=>"bird_nest_left"===e.name))&&this.nextState()),0!==this.move?(this.direction=this.move,this.accelerateX(a.PLAYER_ACCELERATION_AIR*e*this.move)):this.getVelocityX()>0?this.decelerateX(a.PLAYER_ACCELERATION_AIR*e):this.decelerateX(-a.PLAYER_ACCELERATION_AIR*e),this.speechBubble.update(this.x,this.y)}};t.Bird=_,n.__decorate([(0,h.asset)("sprites/bird.aseprite.json"),n.__metadata("design:type",o.Aseprite)],_,"sprite",void 0),n.__decorate([(0,h.asset)("sounds/jumping/jump_neutral.ogg"),n.__metadata("design:type",l.Sound)],_,"jumpSound",void 0),t.Bird=_=s=n.__decorate([(0,u.entity)("bird"),n.__metadata("design:paramtypes",[Object])],_)},1387:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Bone=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1531),h=i(3595),l=i(1809),d=i(225),u=i(8875),c=i(9899);let p=s=class extends c.PhysicsEntity{constructor(e){super({width:20,height:10,...e})}draw(){this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y,d.RenderingLayer.ENTITIES)}isCarried(){return this.scene.player.isCarrying(this)}update(e){super.update(e);const t=this.scene.player;if(!this.isCarried()&&this.distanceTo(t)<20&&t.carry(this),!this.isCarried()&&this.scene.world.collidesWith(this.x,this.y-5)===u.Environment.WATER){const e=this.getVelocityX();this.setVelocity(e,10)}h.Conversation.getGlobals().$gotBoneQuest&&!this.isCarried()&&this.distanceTo(this.scene.powerShiba)<20&&(s.successSound.play(),this.scene.powerShiba.feed(),this.scene.removeGameObject(this))}};t.Bone=p,n.__decorate([(0,r.asset)("sprites/bone.aseprite.json"),n.__metadata("design:type",a.Aseprite)],p,"sprite",void 0),n.__decorate([(0,r.asset)("sounds/throwing/success.mp3"),n.__metadata("design:type",o.Sound)],p,"successSound",void 0),t.Bone=p=s=n.__decorate([(0,l.entity)("bone"),n.__metadata("design:paramtypes",[Object])],p)},8304:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Campfire=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1809),h=i(225);let l=s=class extends o.Entity{constructor(e){super({width:14,height:28,isTrigger:!1,...e})}draw(){this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y-2,h.RenderingLayer.ENTITIES)}update(){}};t.Campfire=l,n.__decorate([(0,r.asset)("sprites/campfire.aseprite.json"),n.__metadata("design:type",a.Aseprite)],l,"sprite",void 0),t.Campfire=l=s=n.__decorate([(0,o.entity)("campfire"),n.__metadata("design:paramtypes",[Object])],l)},5831:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Caveman=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1809),h=i(225),l=i(3995);let d=s=class extends l.NPC{constructor(e){super({width:18,height:24,...e})}draw(e){this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y,h.RenderingLayer.ENTITIES,this.direction),this.speechBubble.draw(e)}update(e){super.update(e),this.speechBubble.update(this.x,this.y)}};t.Caveman=d,n.__decorate([(0,r.asset)("sprites/caveman.aseprite.json"),n.__metadata("design:type",a.Aseprite)],d,"sprite",void 0),t.Caveman=d=s=n.__decorate([(0,o.entity)("caveman"),n.__metadata("design:paramtypes",[Object])],d)},4297:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Chicken=void 0;const n=i(7582),a=n.__importDefault(i(7651)),r=i(9797),o=i(5943),h=i(3595),l=i(1809),d=i(225),u=i(3995);let c=s=class extends u.NPC{constructor(e){super({width:24,height:18,...e}),this.lookAtPlayer=!1,this.conversation=new h.Conversation(a.default,this)}getInteractionText(){return this.met?"Talk":"Touch"}draw(e){this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y,d.RenderingLayer.ENTITIES,this.direction),this.speechBubble.draw(e)}update(e){super.update(e),this.speechBubble.update(this.x,this.y)}};t.Chicken=c,n.__decorate([(0,o.asset)("sprites/chicken.aseprite.json"),n.__metadata("design:type",r.Aseprite)],c,"sprite",void 0),t.Chicken=c=s=n.__decorate([(0,l.entity)("chicken"),n.__metadata("design:paramtypes",[Object])],c)},9034:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Cloud=void 0;const n=i(7582),a=i(4488),r=i(9797),o=i(5943),h=i(1809),l=i(3121),d=i(225),u=i(6070),c=i(8875),p=i(9899);let g=s=class extends p.PhysicsEntity{constructor({canRain:e=!1,...t}){super({width:74,height:5,...t}),this.raining=0,this.setFloating(!0),this.isRainCloud=e,this.rainEmitter=this.scene.particles.createEmitter({position:{x:this.x,y:this.y},offset:()=>({x:26*(0,u.rnd)(-1,1),y:5*(0,u.rnd)(-1,1)}),velocity:()=>({x:this.getVelocityX()*a.PIXEL_PER_METER+5*(0,u.rnd)(-1,1),y:this.getVelocityY()*a.PIXEL_PER_METER-(0,u.rnd)(50,80)}),color:()=>s.raindrop,size:4,gravity:{x:0,y:-100},lifetime:()=>(0,u.rnd)(.7,1.2),alpha:.6,alphaCurve:l.valueCurves.linear.invert()})}startRain(e=1/0){this.raining=e}isRaining(){return this.raining>0}canRain(){return this.isRainCloud}draw(){this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y,d.RenderingLayer.PLATFORMS)}update(e){super.update(e),this.raining&&(this.raining-=e,this.raining<=0?this.raining=0:(0,u.timedRnd)(e,.1)&&(this.rainEmitter.setPosition(this.x,this.y),this.rainEmitter.emit((0,u.rndInt)(1,4))))}collidesWith(e,t){return e>=this.x-this.width/2&&e<=this.x+this.width/2&&t>=this.y&&t<=this.y+this.height?c.Environment.PLATFORM:c.Environment.AIR}};t.Cloud=g,n.__decorate([(0,o.asset)("sprites/cloud3.aseprite.json"),n.__metadata("design:type",r.Aseprite)],g,"sprite",void 0),n.__decorate([(0,o.asset)("images/raindrop.png"),n.__metadata("design:type",HTMLImageElement)],g,"raindrop",void 0),t.Cloud=g=s=n.__decorate([(0,h.entity)("cloud"),n.__metadata("design:paramtypes",[Object])],g)},1462:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConversationProxy=void 0;const s=i(3595),n=i(3995);class a extends n.NPC{constructor({content:e,...t}){super({width:16,height:16,...t}),this.conversation=this.generateConversation(this.prepareContent(e)),this.scene.addGameObject(this)}prepareContent(e){return null==e?["Nothing"]:e.split(":::")}generateConversation(e){const t={entry:[]};return e.forEach(((i,s)=>{s===e.length-1&&(i+=" @entry !end"),t.entry.push(i)})),new s.Conversation(t,this)}draw(e){this.speechBubble.draw(e)}update(){this.hasActiveConversation()||this.scene.removeGameObject(this)}}t.ConversationProxy=a},2042:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.ExitPortal=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1531),h=i(1809);var l;!function(e){e[e.OFF=0]="OFF",e[e.FADEIN=1]="FADEIN",e[e.IDLE=2]="IDLE"}(l||(l={}));let d=s=class extends h.Entity{constructor(e){super({width:32,height:50,isTrigger:!1,...e}),this.animationState=l.OFF,this.animator.assignSprite(s.sprite)}activate(){this.animationState===l.OFF&&(s.sound.play(),this.nextAnimationState())}nextAnimationState(){this.animationState++}draw(){switch(this.animationState){case l.OFF:this.animator.play("empty",1);break;case l.FADEIN:this.animator.play("fadein",1,{loop:!1,callback:this.nextAnimationState.bind(this)});break;case l.IDLE:this.animator.play("idle",1)}}update(e){super.update(e)}};t.ExitPortal=d,n.__decorate([(0,r.asset)("sprites/portal.aseprite.json"),n.__metadata("design:type",a.Aseprite)],d,"sprite",void 0),n.__decorate([(0,r.asset)("sounds/portal/portal.ogg"),n.__metadata("design:type",o.Sound)],d,"sound",void 0),t.ExitPortal=d=s=n.__decorate([(0,h.entity)("exitportal"),n.__metadata("design:paramtypes",[Object])],d)},2170:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Fire=t.SHRINK_SIZE=void 0;const n=i(7582),a=i(4488),r=i(5943),o=i(1531),h=i(3882),l=i(1809),d=i(6607),u=i(1344),c=i(3121),p=i(8129),g=i(225),m=i(6070),y=i(6533),f=i(3995),_=i(122);t.SHRINK_SIZE=2;let w=s=class extends f.NPC{constructor(e){super({width:1.5*a.PIXEL_PER_METER,height:1.85*a.PIXEL_PER_METER,...e}),this.intensity=5,this.state=y.FireState.IDLE,this.angry=!1,this.beingPutOut=!1,this.growthTarget=5,this.growth=1,this.averageParticleDelay=.1,this.averageSteamDelay=.05,this.isVisible=!0,this.fireGfx=new u.FireGfx,this.soundEmitter=new h.SoundEmitter({scene:this.scene,x:this.x,y:this.y,sound:s.fireAmbience,maxVolume:.7,intensity:.2}),this.smokeEmitter=this.scene.particles.createEmitter({position:{x:this.x,y:this.y},offset:()=>({x:3*(0,m.rnd)(-1,1)*this.intensity,y:(0,m.rnd)(2)*this.intensity}),velocity:()=>({x:15*(0,m.rnd)(-1,1),y:4+(0,m.rnd)(3)}),color:()=>s.smokeImage,size:()=>(0,m.rndInt)(24,32),gravity:{x:0,y:8},lifetime:()=>(0,m.rnd)(5,8),alpha:()=>(0,m.rnd)(.2,.45),angleSpeed:()=>1.5*(0,m.rnd)(-1,1),blendMode:"source-over",alphaCurve:c.valueCurves.cos(.1,.5),breakFactor:.85}),this.steamEmitter=this.scene.particles.createEmitter({position:{x:this.x+10,y:this.y},offset:()=>({x:3*(0,m.rnd)(-1,1),y:0}),velocity:()=>({x:5*(0,m.rnd)(-1,2),y:50+(0,m.rnd)(3)}),color:()=>s.steamImage,size:()=>(0,m.rndInt)(12,18),gravity:{x:0,y:8},lifetime:()=>(0,m.rnd)(1,3),alpha:()=>(0,m.rnd)(.5,.8),angleSpeed:()=>3*(0,m.rnd)(-1,1),blendMode:"source-over",alphaCurve:c.valueCurves.cos(.1,.5),renderingLayer:g.RenderingLayer.ENTITIES,zIndex:1,breakFactor:.5}),this.sparkEmitter=this.scene.particles.createEmitter({position:{x:this.x,y:this.y},velocity:()=>({x:30*(0,m.rnd)(-1,1),y:(0,m.rnd)(50,100)}),color:()=>u.FireGfx.gradient.getCss((0,m.rnd)()**.5),size:2,gravity:{x:0,y:-100},lifetime:()=>(0,m.rnd)(1,1.5),blendMode:"screen",alpha:()=>(0,m.rnd)(.3,1),alphaCurve:c.valueCurves.trapeze(.05,.2)}),this.face=new d.Face(this.scene,this,d.EyeType.STANDARD,0,6)}showDialoguePrompt(){return!!super.showDialoguePrompt()&&(this.scene.game.campaign.getQuest(p.QuestKey.A).getHighestTriggerIndex()===p.QuestATrigger.JUST_ARRIVED||this.scene.game.campaign.getQuest(p.QuestKey.A).getHighestTriggerIndex()>=p.QuestATrigger.GOT_WOOD&&this.scene.game.campaign.getQuest(p.QuestKey.A).getHighestTriggerIndex()<p.QuestATrigger.TALKED_TO_FIRE_WITH_WOOD||this.scene.game.campaign.getQuest(p.QuestKey.A).getHighestTriggerIndex()===p.QuestATrigger.THROWN_WOOD_INTO_FIRE||this.scene.game.campaign.getQuest(p.QuestKey.A).getHighestTriggerIndex()===p.QuestATrigger.BEAT_FIRE)}isRendered(){return this.isVisible}isAngry(){return this.state===y.FireState.ANGRY}isBeingPutOut(){return this.state===y.FireState.BEING_PUT_OUT}isPutOut(){return this.state===y.FireState.PUT_OUT}setState(e){this.state=e,e!==y.FireState.BEING_PUT_OUT&&e!==y.FireState.PUT_OUT||s.fireAmbience.stop()}drawToCanvas(e){e.save(),e.translate(this.x,-this.y),e.scale(this.intensity/5,this.intensity/5),this.fireGfx.draw(e,0,0),e.restore()}draw(e){this.isVisible&&(this.scene.renderer.add({type:g.RenderingType.FIRE,layer:g.RenderingLayer.ENTITIES,entity:this}),this.drawFace(e),this.showDialoguePrompt()&&this.drawDialoguePrompt(),this.thinkBubble&&this.thinkBubble.draw(e),this.speechBubble.draw(e))}update(e){if(this.state!==y.FireState.ANGRY||this.beingPutOut?this.state===y.FireState.BEING_PUT_OUT&&this.face?.setMode(d.FaceModes.DISGUSTED):this.face?.setMode(d.FaceModes.ANGRY),this.intensity!==this.growthTarget&&(this.intensity=(0,m.shiftValue)(this.intensity,this.growthTarget,this.growth*e)),this.scene.friendshipCutscene&&this.scene.shiba.getState()===_.ShibaState.KILLING_FIRE&&this.intensity<=t.SHRINK_SIZE&&this.scene.shiba.nextState(),this.scene.camera.isPointVisible(this.x,this.y,200)){if(this.isVisible=!0,!this.isBeingPutOut()&&!this.isPutOut()){let t=e-(0,m.rnd)()*this.averageParticleDelay;for(;t>0;)(0,m.rnd)()<.5&&this.sparkEmitter.emit(),(0,m.rnd)()<.32&&this.smokeEmitter.emit(),t-=(0,m.rnd)()*this.averageParticleDelay;this.soundEmitter.update()}if(this.isBeingPutOut()){let t=e-(0,m.rnd)()*this.averageSteamDelay;for(;t>0;)this.steamEmitter.emit(),t-=(0,m.rnd)()*this.averageSteamDelay}this.isVisible&&this.fireGfx.update(),this.showDialoguePrompt()&&this.dialoguePrompt.update(e,this.x,this.y+32),this.speechBubble.update(this.x,this.y)}else this.isVisible=!1}async feed(e){e.remove(),this.scene.setGateDisabled("shadowgate_door_1",!1),this.state=y.FireState.ANGRY,this.growthTarget=14,this.scene.startApocalypseMusic(),this.conversation=null;for(const e of[this.scene.shadowPresence])null!=e&&this.scene.removeGameObject(e);const t=[["What",2e3,2e3],["What have I done?",2e3,3e3],["I trusted you! I helped you!",2e3,3e3]];for(const[e,i,s]of t)await(0,m.sleep)(i),await this.scene.player.think(e,s);await(0,m.sleep)(500),this.scene.game.campaign.runAction("enable",null,["fire","fire2"])}};t.Fire=w,n.__decorate([(0,r.asset)("images/smoke.png"),n.__metadata("design:type",HTMLImageElement)],w,"smokeImage",void 0),n.__decorate([(0,r.asset)("images/steam.png"),n.__metadata("design:type",HTMLImageElement)],w,"steamImage",void 0),n.__decorate([(0,r.asset)("sounds/fire/fire.ogg"),n.__metadata("design:type",o.Sound)],w,"fireAmbience",void 0),t.Fire=w=s=n.__decorate([(0,l.entity)("fire"),n.__metadata("design:paramtypes",[Object])],w)},6533:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.FireState=void 0,function(e){e[e.IDLE=0]="IDLE",e[e.ANGRY=1]="ANGRY",e[e.BEING_PUT_OUT=2]="BEING_PUT_OUT",e[e.PUT_OUT=3]="PUT_OUT"}(i||(t.FireState=i={}))},195:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.FlameBoy=t.FlameBoyState=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1531),h=i(3882),l=i(1809),d=i(6607),u=i(8129),c=i(225),p=i(6070),g=i(6342);var m;!function(e){e[e.VENDOR=0]="VENDOR",e[e.WAITING_FOR_DIALOG=1]="WAITING_FOR_DIALOG",e[e.IDLE=2]="IDLE"}(m||(t.FlameBoyState=m={}));const y=[2,3,4],f=[1,1.5,2];let _=s=class extends g.ScriptableNPC{constructor(e){super({width:26,height:54,...e}),this.state=m.VENDOR,this.idleTimer=(0,p.rndItem)(y),this.walkTimer=null,this.autoMoveDirection=1,this.setMaxVelocity(3),this.face=new d.Face(this.scene,this,d.EyeType.FLAMEBOY,0,5),this.defaultFaceMode=d.FaceModes.BORED,this.face.setMode(this.defaultFaceMode),this.soundEmitter=new h.SoundEmitter({scene:this.scene,x:this.x,y:this.y,sound:s.fireAmbience,maxVolume:.7,intensity:.2})}setState(e){this.state=e}getState(){return this.state}feed(e){e.remove(),this.scene.game.campaign.runAction("giveWoodToFlameboy"),this.think("Well, that was unexpected",2e3),this.nextState()}nextState(){this.state++,this.state===m.WAITING_FOR_DIALOG&&(this.defaultFaceMode=d.FaceModes.NEUTRAL,this.face=new d.Face(this.scene,this,d.EyeType.FLAMEBOY2,0,2))}showDialoguePrompt(){if(!super.showDialoguePrompt())return!1;const e=this.scene.game.campaign.getQuest(u.QuestKey.A).getHighestTriggerIndex()>=u.QuestATrigger.THROWN_STONE_INTO_WATER&&this.scene.game.campaign.getQuest(u.QuestKey.A).getHighestTriggerIndex()<u.QuestATrigger.GOT_MULTIJUMP,t=this.state===m.WAITING_FOR_DIALOG;return e||t}getAnimationTag(){return this.state===m.VENDOR?"idle":"idle2"}walkRandomly(e,t){if(e.length>0){const t=e.find((e=>"flameboy_action"===e.name));null!=t&&null!=t.properties.velocity&&(this.autoMoveDirection=t.properties.velocity>0?1:-1,this.move=this.autoMoveDirection)}null!==this.idleTimer&&this.idleTimer>=0&&(this.idleTimer-=t),null!==this.walkTimer&&this.walkTimer>=0&&(this.walkTimer-=t),null!=this.idleTimer&&this.idleTimer<=0&&null===this.walkTimer&&(this.walkTimer=(0,p.rndItem)(f),this.idleTimer=null,this.move=this.autoMoveDirection),null!=this.walkTimer&&this.walkTimer<=0&&null===this.idleTimer&&(this.idleTimer=(0,p.rndItem)(y),this.walkTimer=null,this.move=0)}draw(e){0===this.move?this.scene.renderer.addAseprite(s.sprite,this.getAnimationTag(),this.x,this.y,c.RenderingLayer.ENTITIES,this.direction):this.scene.renderer.addAseprite(s.sprite,"walk",this.x,this.y,c.RenderingLayer.ENTITIES,this.direction),this.drawFace(e,!1),this.thinkBubble&&this.thinkBubble.draw(e),this.showDialoguePrompt()&&this.drawDialoguePrompt(),this.speechBubble.draw(e)}update(e){super.update(e);const t=this.scene.world.getTriggerCollisions(this);this.hasActiveConversation()?this.move=0:this.state===m.IDLE&&this.walkRandomly(t,e),0!==this.move?(this.direction=this.move,this.accelerateX(15*e*this.move)):this.getVelocityX()>0?this.decelerateX(15*e):this.decelerateX(-15*e),this.thinkBubble&&this.thinkBubble.update(this.x,this.y),this.dialoguePrompt.update(e,this.x,this.y+32),this.speechBubble.update(this.x,this.y),this.soundEmitter.update()}};t.FlameBoy=_,n.__decorate([(0,r.asset)("sprites/flameboy.aseprite.json"),n.__metadata("design:type",a.Aseprite)],_,"sprite",void 0),n.__decorate([(0,r.asset)("sounds/fire/fire2.ogg"),n.__metadata("design:type",o.Sound)],_,"fireAmbience",void 0),t.FlameBoy=_=s=n.__decorate([(0,l.entity)("flameboy"),n.__metadata("design:paramtypes",[Object])],_)},9095:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Mimic=void 0;const n=i(7582),a=n.__importDefault(i(3491)),r=i(9797),o=i(5943),h=i(1531),l=i(3595),d=i(1809),u=i(3995);var c;!function(e){e[e.SLEEPING=0]="SLEEPING",e[e.OPEN_UP=1]="OPEN_UP",e[e.IDLE=2]="IDLE"}(c||(c={}));let p=s=class extends u.NPC{constructor(e){super({width:46,height:24,...e}),this.state=c.SLEEPING,this.lookAtPlayer=!1,this.direction=1,this.conversation=new l.Conversation(a.default,this),this.animator.assignSprite(s.sprite)}nextState(){this.state++,this.state===c.OPEN_UP&&s.openingSound.play()}getInteractionText(){return this.met?"Talk":"Open"}draw(e){switch(this.state){case c.SLEEPING:this.animator.play("sleeping",this.direction);break;case c.OPEN_UP:this.animator.play("open",this.direction,{loop:!1,callback:this.nextState.bind(this)});break;case c.IDLE:this.animator.play("idle",this.direction)}this.speechBubble.draw(e)}update(e){super.update(e),this.speechBubble.update(this.x,this.y)}};t.Mimic=p,n.__decorate([(0,o.asset)("sprites/mimic.aseprite.json"),n.__metadata("design:type",r.Aseprite)],p,"sprite",void 0),n.__decorate([(0,o.asset)("sounds/item/chest.ogg"),n.__metadata("design:type",h.Sound)],p,"openingSound",void 0),t.Mimic=p=s=n.__decorate([(0,d.entity)("mimic"),n.__metadata("design:paramtypes",[Object])],p)},5775:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.MovingPlatform=void 0;const n=i(7582),a=i(4488),r=i(9797),o=i(5943),h=i(1809),l=i(225),d=i(8875),u=i(9899);let c=s=class extends u.PhysicsEntity{constructor({direction:e="up",velocity:t=0,distance:i=0,...s}){super({width:68,height:12,...s}),this.setFloating(!0);const{x:n,y:r}=this;this.startX=this.targetX=n,this.startY=this.targetY=r,this.velocity=t/a.PIXEL_PER_METER,"right"===e?(this.targetX=n+i,this.setVelocityX(this.velocity)):"left"===e?(this.targetX=n-i,this.setVelocityX(-this.velocity)):"up"===e?(this.targetY=r+i,this.setVelocityY(this.velocity)):"down"===e&&(this.targetY=r-i,this.setVelocityY(-this.velocity))}draw(){this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y,l.RenderingLayer.PLATFORMS)}update(e){super.update(e),this.getVelocityY()>0?this.y>=Math.max(this.startY,this.targetY)&&(this.y=Math.max(this.startY,this.targetY),this.setVelocityY(-this.velocity)):this.getVelocityY()<0&&this.y<=Math.min(this.startY,this.targetY)&&(this.y=Math.min(this.startY,this.targetY),this.setVelocityY(this.velocity)),this.getVelocityX()>0?this.x>=Math.max(this.targetX,this.startX)&&(this.x=Math.max(this.targetX,this.startX),this.setVelocityX(-this.velocity)):this.getVelocityX()<0&&this.x<=Math.min(this.startX,this.targetX)&&(this.x=Math.min(this.startX,this.targetX),this.setVelocityX(this.velocity))}collidesWith(e,t){return e>=this.x-this.width/2&&e<=this.x+this.width/2&&t>=this.y&&t<=this.y+this.height?d.Environment.PLATFORM:d.Environment.AIR}};t.MovingPlatform=c,n.__decorate([(0,o.asset)("sprites/stoneplatform.aseprite.json"),n.__metadata("design:type",r.Aseprite)],c,"sprite",void 0),t.MovingPlatform=c=s=n.__decorate([(0,h.entity)("movingplatform"),n.__metadata("design:paramtypes",[Object])],c)},3995:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NPC=void 0;const s=i(9430),n=i(6607),a=i(617),r=i(6070),o=i(9899);class h extends o.PhysicsEntity{constructor(){super(...arguments),this.direction=1,this.face=null,this.defaultFaceMode=n.FaceModes.NEUTRAL,this.greeting=null,this.conversation=null,this.thinkBubble=null,this.speechBubble=new a.SpeechBubble(this.scene,this.x,this.y),this.lookAtPlayer=!0,this.dialoguePrompt=new s.DialoguePrompt(this.scene,this.x,this.y),this.lastEndedConversation=-1/0,this.met=!1}drawFace(e,t=!0){if(this.face)if(t){const t=this.scene.player.x-this.x;this.face.toggleDirection(t>0?1:-1),this.face.draw(e)}else this.face.setDirection(this.direction),this.face.draw(e)}async think(e,t){this.thinkBubble&&(this.thinkBubble.hide(),this.thinkBubble=null);const i=this.thinkBubble=new a.SpeechBubble(this.scene,this.x,this.y);i.setMessage(e),i.show(),await(0,r.sleep)(t),this.thinkBubble===i&&(i.hide(),this.thinkBubble=null)}hasMet(){return!1}meet(){this.met=!0}getInteractionText(){return"Talk"}showDialoguePrompt(){return!(this.hasActiveConversation()||!this.scene.player.isControllable)}drawDialoguePrompt(){this.dialoguePrompt.draw()}drawGreeting(e){this.greeting?.draw(e)}updateGreeting(){this.greeting?.update()}registerEndedConversation(){this.lastEndedConversation=this.scene.gameTime}isReadyForConversation(){return this.conversation&&!this.scene.player.isCarrying(this)&&this.scene.gameTime-this.lastEndedConversation>1.5}hasActiveConversation(){return null!==this.scene.player.playerConversation&&this.scene.player.playerConversation.npc===this}toggleDirection(e=(this.direction>0?-1:1)){e!==this.direction&&(this.direction=e)}update(e){if(this.lookAtPlayer){const e=this.scene.player.x-this.x;this.toggleDirection(e>0?1:-1)}super.update(e)}}t.NPC=h},9899:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PhysicsEntity=void 0;const s=i(4488),n=i(1809),a=i(8875);class r extends n.Entity{constructor({velocityX:e=0,velocityY:t=0,maxVelocityX:i=1/0,maxVelocityY:s=1/0,...n}){super(n),this.velocityX=0,this.velocityY=0,this.maxVelocityX=1/0,this.maxVelocityY=1/0,this.floating=!1,this.ground=null,this.carryHeight=this.height,this.lastGroundPosition={x:0,y:0},this.velocityX=e,this.velocityY=t,this.maxVelocityX=e,this.maxVelocityY=t}setFloating(e){this.floating=e,e&&this.setVelocity(0,0)}isFloating(){return this.floating}setMaxVelocity(e,t=e){this.maxVelocityX=e,this.maxVelocityY=t}accelerate(e,t){this.accelerateX(e),this.accelerateY(t)}accelerateX(e){this.velocityX=e>0?Math.min(this.maxVelocityX,this.velocityX+e):Math.max(-this.maxVelocityX,this.velocityX+e)}accelerateY(e){this.velocityY=Math.min(this.maxVelocityY,this.velocityY+e)}decelerate(e,t){this.decelerateX(e),this.decelerateY(t)}decelerateX(e){this.velocityX=e>0?Math.max(0,this.velocityX-e):Math.min(0,this.velocityX-e)}decelerateY(e){this.velocityY=Math.max(0,this.velocityY-e)}setVelocity(e,t){this.velocityX=e,this.velocityY=t}setVelocityX(e){this.velocityX=e}setVelocityY(e){this.velocityY=e}getVelocityX(){return this.velocityX}getVelocityY(){return this.velocityY}checkCollision(e,t,i){return this.scene.world.collidesWith(e,t,[this],i)}checkCollisionBox(e,t,i){for(let s=-this.width/2;s<this.width/2;s++){let n=this.checkCollision(e+s,t,i);if(n!==a.Environment.AIR)return n;if(n=this.checkCollision(e+s,t+this.height,i),n!==a.Environment.AIR)return n}for(let s=0;s<this.height;s++){let n=this.checkCollision(e-this.width/2,t+s,i);if(n!==a.Environment.AIR)return n;if(n=this.checkCollision(e+this.width/2,t+s,i),n!==a.Environment.AIR)return n}return a.Environment.AIR}updatePosition(e,t){if(this.floating)this.x=e,this.y=t;else{const i=this.checkCollisionBox(e,t,t>this.y?[a.Environment.PLATFORM]:[]);i===a.Environment.AIR||i===a.Environment.WATER?(this.x=e,this.y=t):this.setVelocity(0,0)}}isJumpDown(){return!1}isPlayer(){return!1}update(e){super.update(e);const t=this.scene.world,i=t.getObjectAt(this.x,this.y-5,[this]);if(i instanceof r&&(this.x+=i.getVelocityX()*s.PIXEL_PER_METER*e,this.y+=i.getVelocityY()*s.PIXEL_PER_METER*e),this.ground=i,this.updatePosition(this.x+this.velocityX*s.PIXEL_PER_METER*e,this.y+this.velocityY*s.PIXEL_PER_METER*e),!this.floating){const i=t.collidesWith(this.x,this.y-1,[this],this.isJumpDown()?[a.Environment.PLATFORM]:[]);i===a.Environment.AIR?(this.velocityY-=this.getGravity()*e,this.velocityY<0&&(this.velocityY=Math.max(this.velocityY,s.TERMINAL_VELOCITY))):i===a.Environment.WATER?(this.velocityY=s.DROWNING_VELOCITY,this.velocityX=0):this.velocityY<0?(this.velocityY=0,this.isPlayer()||(this.velocityX=0),this.x=Math.round(this.x),this.y=Math.round(this.y)):(this.lastGroundPosition.x=this.x,this.lastGroundPosition.y=this.y)}}getGravity(){return s.GRAVITY}getGround(){return this.ground}}t.PhysicsEntity=r},973:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;const n=i(7582),a=i(4488),r=i(5943),o=i(1531),h=i(8585),l=i(815),d=i(5744),u=i(3595),c=i(1735),p=i(1809),g=i(5832),m=i(6038),y=i(3121),f=i(3577),_=i(8129),w=i(225),v=i(9647),b=i(7614),T=i(617),E=i(6070),I=i(8875),A=i(9034),S=i(1462),x=i(3995),O=i(9899),C=i(8883),P=i(8491),k=i(3220),M=i(9690),N=i(8932),R=i(3011),D=["#806057","#504336","#3C8376","#908784"],L=["#f06060","#e87f7f","#ff7070"],F=[{message:"OK, I'm not Jesus. Noted!",duration:4e3},{message:"Looks like I can't swim But I can respawn, nice!",duration:5e3},{message:"Well, that was strange And wet.",duration:4e3}],G=[{message:"Waah!",duration:1e3},{message:"Help!",duration:1e3},{message:"Mama!",duration:1e3},{message:"Ieeh!",duration:1e3},{message:"Argh!",duration:1e3}];let B=s=class extends O.PhysicsEntity{constructor(e){super({width:a.PLAYER_WIDTH,height:a.PLAYER_HEIGHT,...e}),this.controllerSpriteMapRecords={[g.ControllerSpriteMap.KEYBOARD]:s.buttons[0],[g.ControllerSpriteMap.XBOX]:s.buttons[1],[g.ControllerSpriteMap.PLAYSTATION]:s.buttons[2],[g.ControllerSpriteMap.STADIA]:s.buttons[3]},this.lastHint=Date.now(),this.flying=!1,this.direction=1,this.playerSpriteMetadata=null,this.animation="idle",this.moveLeft=!1,this.moveRight=!1,this.visible=!1,this.running=!1,this.jumpThresholdTimer=a.PLAYER_JUMP_TIMING_THRESHOLD,this.jumpDown=!1,this.jumpKeyPressed=!1,this.drowning=0,this.dance=null,this.currentFailAnimation=1,this.carrying=null,this.canRun=!1,this.jumpDisabled=!1,this.canRainDance=!1,this.doubleJump=!1,this.multiJump=!1,this.hasFriendship=!1,this.usedJump=!1,this.usedDoubleJump=!1,this.autoMove=null,this.isControllable=!0,this.showHints=!1,this.isPettingDog=!1,this.walkingSpeed=a.MAX_PLAYER_SPEED,this.playerConversation=null,this.speechBubble=new T.SpeechBubble(this.scene,this.x,this.y,!0),this.thinkBubble=null,this.closestNPC=null,this.disableParticles=!1,this.isControllable=!1,this.setFloating(!0),this.characterAsset=this.scene.game.campaign.selectedCharacter,this.voiceAsset=this.scene.game.campaign.selectedVoice,u.Conversation.setGlobal("ismale",this.characterAsset===l.CharacterAsset.MALE?"true":"false"),setTimeout((()=>{this.isControllable=!0,this.visible=!0,this.setFloating(!1)}),2200),document.addEventListener("keydown",(e=>this.handleKeyDown(e))),(0,E.isDev)()&&console.log("Dev mode, press C to dance anywhere, P to spawn the stone, O to spawn the seed, I to spawn wood, T to throw useless snowball, K to learn all abilities, M to show bounds of entities and triggers."),this.setMaxVelocity(a.MAX_PLAYER_RUNNING_SPEED),this.dustEmitter=this.scene.particles.createEmitter({position:{x:this.x,y:this.y},velocity:()=>({x:26*(0,E.rnd)(-1,1),y:45*(0,E.rnd)(.7,1)}),color:()=>(0,E.rndItem)(D),size:(0,E.rnd)(1,2),gravity:{x:0,y:-100},lifetime:()=>(0,E.rnd)(.5,.8),alphaCurve:y.valueCurves.trapeze(.05,.2)}),this.bounceEmitter=this.scene.particles.createEmitter({position:{x:this.x,y:this.y},velocity:()=>({x:90*(0,E.rnd)(-1,1),y:60*(0,E.rnd)(.7,1)}),color:()=>(0,E.rndItem)(L),size:(0,E.rnd)(1.5,3),gravity:{x:0,y:-120},lifetime:()=>(0,E.rnd)(.4,.6),alphaCurve:y.valueCurves.trapeze(.05,.2)}),this.doubleJumpEmitter=this.scene.particles.createEmitter({position:{x:this.x,y:this.y},velocity:()=>({x:90*(0,E.rnd)(-1,1),y:100*(0,E.rnd)(-1,0)}),color:()=>(0,E.rndItem)(a.DOUBLE_JUMP_COLORS),size:(0,E.rnd)(1.5,3),gravity:{x:0,y:-120},lifetime:()=>(0,E.rnd)(.4,.6),alphaCurve:y.valueCurves.trapeze(.05,.2)})}getControllable(){return this.isControllable}setControllable(e){this.isControllable=e}startAutoMove(e,t){this.autoMove||(this.autoMove={destinationX:e,lastX:this.x,turnAround:t}),setTimeout((()=>{this.autoMove&&this.stopAutoMove()}),1e3)}stopAutoMove(){!0===this.autoMove?.turnAround&&(this.direction=-1*this.direction),this.autoMove=null,this.moveRight=!1,this.moveLeft=!1}startPettingDog(){this.isPettingDog=!0,this.x=this.scene.shiba.direction>0?this.scene.shiba.x+18:this.scene.shiba.x-18}stopPettingDog(){this.isPettingDog=!1}enableRunning(e=!1){this.scene.game.campaign.getQuest(_.QuestKey.A).trigger(_.QuestATrigger.GOT_RUNNING_ABILITY),this.canRun||(e||this.scene.scenes.pushScene(b.GotItemScene,b.Item.RUNNING),this.canRun=!0)}enableRainDance(e=!1){this.scene.game.campaign.getQuest(_.QuestKey.A).trigger(_.QuestATrigger.LEARNED_RAIN_DANCE),this.canRainDance||(e||this.scene.scenes.pushScene(b.GotItemScene,b.Item.RAINDANCE),this.canRainDance=!0)}enableDoubleJump(e=!1){u.Conversation.setGlobal("hasDoubleJump","true"),this.scene.game.campaign.getQuest(_.QuestKey.A).trigger(_.QuestATrigger.GOT_QUEST_FROM_TREE),this.doubleJump||(e||this.scene.scenes.pushScene(b.GotItemScene,b.Item.DOUBLEJUMP),this.doubleJump=!0)}enableMultiJump(e=!1){this.scene.game.campaign.getQuest(_.QuestKey.A).trigger(_.QuestATrigger.GOT_MULTIJUMP),this.multiJump||(e||this.scene.scenes.pushScene(b.GotItemScene,b.Item.MULTIJUMP),this.multiJump=!0)}disableMultiJump(){this.multiJump=!1}enableFriendship(){this.hasFriendship||(this.scene.scenes.pushScene(b.GotItemScene,b.Item.FRIENDSHIP),this.hasFriendship=!0,u.Conversation.setGlobal("hasFriendship","true"),this.scene.removeGameObject(this.scene.powerShiba))}removePowerUps(){this.multiJump=!1,this.doubleJump=!1,this.canRun=!1}removeMultiJump(){this.multiJump=!1}switchToReality(){this.canRun=!1,this.multiJump=!1,this.jumpDisabled=!0,this.walkingSpeed=3,this.characterAsset=l.CharacterAsset.PATIENT,this.direction=-1}enterShadowCave(){this.canRun=!1,this.walkingSpeed=3,this.jumpDisabled=!0,this.multiJump=!1}getDance(){return this.dance}cancelDance(){this.dance=null}async handleButtonDown(e){if(!this.scene.paused&&this.isControllable&&!this.autoMove)if(this.isPettingDog)(e.isPlayerMoveLeft||e.isPlayerMoveRight||e.isPlayerAction)&&this.scene.cancelPatEnding();else if(this.dance)this.dance.handleButtonDown(e);else if(this.scene.camera.isOnTarget()&&!e.repeat)if(this.playerConversation)this.playerConversation.handleButton(e);else if(this.canRun&&e.isPlayerRun&&(this.running=!0),e.isPlayerMoveRight)this.moveRight=!0,this.moveLeft=!1;else if(e.isPlayerMoveLeft)this.moveLeft=!0,this.moveRight=!1;else if(e.isPlayerEnterDoor){if(!this.canEnterDoor())return;const e=this.scene.world.getGateCollisions(this)[0];await this.enterGate(e)}else if(e.isPlayerInteract){if(!this.flying)if(this.closestNPC&&!0===this.closestNPC.isReadyForConversation()&&this.closestNPC.conversation){const e=this.closestNPC.conversation,t=!(this.closestNPC instanceof P.Sign||this.closestNPC instanceof M.Stone&&this.closestNPC.state!==M.StoneState.DEFAULT);this.playerConversation=new f.PlayerConversation(this,this.closestNPC,e,t)}else if(this.readableTrigger){const e=new S.ConversationProxy({scene:this.scene,x:this.x,y:this.y,content:this.readableTrigger.properties.content});this.playerConversation=new f.PlayerConversation(this,e,e.conversation,!1)}else this.canDanceToMakeRain()&&(this.startDance(this.scene.apocalypse?3:2),this.scene.game.campaign.getQuest(_.QuestKey.A).trigger(_.QuestATrigger.MADE_RAIN))}else e.isPlayerAction?this.isCarrying()&&this.throw():e.isPlayerJump&&this.canJump()?(this.jumpKeyPressed=!0,this.jump()):e.isPlayerDrop&&(this.jumpDown=!0)}throw(){!this.carrying||this.carrying instanceof M.Stone&&!this.canThrowStoneIntoWater()||(this.carrying instanceof M.Stone?this.carrying.setVelocity(10*this.direction,10):this.carrying.setVelocity(5*this.direction,5),this.height=a.PLAYER_HEIGHT,this.carrying=null,d.CharacterSounds.playRandomCharacterSound("throw",this.voiceAsset))}handleKeyDown(e){this.scene.paused||this.scene.camera.isOnTarget()&&!e.repeat&&(0,E.isDev)()&&("c"===e.key?this.startDance(3):"p"!==e.key||this.carrying?"o"!==e.key||this.carrying?"u"!==e.key||this.carrying?"i"!==e.key||this.carrying?"t"===e.key?(this.scene.addGameObject(new k.Snowball({scene:this.scene,x:this.x,y:this.y+.75*this.height,velocityX:20*this.direction,velocityY:10})),d.CharacterSounds.playRandomCharacterSound("throw",this.voiceAsset)):"k"===e.key?(this.multiJump=!0,this.doubleJump=!0,this.canRun=!0,this.canRainDance=!0,this.think("I can do everything now.",1500)):"m"===e.key&&(this.scene.showBounds=!this.scene.showBounds,this.think("Toggling bounds.",1500)):this.carry(this.scene.tree.seed.spawnWood()):this.carry(this.scene.bone):this.carry(this.scene.tree.spawnSeed()):this.carry(this.scene.stone))}async think(e,t){this.thinkBubble&&(this.thinkBubble.hide(),this.thinkBubble=null);const i=this.thinkBubble=new T.SpeechBubble(this.scene,this.x,this.y);i.setMessage(e),i.show(),await(0,E.sleep)(t),this.thinkBubble===i&&(i.hide(),this.thinkBubble=null)}startDance(e=1){if(!this.dance)switch(e){case 1:this.dance=new c.Dance(this.scene,this.x,this.y-25,100,"  1 1 2 2 1 2 1 3",void 0,1,void 0,!0,0);break;case 2:this.dance=new c.Dance(this.scene,this.x,this.y-25,192,"1   2   1 1 2 2 121 212 121 212 3    ",void 0,3);break;case 3:this.dance=new c.Dance(this.scene,this.x,this.y-25,192,"112 221 312 123 2121121 111 222 3    ",void 0,4);break;default:this.dance=new c.Dance(this.scene,this.x,this.y-25,192,"3")}}async enterGate(e){if(null!=e&&null!=e.properties.target){this.isControllable=!1,this.moveRight=!1,this.moveLeft=!1;const t=this.scene.gateObjects.find((t=>t.name===e.properties.target)),i=e.properties.bgm;if(t){null!=e.properties.enterSound?"portal"===e.properties.enterSound&&(s.enterPortalSound.stop(),s.enterPortalSound.play()):(s.enterGateSound.stop(),s.enterGateSound.play()),await this.scene.fadeToBlack(.8,v.FadeDirection.FADE_OUT),null!=i&&this.scene.setActiveBgmTrack(i),null!=t.properties.exitSound?"portal"===t.properties.exitSound&&(s.enterPortalSound.stop(),s.enterPortalSound.play()):(s.leaveGateSound.stop(),s.leaveGateSound.play()),this.x=t.x+t.width/2,this.y=t.y-t.height,this.scene.camera.setBounds(this.getCurrentMapBounds()),"exitportaldoor_2"===t.name&&this.switchToReality(),"shadowgate_door_2"===t.name&&this.enterShadowCave(),null!=t.properties.exitSleepTime&&await(0,E.sleep)(1e3*t.properties.exitSleepTime);const n=t.properties.exitFadeTime??.8;await this.scene.fadeToBlack(n,v.FadeDirection.FADE_IN),this.isControllable=!0}}}teleportTo(e){this.x=e.x,this.y=e.y,this.scene.camera.setBounds(this.getCurrentMapBounds())}canJump(){return!this.jumpDisabled&&(!!this.multiJump||!this.usedJump&&this.jumpThresholdTimer>0||(this.doubleJump?!this.usedDoubleJump:!this.flying))}jump(){this.drowning>0||(this.setVelocityY(Math.sqrt(2*a.PLAYER_JUMP_HEIGHT*a.GRAVITY)),d.CharacterSounds.playRandomCharacterSound("jump",this.voiceAsset),this.flying&&this.usedJump&&(this.usedDoubleJump=!0,!this.disableParticles&&this.visible&&(this.doubleJumpEmitter.setPosition(this.x,this.y+20),this.doubleJumpEmitter.emit(20))),this.usedJump=!0)}handleButtonUp(e){this.scene.paused||!this.isControllable||this.autoMove||(e.isPlayerMoveRight?this.moveRight=!1:e.isPlayerMoveLeft?this.moveLeft=!1:e.isPlayerJump?this.jumpKeyPressed=!1:e.isPlayerDrop?this.jumpDown=!1:e.isPlayerRun&&(this.running=!1))}drawTooltip(e,t=g.ControllerAnimationTags.ACTION){if(!this.isControllable)return;const i=m.ControllerManager.getInstance().controllerSprite,n=s.font.measureText(e),a=Math.round(Math.round(this.x)-(n.width-this.controllerSpriteMapRecords[i].width+6)/2),r=12-this.y;this.scene.renderer.add({type:w.RenderingType.ASEPRITE,layer:w.RenderingLayer.UI,position:{x:a-this.controllerSpriteMapRecords[i].width-6,y:r},asset:this.controllerSpriteMapRecords[i],animationTag:t}),this.scene.renderer.add({type:w.RenderingType.TEXT,layer:w.RenderingLayer.UI,text:e,textColor:"white",outlineColor:"black",position:{x:a,y:r},asset:s.font})}draw(e){if(!this.visible)return;const t=s.playerSprites[this.characterAsset];let i=this.animation;!this.carrying||"idle"!==i&&"walk"!==i&&"jump"!==i&&"fall"!==i||(i+="-carry"),this.scene.renderer.addAseprite(t,i,this.x,this.y-1,w.RenderingLayer.PLAYER,this.direction),!this.closestNPC||this.dance||this.playerConversation||!0!==this.closestNPC.isReadyForConversation()?this.readableTrigger?this.drawTooltip("Examine",g.ControllerAnimationTags.INTERACT):this.canEnterDoor()?this.drawTooltip("Enter",g.ControllerAnimationTags.OPEN_DOOR):this.canThrowStoneIntoWater()?this.drawTooltip("Throw stone",g.ControllerAnimationTags.ACTION):this.canThrowSeedIntoSoil()?this.drawTooltip("Plant seed",g.ControllerAnimationTags.ACTION):this.canDanceToMakeRain()&&this.drawTooltip("Dance",g.ControllerAnimationTags.INTERACT):this.drawTooltip(this.closestNPC.getInteractionText(),g.ControllerAnimationTags.INTERACT),this.dance&&this.dance.addDanceToRenderQueue(),this.speechBubble.draw(e),this.thinkBubble&&this.thinkBubble.draw(e)}canThrowStoneIntoWater(){return this.carrying instanceof M.Stone&&-1===this.direction&&this.scene.world.collidesWith(this.x-30,this.y-20)===I.Environment.WATER}canThrowSeedIntoSoil(){return this.carrying instanceof C.Seed&&-1===this.direction&&this.scene.world.collidesWith(this.x-30,this.y+2)===I.Environment.SOIL}debugCollisions(){console.log("Entities: ",this.scene.world.getEntityCollisions(this)),console.log("Triggers: ",this.scene.world.getTriggerCollisions(this)),console.log("Gates: ",this.scene.world.getGateCollisions(this))}getReadableTrigger(){const e=this.scene.world.getTriggerCollisions(this);if(0!==e.length)return e.find((e=>"readable"===e.name))}canDanceToMakeRain(){if(!this.canRainDance)return!1;const e=this.getGround();return this.isCollidingWithTrigger("raincloud_sky")&&!this.scene.world.isRaining()&&null===this.carrying&&!this.scene.apocalypse||e instanceof A.Cloud&&this.scene.apocalypse&&!e.isRaining()&&e.canRain()}canEnterDoor(){return!this.flying&&!this.carrying&&this.scene.world.getGateCollisions(this).length>0}getCurrentMapBounds(){const e=this.scene.world.getCameraBounds(this);if(0!==e.length)return(0,E.boundsFromMapObject)(e[0])}respawn(){this.x=this.lastGroundPosition.x,this.y=this.lastGroundPosition.y+10,this.setVelocity(0,0)}getPlayerSpriteMetadata(){return null==this.playerSpriteMetadata&&(this.playerSpriteMetadata=s.playerSprites.map((e=>{const t=e.getLayer("Meta")?.data;return null!=t&&""!==t?JSON.parse(t):{}}))),this.playerSpriteMetadata}resetJumps(){this.usedJump=!1,this.usedDoubleJump=!1,this.jumpThresholdTimer=a.PLAYER_JUMP_TIMING_THRESHOLD}isOutOfBounds(){if(!this.isControllable)return!1;const e=this.scene.camera.getBounds();return!!e&&!this.scene.world.boundingBoxesCollide(this.getBounds(),{x:e.x+4,y:e.y-4,width:e.width-8,height:e.height-8})}update(e){super.update(e);const t=this.scene.world.getTriggerCollisions(this);if(this.isOutOfBounds()){const e=this.scene.apocalypse?this.scene.pointsOfInterest.find((e=>"boss_spawn"===e.name)):this.scene.pointsOfInterest.find((e=>"player_reset_position"===e.name));e&&(this.x=e.x,this.y=e.y,this.scene.camera.setBounds(this.getCurrentMapBounds()))}if(this.speechBubble.update(this.x,this.y),this.thinkBubble&&this.thinkBubble.update(this.x,this.y),this.playerConversation&&this.playerConversation.update(),this.showHints&&(Date.now()-this.lastHint)/1e3>90&&this.showHint(),this.carrying){this.running&&(this.running=!1,this.animation="walk"),this.carrying.x=this.x;const e=s.playerSprites[this.characterAsset].getTaggedFrameIndex(this.animation+"-carry",1e3*this.scene.gameTime),t=(this.getPlayerSpriteMetadata()[this.characterAsset].carryOffsetFrames??[]).includes(e+1)?0:-1;this.carrying.y=this.y+(this.height-this.carrying.carryHeight)-t,this.carrying instanceof M.Stone&&(this.carrying.direction=this.direction)}const i=this.scene.world.collidesWith(this.x,this.y)===I.Environment.WATER;if(i){if(!this.thinkBubble){const e=G[(0,E.rndInt)(0,G.length)];this.think(e.message,e.duration)}if(this.carrying instanceof M.Stone&&(this.carrying.setVelocity(-2,10),this.carrying=null),0===this.drowning&&d.CharacterSounds.playRandomCharacterSound("drown",this.voiceAsset),this.setVelocityX(0),this.drowning+=e,this.drowning>3){d.CharacterSounds.stopCharacterSound("drown",this.voiceAsset),this.respawn();const e=F[(0,E.rndInt)(0,F.length)];this.think(e.message,e.duration)}}else this.drowning=0;const n=this.scene.world,r=this.flying,o=this.getVelocityY();this.autoMove&&((this.autoMove.lastX-this.autoMove.destinationX)*(this.x-this.autoMove.destinationX)<=0?this.stopAutoMove():(this.autoMove.lastX=this.x,this.x<this.autoMove.destinationX?(this.moveRight=!0,this.moveLeft=!1):(this.moveRight=!1,this.moveLeft=!0))),this.scene.camera.isOnTarget()||(this.moveRight=!1,this.moveLeft=!1);const h=this.flying?a.PLAYER_ACCELERATION_AIR:a.PLAYER_ACCELERATION;i||(this.running?this.setMaxVelocity(a.MAX_PLAYER_RUNNING_SPEED):this.setMaxVelocity(this.walkingSpeed),this.moveRight?(this.direction=1,this.flying||s.walkingSound.play(),this.accelerateX(h*e)):this.moveLeft?(this.direction=-1,this.flying||s.walkingSound.play(),this.accelerateX(-h*e)):(s.walkingSound.stop(),this.getVelocityX()>0?this.decelerateX(h*e):this.decelerateX(-h*e))),0===this.getVelocityX()&&0===this.getVelocityY()?(this.animation="idle",this.flying=!1,this.resetJumps()):this.getVelocityY()>0?(this.animation="jump",this.flying=!0):i||this.getVelocityY()<0&&this.y-n.getGround(this.x,this.y)>10?((this.jumpThresholdTimer<0||this.usedJump)&&(this.animation="fall"),this.flying=!0):(this.animation=this.running&&!this.carrying?"run":"walk",this.flying=!1,this.resetJumps()),r&&!this.flying&&d.CharacterSounds.playRandomCharacterSound("land",this.voiceAsset),this.flying&&!this.usedJump&&this.jumpThresholdTimer>0&&(this.jumpThresholdTimer-=e),this.closestNPC=null;const l=this.scene.world.getEntityCollisions(this,5);if(l.length>0){const e=l.length>1?this.getClosestEntity():l[0];e instanceof x.NPC&&(this.closestNPC=e)}if(this.readableTrigger=this.getReadableTrigger(),!this.disableParticles&&this.visible&&!this.flying&&(Math.abs(this.getVelocityX())>1||r)&&((0,E.timedRnd)(e,.2)||r)){this.dustEmitter.setPosition(this.x,this.y);const e=r?Math.ceil(Math.abs(o)/5):1;this.dustEmitter.emit(e)}if(this.flying||null==this.jumpKeyPressed||(this.jumpKeyPressed=null),this.scene.world.collidesWith(this.x,this.y-2,[this])===I.Environment.BOUNCE&&this.bounce(),this.dance){if(this.dance.hasStarted()){const e=this.dance.getTimeSinceLastMistake(),t=this.dance.getTimeSinceLastSuccess();(e<1||t<3)&&(e<=t?(0===e&&(this.currentFailAnimation=(0,E.rndInt)(1,3)),this.animation="dance-fluke-"+this.currentFailAnimation):this.animation="dance")}if(this.dance.setPosition(this.x,this.y-16),this.dance.update()){if(this.dance.wasSuccessful()){const e=this.getGround();if(e&&e instanceof A.Cloud){e.startRain(this.scene.apocalypse?1/0:15);const t=this.scene.pointsOfInterest.find((e=>"boss_spawn"===e.name));t&&this.scene.camera.focusOn(3,t.x,t.y+60,1,0,y.valueCurves.cos(.35));const i="wall"+(this.scene.gameObjects.filter((e=>e instanceof A.Cloud&&e.isRaining())).length-1),s=this.scene.gameObjects.find((e=>e instanceof N.Wall&&e.identifier===i));s&&s.crumble()}this.isCollidingWithTrigger("raincloud_sky")&&this.scene.world.startRain()}this.dance=null}}this.disableParticles=!1,this.isPettingDog&&(this.animation="petting"),t.length>0&&t.forEach((e=>{if("reset_mountain"===e.name&&this.scene.mountainRiddle.resetRiddle(),"mountaingate"===e.name){const t=e.properties.row,i=e.properties.col;null!=i&&null!=t&&this.scene.mountainRiddle.checkGate(i,t)}if("teleporter"===e.name&&this.scene.mountainRiddle.isFailed()&&!this.scene.mountainRiddle.isCleared()){const t=e.properties.teleportY;null!=t&&(this.y-=t)}"finish_mountain_riddle"===e.name&&this.scene.mountainRiddle.clearRiddle(),!0===e.properties.disableParticles&&(this.disableParticles=!0);const t={key:e.properties.setGlobalKey,value:e.properties.setGlobalVal};null!=t.key&&null!=t.value&&u.Conversation.setGlobal(t.key,t.value);const i={key:e.properties.setDialogEntity,value:e.properties.setDialogValue};null!=i.key&&null!=i.value&&this.scene.game.campaign.runAction("enable",null,[i.key,i.value])}))}pullOutOfGround(){let e=0,t=0;if(this.getVelocityY()<=0){const i=this.scene.world,s=i.getHeight();for(t=i.collidesWith(this.x,this.y,[this],this.jumpDown?[I.Environment.PLATFORM,I.Environment.WATER]:[I.Environment.WATER]);this.y<s&&t;)e++,this.y++,t=i.collidesWith(this.x,this.y)}return e}bounce(){this.setVelocityY(Math.sqrt(2*a.PLAYER_BOUNCE_HEIGHT*a.GRAVITY)),this.bounceEmitter.setPosition(this.x,this.y-12),this.bounceEmitter.emit(20),this.dustEmitter.clear(),s.bouncingSound.stop(),s.bouncingSound.play()}pullOutOfCeiling(){let e=0;const t=this.scene.world;for(;this.y>0&&t.collidesWith(this.x,this.y+this.height,[this],[I.Environment.PLATFORM,I.Environment.WATER]);)e++,this.y--;return e}pullOutOfWall(){let e=0;const t=this.scene.world;if(this.getVelocityX()>0)for(;t.collidesWithVerticalLine(this.x+this.width/2,this.y+3*this.height/4,this.height/2,[this],[I.Environment.PLATFORM,I.Environment.WATER]);)this.x--,e++;else for(;t.collidesWithVerticalLine(this.x-this.width/2,this.y+3*this.height/4,this.height/2,[this],[I.Environment.PLATFORM,I.Environment.WATER]);)this.x++,e++;return e}updatePosition(e,t){this.x=e,this.y=t,0===this.pullOutOfGround()&&0===this.pullOutOfCeiling()||this.setVelocityY(0),0!==this.pullOutOfWall()&&this.setVelocityX(0)}getGravity(){return this.flying&&!1===this.jumpKeyPressed&&this.getVelocityY()>0?a.SHORT_JUMP_GRAVITY:a.GRAVITY}carry(e){this.carrying||(this.height=a.PLAYER_HEIGHT+e.carryHeight+a.PLAYER_CARRY_HEIGHT,e instanceof C.Seed&&this.scene.game.campaign.getQuest(_.QuestKey.A).getHighestTriggerIndex()<_.QuestATrigger.GOT_SEED&&this.scene.game.campaign.getQuest(_.QuestKey.A).trigger(_.QuestATrigger.GOT_SEED),e instanceof R.Wood&&this.scene.game.campaign.getQuest(_.QuestKey.A).getHighestTriggerIndex()<_.QuestATrigger.GOT_WOOD&&(this.scene.game.campaign.getQuest(_.QuestKey.A).trigger(_.QuestATrigger.GOT_WOOD),this.scene.game.campaign.runAction("enable",null,["fire","fire1"])),e instanceof M.Stone&&this.scene.game.campaign.getQuest(_.QuestKey.A).getHighestTriggerIndex()<_.QuestATrigger.GOT_STONE&&this.scene.game.campaign.getQuest(_.QuestKey.A).trigger(_.QuestATrigger.GOT_STONE),this.carrying=e,e.setFloating(!1),e instanceof M.Stone&&(e.state=M.StoneState.DEFAULT),e instanceof C.Seed&&(e.state=C.SeedState.FREE),e instanceof R.Wood&&(e.state=R.WoodState.FREE),e.x=this.x,e.y=this.y+this.height,e.setVelocity(0,0))}isCarrying(e){return e?this.carrying===e:null!=this.carrying}showHint(){if(null===this.playerConversation)switch(this.scene.game.campaign.getQuest(_.QuestKey.A).getHighestTriggerIndex()){case _.QuestATrigger.JUST_ARRIVED:this.think("I should talk to someone.",3e3);break;case _.QuestATrigger.TALKED_TO_FIRE:this.think("I think the fire needs my help.",3e3);break;case _.QuestATrigger.GOT_QUEST_FROM_FIRE:this.think("The fire told me to visit the tree in the east.",3e3);break;case _.QuestATrigger.TALKED_TO_TREE:this.think("Maybe I should talk to the tree again.",3e3);break;case _.QuestATrigger.GOT_QUEST_FROM_TREE:this.think("I need to pick up the seed by the tree.",3e3);break;case _.QuestATrigger.GOT_SEED:this.think("I should check the mountains for a good place for the seed.",3e3);break;case _.QuestATrigger.PLANTED_SEED:this.think("The seed needs something to grow, I think.",3e3);break;case _.QuestATrigger.TALKED_TO_STONE:this.think("I should talk to that crazy stone again.",3e3);break;case _.QuestATrigger.GOT_STONE:this.think("My arms get heavy. I really should throw that thing in the river.",3e3);break;case _.QuestATrigger.THROWN_STONE_INTO_WATER:this.think("There must be something interesting west of the river.",3e3);break;case _.QuestATrigger.GOT_MULTIJUMP:this.think("I should check the clouds. The seed still needs something to grow.",3e3);break;case _.QuestATrigger.MADE_RAIN:this.think("I should talk to that singing tree again.",3e3);break;case _.QuestATrigger.GOT_WOOD:this.think("Quick! The fire needs wood!",3e3)}this.lastHint=Date.now()}isJumpDown(){return this.jumpDown}isPlayer(){return!0}};t.Player=B,n.__decorate([(0,r.asset)(["sprites/pc/female.aseprite.json","sprites/pc/male.aseprite.json","sprites/pc/patient.aseprite.json"]),n.__metadata("design:type",Array)],B,"playerSprites",void 0),n.__decorate([(0,r.asset)(["sprites/buttons_keyboard.aseprite.json","sprites/buttons_xbox.aseprite.json","sprites/buttons_playstation.aseprite.json","sprites/buttons_stadia.aseprite.json"]),n.__metadata("design:type",Array)],B,"buttons",void 0),n.__decorate([(0,r.asset)("sounds/feet-walking/steps_single.mp3"),n.__metadata("design:type",o.Sound)],B,"walkingSound",void 0),n.__decorate([(0,r.asset)("sounds/gate/door_open.mp3"),n.__metadata("design:type",o.Sound)],B,"enterGateSound",void 0),n.__decorate([(0,r.asset)("sounds/portal/enter-portal.ogg"),n.__metadata("design:type",o.Sound)],B,"enterPortalSound",void 0),n.__decorate([(0,r.asset)("sounds/gate/door_close.mp3"),n.__metadata("design:type",o.Sound)],B,"leaveGateSound",void 0),n.__decorate([(0,r.asset)("sounds/jumping/squish.mp3"),n.__metadata("design:type",o.Sound)],B,"bouncingSound",void 0),n.__decorate([(0,r.asset)(a.DIALOG_FONT),n.__metadata("design:type",h.BitmapFont)],B,"font",void 0),t.Player=B=s=n.__decorate([(0,p.entity)("player"),n.__metadata("design:paramtypes",[Object])],B)},7577:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Portal=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1531),h=i(1809);var l;!function(e){e[e.WAITING=0]="WAITING",e[e.FADEIN=1]="FADEIN",e[e.IDLE=2]="IDLE",e[e.FADEOUT=3]="FADEOUT",e[e.GONE=4]="GONE"}(l||(l={}));let d=s=class extends h.Entity{constructor(e){super({width:32,height:50,isTrigger:!1,...e}),this.animationState=l.WAITING,this.animator.assignSprite(s.sprite)}nextAnimationState(){this.animationState++}draw(){switch(this.animationState){case l.WAITING:this.animator.play("empty",1);break;case l.FADEIN:this.animator.play("fadein",1,{loop:!1,callback:this.nextAnimationState.bind(this)});break;case l.IDLE:this.animator.play("idle",1);break;case l.FADEOUT:this.animator.play("fadeout",1,{loop:!1,callback:this.nextAnimationState.bind(this)});break;case l.GONE:this.animator.play("empty",1)}}update(e){super.update(e),this.animationState===l.WAITING?this.timeAlive>=1&&(this.nextAnimationState(),s.sound.play()):this.animationState===l.IDLE?this.timeAlive>=4&&this.nextAnimationState():this.animationState===l.GONE&&this.scene.removeGameObject(this)}};t.Portal=d,n.__decorate([(0,r.asset)("sprites/portal.aseprite.json"),n.__metadata("design:type",a.Aseprite)],d,"sprite",void 0),n.__decorate([(0,r.asset)("sounds/portal/portal.ogg"),n.__metadata("design:type",o.Sound)],d,"sound",void 0),t.Portal=d=s=n.__decorate([(0,h.entity)("portal"),n.__metadata("design:paramtypes",[Object])],d)},7297:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.PowerShiba=t.PowerShibaState=void 0;const n=i(7582),a=n.__importDefault(i(8047)),r=n.__importDefault(i(954)),o=i(9797),h=i(5943),l=i(3595),d=i(1809),u=i(225),c=i(3995);var p;!function(e){e[e.IN_CLOUDS=0]="IN_CLOUDS",e[e.ON_MOUNTAIN=1]="ON_MOUNTAIN",e[e.CONSUMED=2]="CONSUMED"}(p||(t.PowerShibaState=p={}));let g=s=class extends c.NPC{constructor(e){super({width:22,height:22,...e}),this.state=p.IN_CLOUDS,this.floatAmount=4,this.floatSpeed=2,this.conversation=new l.Conversation(a.default,this)}nextState(){if(this.state++,this.state===p.ON_MOUNTAIN){const e=this.scene.pointsOfInterest.find((e=>"powershiba_mountain_spawn"===e.name));if(!e)throw new Error("PowerShiba mountain spawn missing");this.floatSpeed=2,this.floatAmount=4,this.x=e.x,this.y=e.y,this.conversation=new l.Conversation(r.default,this)}}showDialoguePrompt(){return!(!super.showDialoguePrompt()||(!l.Conversation.getGlobals().$gaveBoneToPowerShiba||l.Conversation.getGlobals().$seedgrown)&&(!l.Conversation.getGlobals().$gaveBoneToPowerShiba||!l.Conversation.getGlobals().$seedgrown||l.Conversation.getGlobals().$gotPowerShibaQuest)&&this.state!==p.ON_MOUNTAIN)}feed(){this.floatSpeed=3,this.floatAmount=5,this.scene.game.campaign.runAction("giveBone"),this.think("Oh I remember",3e3)}draw(e){const t=Math.sin(this.timeAlive*this.floatSpeed)*this.floatAmount;this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y-t,u.RenderingLayer.ENTITIES),this.showDialoguePrompt()&&this.drawDialoguePrompt(),this.thinkBubble&&this.thinkBubble.draw(e),this.speechBubble.draw(e)}update(e){super.update(e),this.dialoguePrompt.update(e,this.x,this.y+16),this.speechBubble.update(this.x,this.y),this.thinkBubble&&this.thinkBubble.update(this.x,this.y)}};t.PowerShiba=g,n.__decorate([(0,h.asset)("sprites/powershiba.aseprite.json"),n.__metadata("design:type",o.Aseprite)],g,"sprite",void 0),t.PowerShiba=g=s=n.__decorate([(0,d.entity)("powershiba"),n.__metadata("design:paramtypes",[Object])],g)},8881:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Radio=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1809),h=i(225);let l=s=class extends o.Entity{constructor(e){super({width:24,height:24,...e,isTrigger:!1})}draw(){this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y,h.RenderingLayer.ENTITIES)}update(){}};t.Radio=l,n.__decorate([(0,r.asset)("sprites/radio.aseprite.json"),n.__metadata("design:type",a.Aseprite)],l,"sprite",void 0),t.Radio=l=s=n.__decorate([(0,o.entity)("radio"),n.__metadata("design:paramtypes",[Object])],l)},7701:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.RiddleStone=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1809),h=i(225);let l=s=class extends o.Entity{constructor({col:e=0,row:t=0,...i}){super({width:16,height:16,isTrigger:!1,...i}),this.col=e,this.row=t}draw(){this.scene.mountainRiddle.isCorrectGate(this.col,this.row)&&this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y,h.RenderingLayer.ENTITIES)}update(){}};t.RiddleStone=l,n.__decorate([(0,r.asset)("sprites/riddlestone.aseprite.json"),n.__metadata("design:type",a.Aseprite)],l,"sprite",void 0),t.RiddleStone=l=s=n.__decorate([(0,o.entity)("riddlestone"),n.__metadata("design:paramtypes",[Object])],l)},6342:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ScriptableNPC=void 0;const s=i(8875),n=i(3995);class a extends n.NPC{constructor(){super(...arguments),this.move=0}updatePosition(e,t){this.x=e,this.y=t,0===this.pullOutOfGround()&&0===this.pullOutOfCeiling()||this.setVelocityY(0),0!==this.pullOutOfWall()&&this.setVelocityX(0)}pullOutOfGround(){let e=0,t=0;if(this.getVelocityY()<=0){const i=this.scene.world,n=i.getHeight();for(t=i.collidesWith(this.x,this.y,[this],[s.Environment.WATER]);this.y<n&&t;)e++,this.y++,t=i.collidesWith(this.x,this.y)}return e}pullOutOfCeiling(){let e=0;const t=this.scene.world;for(;this.y>0&&t.collidesWith(this.x,this.y+this.height,[this],[s.Environment.PLATFORM,s.Environment.WATER]);)e++,this.y--;return e}pullOutOfWall(){let e=0;const t=this.scene.world;if(this.getVelocityX()>0)for(;t.collidesWithVerticalLine(this.x+this.width/2,this.y+3*this.height/4,this.height/2,[this],[s.Environment.PLATFORM,s.Environment.WATER]);)this.x--,e++;else for(;t.collidesWithVerticalLine(this.x-this.width/2,this.y+3*this.height/4,this.height/2,[this],[s.Environment.PLATFORM,s.Environment.WATER]);)this.x++,e++;return e}update(e){super.update(e)}}t.ScriptableNPC=a},8883:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Seed=t.SeedState=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1531),h=i(3595),l=i(1809),d=i(6607),u=i(8129),c=i(225),p=i(6070),g=i(8875),m=i(3995),y=i(3011);var f;!function(e){e[e.FREE=0]="FREE",e[e.PLANTED=1]="PLANTED",e[e.SWIMMING=2]="SWIMMING",e[e.GROWN=3]="GROWN"}(f||(t.SeedState=f={}));let _=s=class extends m.NPC{constructor(e){super({width:24,height:24,...e}),this.state=f.FREE,this.wood=new y.Wood({scene:this.scene,x:this.x,y:this.y}),this.face=new d.Face(this.scene,this,d.EyeType.STANDARD,0,8);const t=this.scene.pointsOfInterest.find((e=>"recover_floating_position"===e.name));if(!t)throw new Error("Could not find recover_floating_position point of interest in game scene.");this.floatingPosition=t}resetState(){this.setFloating(!1),this.state=f.FREE}bury(){const e=this.scene.pointsOfInterest.find((e=>"seedposition"===e.name));if(!e)throw new Error("Seed position is missing in points of interest array");this.x=e.x,this.y=e.y}getSpriteTag(){switch(this.state){case f.PLANTED:return"planted";case f.GROWN:return"grown";default:return"free"}}draw(e){this.scene.renderer.addAseprite(s.sprite,this.getSpriteTag(),this.x,this.y-1,c.RenderingLayer.ENTITIES,void 0),this.state===f.GROWN&&this.drawFace(e),this.speechBubble.draw(e)}isCarried(){return this.scene.player.isCarrying(this)}grow(){this.state===f.PLANTED&&(this.state=f.GROWN,this.scene.seed=this,h.Conversation.setGlobal("seedgrown","true"),this.scene.game.campaign.runAction("enable",null,["tree","tree2"]),this.scene.game.campaign.runAction("enable",null,["seed","seed1"]))}update(e){if(super.update(e),this.state===f.SWIMMING){const t=this.floatingPosition.x-this.x,i=Math.min(20,Math.abs(t))*Math.sign(t);this.x+=i*e,this.setVelocityY(Math.abs(((0,p.now)()%2e3-1e3)/1e3)-.5)}if(this.state===f.FREE||this.state===f.SWIMMING){const e=this.scene.player;if(!this.isCarried()&&this.distanceTo(e)<20&&e.carry(this),!this.isCarried()&&this.scene.world.collidesWith(this.x,this.y-8)===g.Environment.SOIL){const e=this.scene.pointsOfInterest.find((e=>"seedposition"===e.name));if(!e)throw new Error("Seed position is missing in points of interest array");this.state=f.PLANTED,this.scene.game.campaign.getQuest(u.QuestKey.A).trigger(u.QuestATrigger.PLANTED_SEED),this.setFloating(!0),this.x=e.x,this.y=e.y,s.successSound.play(),h.Conversation.setGlobal("seedplanted","true")}this.isCarried()||this.state===f.SWIMMING||this.scene.world.collidesWith(this.x,this.y-5)!==g.Environment.WATER||(this.state=f.SWIMMING,this.setVelocity(0,0),this.setFloating(!0),this.y=this.floatingPosition.y)}else this.state===f.PLANTED?this.scene.world.isRaining()&&this.grow():(this.state,f.GROWN);this.speechBubble.update(this.x,this.y)}spawnWood(){return this.scene.gameObjects.includes(this.wood)||this.scene.addGameObject(this.wood),this.wood.x=this.x,this.wood.y=this.y+this.height/2,this.wood.setVelocity(-5,0),this.wood}startDialog(){}};t.Seed=_,n.__decorate([(0,r.asset)("sprites/seed.aseprite.json"),n.__metadata("design:type",a.Aseprite)],_,"sprite",void 0),n.__decorate([(0,r.asset)("sounds/throwing/success.mp3"),n.__metadata("design:type",o.Sound)],_,"successSound",void 0),t.Seed=_=s=n.__decorate([(0,l.entity)("seed"),n.__metadata("design:paramtypes",[Object])],_)},9021:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowPresence=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1531),h=i(3882),l=i(1809),d=i(8129),u=i(225),c=i(3995);var p;!function(e){e.INVISIBLE="invisible",e.IDLE="idle"}(p||(p={}));let g=s=class extends c.NPC{constructor(e){super({width:12,height:46,...e}),this.isNearPlayer=!1,this.direction=-1,this.lookAtPlayer=!1,this.soundEmitter=new h.SoundEmitter({scene:this.scene,x:this.x,y:this.y,sound:s.caveAmbience,maxVolume:.3,intensity:1})}showDialoguePrompt(){return!!super.showDialoguePrompt()&&this.isNearPlayer&&this.scene.game.campaign.getQuest(d.QuestKey.A).isTriggered(d.QuestATrigger.TALKED_TO_FIRE)&&!this.scene.game.campaign.getQuest(d.QuestKey.A).isTriggered(d.QuestATrigger.GOT_RUNNING_ABILITY)}draw(e){const t=this.direction<0?{x:-1,y:1}:void 0,i=this.isNearPlayer?p.IDLE:p.INVISIBLE;this.scene.renderer.add({type:u.RenderingType.ASEPRITE,layer:u.RenderingLayer.ENTITIES,translation:{x:this.x,y:-this.y},position:{x:-s.sprite.width>>1,y:-s.sprite.height},scale:t,asset:s.sprite,animationTag:i,time:1e3*this.scene.gameTime}),this.showDialoguePrompt()&&this.drawDialoguePrompt(),this.speechBubble.draw(e)}checkPlayerDistance(){this.isNearPlayer=!1,this.distanceTo(this.scene.player)<60&&(this.isNearPlayer=!0)}update(e){super.update(e),this.checkPlayerDistance(),this.dialoguePrompt.update(e,this.x,this.y+48),this.speechBubble.update(this.x,this.y+12),this.soundEmitter.update()}};t.ShadowPresence=g,n.__decorate([(0,r.asset)("sprites/shadowpresence.aseprite.json"),n.__metadata("design:type",a.Aseprite)],g,"sprite",void 0),n.__decorate([(0,r.asset)("sounds/ambient/cave.ogg"),n.__metadata("design:type",o.Sound)],g,"caveAmbience",void 0),t.ShadowPresence=g=s=n.__decorate([(0,l.entity)("shadowpresence"),n.__metadata("design:paramtypes",[Object])],g)},5683:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Shiba=void 0;const n=i(7582),a=n.__importDefault(i(1466)),r=n.__importDefault(i(2630)),o=i(4488),h=i(9797),l=i(5943),d=i(1531),u=i(3595),c=i(1809),p=i(6607),g=i(3121),m=i(8129),y=i(225),f=i(6070),_=i(8875),w=i(2170),v=i(6533),b=i(6342),T=i(122),E=[2,3,4],I=[.5,1,1.2,1.5];let A=s=class extends b.ScriptableNPC{constructor(e){super({width:28,height:24,...e}),this.state=T.ShibaState.ON_TREE,this.idleTimer=(0,f.rndItem)(E),this.walkTimer=null,this.autoMoveDirection=1,this.jumpHeight=1.5,this.jumpTimer=0,this.flyingTime=0,this.saidFarewell=!1,this.peeing=!1,this.isBeingPetted=!1,this.nextHeartParticle=.5,this.minAltitude=this.y,this.conversation=new u.Conversation(a.default,this),this.setMaxVelocity(2),this.conversation=new u.Conversation(r.default,this),this.doubleJumpEmitter=this.scene.particles.createEmitter({position:{x:this.x,y:this.y},velocity:()=>({x:90*(0,f.rnd)(-1,1),y:100*(0,f.rnd)(-1,0)}),color:()=>(0,f.rndItem)(o.DOUBLE_JUMP_COLORS),size:(0,f.rnd)(1,2),gravity:{x:0,y:-120},lifetime:()=>(0,f.rnd)(.4,.6),alphaCurve:g.valueCurves.trapeze(.05,.2)}),this.heartEmitter=this.scene.particles.createEmitter({position:{x:this.x,y:this.y},offset:()=>({x:(0,f.rnd)(-8,8),y:18}),velocity:()=>({x:0,y:5}),color:()=>s.heartImage,size:Math.max(s.heartImage.width,s.heartImage.height),gravity:{x:0,y:0},lifetime:()=>(0,f.rnd)(1.5,3),blendMode:"source-over",alphaCurve:g.valueCurves.cos(.1,.5)})}setState(e){this.state=e}getState(){return this.state}nextState(){if(this.state++,this.state===T.ShibaState.FLYING_AWAY)this.lookAtPlayer=!1,this.scene.player.disableMultiJump(),this.setMaxVelocity(3);else if(this.state===T.ShibaState.ON_MOUNTAIN){this.move=0;const e=this.scene.pointsOfInterest.find((e=>"shiba_mountain_spawn"===e.name));if(!e)throw new Error("Shiba mountain spawn missing");this.x=e.x,this.y=e.y,this.scene.game.campaign.runAction("enable",null,["shiba","shiba4"]),this.scene.powerShiba.nextState()}else if(this.state===T.ShibaState.GOING_TO_FIRE){this.scene.camera.setCinematicBar(1);const e=this.scene.pointsOfInterest.find((e=>"friendship_shiba_spawn"===e.name));if(this.lookAtPlayer=!1,this.setMaxVelocity(2),this.scene.startFriendshipMusic(),!e)throw new Error("'friendship_shiba_spawn' point in map is missing");this.x=e.x,this.y=e.y}else this.state===T.ShibaState.KILLING_FIRE?(this.move=0,setTimeout((()=>this.think("Wow!",1500)),500),setTimeout((()=>this.direction=1),1e3),setTimeout((()=>{this.think("Bad fire!",2e3),this.scene.fire.setState(v.FireState.BEING_PUT_OUT),this.scene.fire.growthTarget=w.SHRINK_SIZE,this.peeing=!0,s.putOutSound.setVolume(.3),s.putOutSound.play()}),2e3),setTimeout((()=>this.scene.fire.think("Oh God",2e3)),4500),setTimeout((()=>this.scene.fire.think("Disgusting",3e3)),8e3)):this.state===T.ShibaState.FIRE_KILLED&&(this.peeing=!1,this.scene.fire.state=v.FireState.PUT_OUT,s.putOutSound.stop(),setTimeout((()=>this.direction=-1),1e3),setTimeout((()=>this.think("I help friend!",1500)),1500),setTimeout((()=>{this.scene.fire.think("Yeah, great.",2e3),this.scene.fire.face?.setMode(p.FaceModes.BORED),this.scene.player.isControllable=!0,this.scene.friendshipCutscene=!1,this.lookAtPlayer=!0,this.scene.game.campaign.runAction("enable",null,["fire","fire4"]),this.scene.game.campaign.runAction("enable",null,["shiba","shiba5"]),this.scene.game.campaign.getQuest(m.QuestKey.B).finish()}),3500))}jump(){this.jumpTimer=.3,this.setVelocityY(Math.sqrt(2*this.jumpHeight*o.GRAVITY)),this.doubleJumpEmitter.setPosition(this.x,this.y+20),this.doubleJumpEmitter.emit(20);const e=(0,f.calculateVolume)(this.distanceToPlayer,.4);e>0&&(s.jumpSound.setVolume(e),s.jumpSound.stop(),s.jumpSound.play())}canJump(){return 0===this.jumpTimer}startBeingPetted(){this.isBeingPetted=!0;const e=this.direction>0?this.x+5:this.x-5;this.heartEmitter.setPosition(e,this.y)}stopBeingPetted(){this.isBeingPetted=!1}getAnimationTag(){return this.peeing?"peeing":this.isBeingPetted?"petted":"idle"}draw(e){0===this.move?this.scene.renderer.addAseprite(s.sprite,this.getAnimationTag(),this.x,this.y,y.RenderingLayer.ENTITIES,this.direction):this.scene.renderer.addAseprite(s.sprite,"walk",this.x,this.y,y.RenderingLayer.ENTITIES,this.direction),this.showDialoguePrompt()&&this.drawDialoguePrompt(),this.thinkBubble&&this.thinkBubble.draw(e),this.speechBubble.draw(e)}showDialoguePrompt(){return super.showDialoguePrompt(),!1}update(e){super.update(e),this.isBeingPetted&&(this.nextHeartParticle-=e,this.nextHeartParticle<0&&(this.heartEmitter.emit(1),this.nextHeartParticle=.5),this.heartEmitter.update(e));const t=this.scene.world.getTriggerCollisions(this);this.hasActiveConversation()||this.isBeingPetted?this.move=0:this.state===T.ShibaState.ON_TREE?this.onTreeUpdateLogic(t,e):this.state===T.ShibaState.FLYING_AWAY?this.flyingAwayUpdateLogic(e):this.state===T.ShibaState.GOING_TO_FIRE&&this.walkToFireLogic(t),0!==this.move?(this.direction=this.move,this.accelerateX(15*e*this.move)):this.getVelocityX()>0?this.decelerateX(15*e):this.decelerateX(-15*e),this.dialoguePrompt.update(e,this.x,this.y+20),this.speechBubble.update(this.x,this.y),this.thinkBubble&&this.thinkBubble.update(this.x,this.y)}isReadyForConversation(){return!0===super.isReadyForConversation()&&this.state!==T.ShibaState.FLYING_AWAY&&!this.isBeingPetted}walkToFireLogic(e){this.move=-1,this.scene.world.collidesWithVerticalLine(this.x-this.width/2,this.y+this.height,this.height,[this],[_.Environment.PLATFORM,_.Environment.WATER])&&this.jump(),e.length>0&&e.find((e=>"shiba_stop"===e.name))&&this.nextState()}onTreeUpdateLogic(e,t){if(e.length>0){const t=e.find((e=>"shiba_action"===e.name));null!=t&&null!=t.properties.velocity&&(this.autoMoveDirection=t.properties.velocity>0?1:-1,this.move=this.autoMoveDirection)}null!==this.idleTimer&&this.idleTimer>=0&&(this.idleTimer-=t),null!==this.walkTimer&&this.walkTimer>=0&&(this.walkTimer-=t),null!=this.idleTimer&&this.idleTimer<=0&&null===this.walkTimer&&(this.walkTimer=(0,f.rndItem)(I),this.idleTimer=null,this.move=this.autoMoveDirection),null!=this.walkTimer&&this.walkTimer<=0&&null===this.idleTimer&&(this.idleTimer=(0,f.rndItem)(E),this.walkTimer=null,this.move=0),u.Conversation.getGlobals().$gotBoneQuest&&!u.Conversation.getGlobals().$broughtBone&&this.distanceTo(this.scene.bone)<100&&(u.Conversation.setGlobal("broughtBone","true"),this.think("Wow! Bone!!!",2e3),this.scene.game.campaign.runAction("enable",null,["shiba","shiba2"]))}flyingAwayUpdateLogic(e){this.move=1,this.minAltitude+=20*e,this.jumpTimer>0&&(this.jumpTimer-=e,this.jumpTimer<0&&(this.jumpTimer=0)),this.y<this.minAltitude&&this.canJump()&&this.jump(),this.flyingTime+=e,!this.saidFarewell&&this.flyingTime>2&&(this.saidFarewell=!0,this.think("See you on the mountain!",3e3)),this.flyingTime>=8&&this.nextState()}};t.Shiba=A,n.__decorate([(0,l.asset)("sprites/shiba.aseprite.json"),n.__metadata("design:type",h.Aseprite)],A,"sprite",void 0),n.__decorate([(0,l.asset)("sounds/ending/putout.mp3"),n.__metadata("design:type",d.Sound)],A,"putOutSound",void 0),n.__decorate([(0,l.asset)("sounds/jumping/jump_neutral.ogg"),n.__metadata("design:type",d.Sound)],A,"jumpSound",void 0),n.__decorate([(0,l.asset)("sprites/heart.aseprite.json"),n.__metadata("design:type",h.Aseprite)],A,"heartImage",void 0),t.Shiba=A=s=n.__decorate([(0,c.entity)("shiba"),n.__metadata("design:paramtypes",[Object])],A)},122:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ShibaState=void 0,function(e){e[e.ON_TREE=0]="ON_TREE",e[e.FLYING_AWAY=1]="FLYING_AWAY",e[e.ON_MOUNTAIN=2]="ON_MOUNTAIN",e[e.GOING_TO_FIRE=3]="GOING_TO_FIRE",e[e.KILLING_FIRE=4]="KILLING_FIRE",e[e.FIRE_KILLED=5]="FIRE_KILLED"}(i||(t.ShibaState=i={}))},8491:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Sign=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(3595),h=i(1809),l=i(225),d=i(3995);let u=s=class extends d.NPC{constructor({content:e,...t}){super({width:16,height:16,...t}),this.conversation=this.generateConversation(this.prepareContent(e))}prepareContent(e){return null==e?["The sign is empty."]:e.split(":::")}getInteractionText(){return"Read sign"}generateConversation(e){const t={entry:[]};return e.forEach(((i,s)=>{s===e.length-1&&(i+=" @entry !end"),t.entry.push(i)})),new o.Conversation(t,this)}draw(e){this.scene.renderer.add({type:l.RenderingType.ASEPRITE,layer:l.RenderingLayer.ENTITIES,translation:{x:this.x,y:-this.y},position:{x:-s.sprite.width>>1,y:-s.sprite.height},asset:s.sprite,animationTag:"idle",time:1e3*this.scene.gameTime}),this.speechBubble.draw(e)}update(){}};t.Sign=u,n.__decorate([(0,r.asset)("sprites/sign.aseprite.json"),n.__metadata("design:type",a.Aseprite)],u,"sprite",void 0),t.Sign=u=s=n.__decorate([(0,h.entity)("sign"),n.__metadata("design:paramtypes",[Object])],u)},9395:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Skull=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1809),h=i(225),l=i(9899);let d=s=class extends l.PhysicsEntity{constructor(e){super({width:16,height:16,...e})}draw(){this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y,h.RenderingLayer.ENTITIES)}isCarried(){return this.scene.player.isCarrying(this)}update(e){super.update(e);const t=this.scene.player;!this.isCarried()&&this.distanceTo(t)<20&&t.carry(this)}};t.Skull=d,n.__decorate([(0,r.asset)("sprites/skull.aseprite.json"),n.__metadata("design:type",a.Aseprite)],d,"sprite",void 0),t.Skull=d=s=n.__decorate([(0,o.entity)("skull"),n.__metadata("design:paramtypes",[Object])],d)},3220:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Snowball=void 0;const s=i(7582),n=i(4488),a=i(1809),r=i(225),o=i(9899);let h=class extends o.PhysicsEntity{constructor(e){super({width:.25*n.PIXEL_PER_METER,height:.25*n.PIXEL_PER_METER,...e})}draw(){this.scene.renderer.add({type:r.RenderingType.RAW,layer:r.RenderingLayer.ENTITIES,draw:e=>{e.save(),e.beginPath(),e.translate(this.x,-this.y),e.strokeStyle="black",e.fillStyle="white",e.beginPath(),e.arc(0,-this.height/2,this.width/2,0,2*Math.PI,!1),e.fill(),e.stroke(),e.restore()}})}};t.Snowball=h,t.Snowball=h=s.__decorate([(0,a.entity)("snowball"),s.__metadata("design:paramtypes",[Object])],h)},9690:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Stone=t.StoneState=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1531),h=i(1809),l=i(6607),d=i(8129),u=i(225),c=i(6070),p=i(8875),g=i(3995);var m;!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.SWIMMING=1]="SWIMMING",e[e.FLOATING=2]="FLOATING"}(m||(t.StoneState=m={}));let y=s=class extends g.NPC{constructor(e){super({width:26,height:50,...e}),this.state=m.DEFAULT,this.direction=-1,this.face=new l.Face(this.scene,this,l.EyeType.STONE,0,21),this.lookAtPlayer=!1,this.carryHeight=16;const t=this.scene.pointsOfInterest.find((e=>"stone_floating_position"===e.name));if(!t)throw new Error('Could not find "stone_floating_position" point of interest in game scene');this.floatingPosition=t}showDialoguePrompt(){return!!super.showDialoguePrompt()&&this.scene.game.campaign.getQuest(d.QuestKey.A).getHighestTriggerIndex()>=d.QuestATrigger.PLANTED_SEED&&this.scene.game.campaign.getQuest(d.QuestKey.A).getHighestTriggerIndex()<d.QuestATrigger.GOT_STONE}draw(e){this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y-1,u.RenderingLayer.ENTITIES,this.direction),this.drawFace(e,!1),this.showDialoguePrompt()&&this.drawDialoguePrompt(),this.speechBubble.draw(e)}update(e){if(super.update(e),this.state===m.DEFAULT)this.scene.world.collidesWith(this.x,this.y-5)===p.Environment.WATER&&(this.scene.game.campaign.getQuest(d.QuestKey.A).trigger(d.QuestATrigger.THROWN_STONE_INTO_WATER),this.state=m.SWIMMING,this.setVelocity(0,0),this.setFloating(!0),this.y=this.floatingPosition.y,s.successSound.play(),this.scene.game.campaign.runAction("enable",null,["stone","stone2"]),this.scene.game.campaign.runAction("enable",null,["flameboy","flameboy2"]),this.scene.game.campaign.runAction("enable",null,["caveman","caveman2"]));else if(this.state===m.SWIMMING){const t=this.floatingPosition.x-this.x;this.direction=Math.sign(t);const i=Math.min(20,Math.abs(t))*Math.sign(t);this.x+=i*e,Math.abs(i)<2&&(this.state=m.FLOATING),this.setVelocityY(Math.abs(((0,c.now)()%2e3-1e3)/1e3)-.5)}else this.state===m.FLOATING&&(this.x=this.floatingPosition.x,this.direction=-1,this.setVelocityY(Math.abs(((0,c.now)()%2e3-1e3)/1e3)-.5));this.dialoguePrompt.update(e,this.x,this.y+48),this.speechBubble.update(this.x,this.y)}collidesWith(e,t){return(this.state===m.FLOATING||this.state===m.SWIMMING)&&e>=this.x-this.width/2&&e<=this.x+this.width/2&&t>=this.y&&t<=this.y+this.height?p.Environment.SOLID:p.Environment.AIR}isCarried(){return this.scene.player.isCarrying(this)}pickUp(){this.face?.setMode(l.FaceModes.AMUSED),this.scene.player.carry(this),this.scene.game.campaign.runAction("enable",null,["flameboy","flameboy4"])}dropInWater(){this.x=this.floatingPosition.x,this.y=this.floatingPosition.y}};t.Stone=y,n.__decorate([(0,r.asset)("sprites/stone.aseprite.json"),n.__metadata("design:type",a.Aseprite)],y,"sprite",void 0),n.__decorate([(0,r.asset)("sounds/throwing/success.mp3"),n.__metadata("design:type",o.Sound)],y,"successSound",void 0),t.Stone=y=s=n.__decorate([(0,h.entity)("stone"),n.__metadata("design:paramtypes",[Object])],y)},9288:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.StoneDisciple=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(3595),h=i(1809),l=i(6607),d=i(225),u=i(3995);let c=s=class extends u.NPC{constructor(e){super({width:32,height:26,...e}),this.direction=-1,this.lookAtPlayer=!0,this.face=new l.Face(this.scene,this,l.EyeType.STONEDISCIPLE,0,0)}showDialoguePrompt(){if(!super.showDialoguePrompt())return!1;const e=o.Conversation.getGlobals().$talkedToStoneDisciple,t=o.Conversation.getGlobals().$talkedToStoneDiscipleAgain,i=o.Conversation.getGlobals().$gotTeleported;return void 0===e||void 0!==i&&void 0===t}draw(e){this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y,d.RenderingLayer.ENTITIES,this.direction),this.drawFace(e,!1),this.showDialoguePrompt()&&this.drawDialoguePrompt(),this.speechBubble.draw(e)}update(e){super.update(e),this.dialoguePrompt.update(e,this.x,this.y+this.height),this.speechBubble.update(this.x,this.y)}};t.StoneDisciple=c,n.__decorate([(0,r.asset)("sprites/stonedisciple.aseprite.json"),n.__metadata("design:type",a.Aseprite)],c,"sprite",void 0),t.StoneDisciple=c=s=n.__decorate([(0,h.entity)("stonedisciple"),n.__metadata("design:paramtypes",[Object])],c)},3326:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.SuperThrow=void 0;const n=i(7582),a=n.__importDefault(i(6073)),r=i(9797),o=i(5943),h=i(3595),l=i(1809),d=i(225),u=i(3995);let c=s=class extends u.NPC{constructor(e){super({width:18,height:22,...e}),this.floatAmount=4,this.floatSpeed=2,this.lookAtPlayer=!1,this.conversation=new h.Conversation(a.default,this)}getInteractionText(){return this.met?"Talk":"Touch"}draw(e){const t=Math.sin(this.timeAlive*this.floatSpeed)*this.floatAmount;this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y-t,d.RenderingLayer.ENTITIES,this.direction),this.speechBubble.draw(e)}update(e){super.update(e),this.speechBubble.update(this.x,this.y)}};t.SuperThrow=c,n.__decorate([(0,o.asset)("sprites/superthrow.aseprite.json"),n.__metadata("design:type",r.Aseprite)],c,"sprite",void 0),t.SuperThrow=c=s=n.__decorate([(0,l.entity)("superthrow"),n.__metadata("design:paramtypes",[Object])],c)},4214:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Tree=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1809),h=i(6607),l=i(8129),d=i(225),u=i(3995),c=i(8883),p=i(3011);let g=s=class extends u.NPC{constructor(e){super({width:78,height:140,...e}),this.face=new h.Face(this.scene,this,h.EyeType.TREE,5,94),this.seed=new c.Seed({scene:this.scene,x:this.x,y:this.y}),this.wood=new p.Wood({scene:this.scene,x:this.x,y:this.y}),this.startDialog()}showDialoguePrompt(){return!!super.showDialoguePrompt()&&(this.scene.game.campaign.getQuest(l.QuestKey.A).getHighestTriggerIndex()>=l.QuestATrigger.GOT_QUEST_FROM_FIRE&&this.scene.game.campaign.getQuest(l.QuestKey.A).getHighestTriggerIndex()<l.QuestATrigger.GOT_QUEST_FROM_TREE||this.scene.game.campaign.getQuest(l.QuestKey.A).getHighestTriggerIndex()>=l.QuestATrigger.MADE_RAIN&&this.scene.game.campaign.getQuest(l.QuestKey.A).getHighestTriggerIndex()<l.QuestATrigger.TREE_DROPPED_WOOD)}draw(e){this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y,d.RenderingLayer.ENTITIES),this.drawFace(e),this.showDialoguePrompt()&&this.drawDialoguePrompt(),this.speechBubble.draw(e)}update(e){super.update(e),this.showDialoguePrompt()&&this.dialoguePrompt.update(e,this.x+4,this.y+128)}startDialog(){this.speechBubble.update(this.x,this.y)}spawnSeed(){return this.scene.gameObjects.includes(this.seed)||this.scene.addGameObject(this.seed),this.seed.resetState(),this.seed.x=this.x,this.seed.y=this.y+this.height/2,this.seed.setVelocity(5,0),this.seed}spawnWood(){return this.scene.gameObjects.includes(this.wood)||this.scene.addGameObject(this.wood),this.wood.resetState(),this.wood.x=this.x,this.wood.y=this.y+this.height/2,this.wood.setVelocity(5,0),this.wood}};t.Tree=g,n.__decorate([(0,r.asset)("sprites/tree.aseprite.json"),n.__metadata("design:type",a.Aseprite)],g,"sprite",void 0),t.Tree=g=s=n.__decorate([(0,o.entity)("tree"),n.__metadata("design:paramtypes",[Object])],g)},8932:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Wall=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1809),h=i(225),l=i(8875);var d;!function(e){e[e.SOLID=0]="SOLID",e[e.CRUMBLED=1]="CRUMBLED"}(d||(d={}));let u=s=class extends o.Entity{constructor({identifier:e,...t}){if(super({width:24,height:72,isTrigger:!1,...t}),this.state=d.SOLID,null==e)throw new Error("Cannot create Wall entity with no identifier property");this.identifier=e}draw(){const e=this.state===d.SOLID?"solid":"crumbled";this.scene.renderer.addAseprite(s.sprite,e,this.x,this.y,h.RenderingLayer.ENTITIES)}update(){}crumble(){this.state=d.CRUMBLED}collidesWith(e,t){return this.state===d.SOLID&&e>=this.x-this.width/2&&e<=this.x+this.width/2&&t>=this.y&&t<=this.y+this.height?l.Environment.SOLID:l.Environment.AIR}};t.Wall=u,n.__decorate([(0,r.asset)("sprites/wall.aseprite.json"),n.__metadata("design:type",a.Aseprite)],u,"sprite",void 0),t.Wall=u=s=n.__decorate([(0,o.entity)("wall"),n.__metadata("design:paramtypes",[Object])],u)},567:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Window=void 0;const s=i(7582),n=i(3595),a=i(1809),r=s.__importDefault(i(7574)),o=i(3995);let h=class extends o.NPC{constructor(e){super({width:16,height:16,...e}),this.conversation=new n.Conversation(r.default,this)}getInteractionText(){return"Check window"}draw(e){this.speechBubble.draw(e)}update(){}};t.Window=h,t.Window=h=s.__decorate([(0,a.entity)("window"),s.__metadata("design:paramtypes",[Object])],h)},1616:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Wing=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1809),h=i(8129),l=i(225),d=i(3995);let u=s=class extends d.NPC{constructor(e){super({width:24,height:24,...e}),this.floatAmount=4,this.floatSpeed=2}showDialoguePrompt(){return!!super.showDialoguePrompt()&&this.scene.game.campaign.getQuest(h.QuestKey.A).isTriggered(h.QuestATrigger.PLANTED_SEED)&&!this.scene.game.campaign.getQuest(h.QuestKey.A).isTriggered(h.QuestATrigger.LEARNED_RAIN_DANCE)}draw(e){const t=Math.sin(this.timeAlive*this.floatSpeed)*this.floatAmount;this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y-t,l.RenderingLayer.ENTITIES),this.showDialoguePrompt()&&this.drawDialoguePrompt(),this.speechBubble.draw(e)}update(e){super.update(e),this.dialoguePrompt.update(e,this.x,this.y+16),this.speechBubble.update(this.x,this.y)}};t.Wing=u,n.__decorate([(0,r.asset)("sprites/wing.aseprite.json"),n.__metadata("design:type",a.Aseprite)],u,"sprite",void 0),t.Wing=u=s=n.__decorate([(0,o.entity)("wing"),n.__metadata("design:paramtypes",[Object])],u)},3011:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.Wood=t.WoodState=void 0;const n=i(7582),a=i(9797),r=i(5943),o=i(1531),h=i(1809),l=i(8129),d=i(225),u=i(6070),c=i(8875),p=i(9899);var g;!function(e){e[e.FREE=0]="FREE",e[e.SWIMMING=1]="SWIMMING"}(g||(t.WoodState=g={}));let m=s=class extends p.PhysicsEntity{constructor(e){super({width:26,height:16,...e}),this.state=g.FREE;const t=this.scene.pointsOfInterest.find((e=>"recover_floating_position"===e.name));if(!t)throw new Error('Could not find "recover_floating_position" point of interest in game scene.');this.floatingPosition=t}resetState(){this.setFloating(!1),this.state=g.FREE}draw(){this.scene.renderer.addAseprite(s.sprite,"idle",this.x,this.y,d.RenderingLayer.ENTITIES)}isCarried(){return this.scene.player.isCarrying(this)}update(e){if(super.update(e),this.state===g.SWIMMING){const t=this.floatingPosition.x-this.x,i=Math.min(20,Math.abs(t))*Math.sign(t);this.x+=i*e,this.setVelocityY(Math.abs(((0,u.now)()%2e3-1e3)/1e3)-.5)}if(this.state===g.FREE||this.state===g.SWIMMING){const e=this.scene.player;!this.isCarried()&&this.distanceTo(e)<20&&e.carry(this),this.isCarried()||this.state===g.SWIMMING||this.scene.world.collidesWith(this.x,this.y-5)!==c.Environment.WATER||(this.state=g.SWIMMING,this.setVelocity(0,0),this.setFloating(!0),this.y=this.floatingPosition.y+8)}!this.isCarried()&&this.distanceTo(this.scene.fire)<20&&(this.scene.fire.feed(this),this.scene.game.campaign.getQuest(l.QuestKey.A).trigger(l.QuestATrigger.THROWN_WOOD_INTO_FIRE),s.successSound.play()),!this.isCarried()&&this.distanceTo(this.scene.flameboy)<20&&(this.scene.flameboy.feed(this),s.successSound.play())}};t.Wood=m,n.__decorate([(0,r.asset)("sprites/wood.aseprite.json"),n.__metadata("design:type",a.Aseprite)],m,"sprite",void 0),n.__decorate([(0,r.asset)("sounds/throwing/success.mp3"),n.__metadata("design:type",o.Sound)],m,"successSound",void 0),t.Wood=m=s=n.__decorate([(0,h.entity)("wood"),n.__metadata("design:paramtypes",[Object])],m)},9241:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.Direction=void 0,function(e){e[e.CENTER=0]="CENTER",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.TOP=4]="TOP",e[e.BOTTOM=8]="BOTTOM",e[e.TOP_LEFT=5]="TOP_LEFT",e[e.BOTTOM_LEFT=9]="BOTTOM_LEFT",e[e.TOP_RIGHT=6]="TOP_RIGHT",e[e.BOTTOM_RIGHT=10]="BOTTOM_RIGHT"}(i||(t.Direction=i={})),function(e){function t(t){return 0!=(t&e.LEFT)}function i(t){return 0!=(t&e.RIGHT)}function s(t){return 0!=(t&e.TOP)}function n(t){return 0!=(t&e.BOTTOM)}e.isLeft=t,e.isRight=i,e.isTop=s,e.isBottom=n,e.isHorizontal=function(e){return t(e)||i(e)},e.isVertical=function(e){return s(e)||n(e)},e.isEdge=function(t){return t===e.LEFT||t===e.RIGHT||t===e.TOP||t===e.BOTTOM},e.isCorner=function(t){return t===e.TOP_LEFT||t===e.TOP_RIGHT||t===e.BOTTOM_LEFT||t===e.BOTTOM_RIGHT},e.getX=function(e){return t(e)?-1:i(e)?1:0},e.getY=function(e){return s(e)?-1:n(e)?1:0}}(i||(t.Direction=i={}))},8557:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getImageData=t.createContext2D=t.getRenderingContext=t.getGameCanvas=t.createCanvas=t.loadImage=void 0;const s=i(4488);let n;function a(e,t){const i=document.createElement("canvas");if(null==i)throw new Error("No canvas support");return i.width=e,i.height=t,i}function r(e,t,i){const s=e.getContext(t,i);if(null==s)throw new Error(`Canvas doesn't support context with id '${t}'`);return s}function o(e,t){return r(a(e,t),"2d")}t.loadImage=async function(e){const t=new Image;return new Promise(((i,s)=>{t.onload=()=>{i(t)},t.onerror=()=>{s(new Error(`Unable to load image '${e.toString()}'`))},t.src=e instanceof URL?e.href:`assets/${e}`}))},t.createCanvas=a,t.getGameCanvas=function(e=s.GAME_CANVAS_WIDTH,t=s.GAME_CANVAS_HEIGHT){return null==n&&(n=a(e,t),n.id="game"),n},t.getRenderingContext=r,t.createContext2D=o,t.getImageData=function(e){const t=o(e.width,e.height);return t.drawImage(e,0,0,e.width,e.height),t.getImageData(0,0,e.width,e.height)}},8770:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AffineTransform=void 0;class i{constructor(e=1,t=0,i=0,s=1,n=0,a=0){this.m11=e,this.m12=t,this.m21=i,this.m22=s,this.dx=n,this.dy=a}static fromDOMMatrix(e){if(!e.is2D)throw new Error("Can only create Matrix3 from 2D DOMMatrix");return new i(e.a,e.b,e.c,e.d,e.e,e.f)}clone(){return new i(this.m11,this.m12,this.m21,this.m22,this.dx,this.dy)}toDOMMatrix(){return new DOMMatrix([this.m11,this.m12,this.m21,this.m22,this.dx,this.dy])}toString(){return`[ ${this.m11}, ${this.m12}, ${this.m21}, ${this.m22}, ${this.dx}, ${this.dy} ]`}setComponents(e,t,i,s,n,a){return this.m11=e,this.m12=t,this.m21=i,this.m22=s,this.dx=n,this.dy=a,this}setMatrix(e){return this.m11=e.m11,this.m12=e.m12,this.m21=e.m21,this.m22=e.m22,this.dx=e.dx,this.dy=e.dy,this}isIdentity(){return 1===this.m11&&0===this.m12&&0===this.m21&&1===this.m22&&0===this.dx&&0===this.dy}reset(){return this.m11=1,this.m12=0,this.m21=0,this.m22=1,this.dx=0,this.dy=0,this}mul(e){const t=this.m11,i=this.m12,s=this.m21,n=this.m22,a=this.dx,r=this.dy,o=e.m11,h=e.m12,l=e.m21,d=e.m22,u=e.dx,c=e.dy;return this.m11=t*o+s*h,this.m12=i*o+n*h,this.m21=t*l+s*d,this.m22=i*l+n*d,this.dx=t*u+s*c+a,this.dy=i*u+n*c+r,this}div(e){const t=this.m11,i=this.m12,s=this.m21,n=this.m22,a=this.dx,r=this.dy,o=e.m11,h=e.m12,l=e.m21,d=e.m22,u=e.dx,c=e.dy,p=o*d-l*h,g=d/p,m=-h/p,y=-l/p,f=o/p,_=(l*c-u*d)/p,w=(u*h-o*c)/p;return this.m11=t*g+s*m,this.m12=i*g+n*m,this.m21=t*y+s*f,this.m22=i*y+n*f,this.dx=t*_+s*w+a,this.dy=i*_+n*w+r,this}getDeterminant(){return this.m11*this.m22-this.m21*this.m12}invert(){const e=this.m11,t=this.m12,i=this.m21,s=this.m22,n=this.dx,a=this.dy,r=e*s-i*t;return this.m11=s/r,this.m12=-t/r,this.m21=-i/r,this.m22=e/r,this.dx=(i*a-n*s)/r,this.dy=(n*t-e*a)/r,this}translate(e,t){return this.dx+=e*this.m11+t*this.m21,this.dy+=e*this.m12+t*this.m22,this}translateX(e){return this.dx+=e*this.m11,this.dy+=e*this.m12,this}getTranslationX(){return this.dx}translateY(e){return this.dx+=e*this.m21,this.dy+=e*this.m22,this}getTranslationY(){return this.dy}setTranslation(e,t){return this.m11=1,this.m12=0,this.m21=0,this.m22=1,this.dx=e,this.dy=t,this}static createTranslation(e,t){return(new i).setTranslation(e,t)}scale(e,t=e){return this.m11*=e,this.m12*=e,this.m21*=t,this.m22*=t,this}setScale(e,t=e){return this.m11=e,this.m12=0,this.m21=0,this.m22=t,this.dx=0,this.dy=0,this}scaleX(e){return this.m11*=e,this.m12*=e,this}getScaleX(){return Math.hypot(this.m11,this.m21)}scaleY(e){return this.m21*=e,this.m22*=e,this}getScaleY(){return Math.hypot(this.m12,this.m22)}static createScale(e,t){return(new i).setScale(e,t)}rotate(e){const t=this.m11,i=this.m12,s=this.m21,n=this.m22,a=Math.sin(e),r=Math.cos(e);return this.m11=r*t+a*s,this.m12=r*i+a*n,this.m21=r*s-a*t,this.m22=r*n-a*i,this}getRotation(){const e=this.m11,t=this.m12,i=this.m21,s=this.m22;if(0!==e||0!==i){const t=Math.acos(e/Math.hypot(e,i));return i>0?-t:t}if(0!==t||0!==s){const e=Math.acos(t/Math.hypot(t,s));return Math.PI/2+(s>0?-e:e)}return 0}setRotation(e){const t=Math.sin(e),i=Math.cos(e);return this.m11=i,this.m12=t,this.m21=-t,this.m22=i,this.dx=0,this.dy=0,this}static createRotation(e){return(new i).setRotation(e)}transformCanvas(e){return e.transform(this.m11,this.m12,this.m21,this.m22,this.dx,this.dy),this}setCanvasTransform(e){return e.setTransform(this.m11,this.m12,this.m21,this.m22,this.dx,this.dy),this}}t.AffineTransform=i},4717:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Line2=void 0;const s=i(1771);t.Line2=class{constructor(e,t){this.start=e,this.end=t,this.normal=null,this.center=null}getNormal(){return(this.normal??(this.normal=new s.Vector2)).setComponents(this.end.y-this.start.y,this.start.x-this.end.x).normalize()}getCenter(){return(this.center??(this.center=new s.Vector2)).setComponents((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}draw(e){const{start:t,end:i}=this;return e.moveTo(t.x,t.x),e.lineTo(i.x,t.y),this}drawNormal(e,t=25){const i=this.getNormal(),s=this.getCenter();return e.moveTo(s.x,s.y),e.lineTo(s.x+i.x*t,s.y+i.y*t),this}}},2789:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Polygon2=void 0;const s=i(4717),n=i(1771);t.Polygon2=class{constructor(...e){this.edges=[],this.normals=[],this.vertices=e;for(let t=0,i=e.length;t<i;++t)this.edges.push(new s.Line2(e[t],e[t+1]??e[0]))}hasVertices(){return this.vertices.length>0}addVertex(e,t=this.vertices.length){const i=new s.Line2(e,e);this.vertices.splice(t,0,e);const n=this.edges[t-1];return this.edges.splice(t,0,i),null!=n?(i.end=n.end,n.end=e):i.end=this.vertices[0],this}removeVertex(e){const t=this.edges,i=t[e];if(null!=i){const s=t[e-1]??t[t.length-1],n=t[e+1]??t[0];s!==i&&n!==i&&(n.start=i.end,s.end=i.end),this.vertices.splice(e,1),this.edges.splice(e,1)}return this}clear(){return this.vertices.length=0,this.edges.length=0,this.normals.length=0,this}getVertexNormal(e){const t=this.normals[e]?.reset()??(this.normals[e]=new n.Vector2),i=this.edges,s=i[e];if(null!=s){t.add(s.getNormal());const n=i[e-1]??i[i.length-1];null!=n&&t.add(n.getNormal())}return t.normalize()}draw(e){const t=this.vertices;if(t.length>0){const i=t[0];e.moveTo(i.x,i.y);for(let i=1,s=t.length;i<s;++i){const s=t[i];e.lineTo(s.x,s.y)}}return e.closePath(),this}drawNormals(e,t){for(const i of this.edges)i.drawNormal(e,t);return this}drawVertexNormals(e,t=25){return this.vertices.forEach(((i,s)=>{e.moveTo(i.x,i.y);const n=this.getVertexNormal(s);e.lineTo(i.x+n.x*t,i.y+n.y*t)})),this}}},1771:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Vector2=void 0;class i{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`[ ${this.x}, ${this.y} ]`}setComponents(e,t){return this.x=e,this.y=t,this}setVector(e){return this.x=e.x,this.y=e.y,this}clone(){return new i(this.x,this.y)}getSquareLength(){return this.x**2+this.y**2}getLength(){return Math.sqrt(this.getSquareLength())}getSquareDistance(e){return(this.x-e.x)**2+(this.y-e.y)**2}getDistance(e){return Math.sqrt(this.getSquareDistance(e))}dot(e){return this.x*e.x+this.y*e.y}negate(){return this.x=-this.x,this.y=-this.y,this}reset(){return this.x=this.y=0,this}translate(e,t){return this.x+=e,this.y+=t,this}add(e){return this.x+=e.x,this.y+=e.y,this}sub(e){return this.x-=e.x,this.y-=e.y,this}mul(e){const t=this.x,i=this.y;return this.x=t*e.m11+i*e.m21+e.dx,this.y=t*e.m12+i*e.m22+e.dy,this}div(e){const t=e.m11,i=e.m12,s=e.m21,n=e.m22,a=this.x,r=this.y,o=t*n-i*s,h=n/o,l=-i/o,d=-s/o,u=t/o,c=e.dx,p=e.dy;return this.x=a*h+r*d+(s*p-c*n)/o,this.y=a*l+r*u+(c*i-t*p)/o,this}normalize(){const e=this.getLength();return this.x/=e,this.y/=e,this}}t.Vector2=i},9650:(e,t,i)=>{var s,n,a,r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.GamepadControllerEvent=t.ControllerEvent=void 0;const h=i(7582),l=i(5832),d=i(7590);class u extends Object{constructor(e,t,i,o=!1){super(),s.set(this,void 0),n.set(this,void 0),a.set(this,void 0),r.set(this,void 0),h.__classPrivateFieldSet(this,s,e,"f"),h.__classPrivateFieldSet(this,n,i.reduce(((e,t)=>e|t)),"f"),h.__classPrivateFieldSet(this,a,t,"f"),h.__classPrivateFieldSet(this,r,o,"f")}get controllerFamily(){return h.__classPrivateFieldGet(this,s,"f")}get eventType(){return h.__classPrivateFieldGet(this,a,"f")}get repeat(){return h.__classPrivateFieldGet(this,r,"f")}get isMenuLeft(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.MENU_LEFT)}get isMenuRight(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.MENU_RIGHT)}get isMenuUp(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.MENU_UP)}get isMenuDown(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.MENU_DOWN)}get isPlayerMoveLeft(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.PLAYER_MOVE_LEFT)}get isPlayerMoveRight(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.PLAYER_MOVE_RIGHT)}get isPlayerJump(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.PLAYER_JUMP)}get isPlayerDrop(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.PLAYER_DROP)}get isPlayerEnterDoor(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.PLAYER_ENTER_DOOR)}get isPlayerInteract(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.PLAYER_INTERACT)}get isPlayerAction(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.PLAYER_ACTION)}get isPlayerRun(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.PLAYER_RUN)}get isPlayerDance1(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.PLAYER_DANCE_1)}get isPlayerDance2(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.PLAYER_DANCE_2)}get isPause(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.PAUSE)}get isConfirm(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.CONFIRM)}get isAbort(){return 0!=(h.__classPrivateFieldGet(this,n,"f")&d.ControllerIntent.ABORT)}}t.ControllerEvent=u,s=new WeakMap,n=new WeakMap,a=new WeakMap,r=new WeakMap,t.GamepadControllerEvent=class extends u{constructor(e,t,i,s=!1){super(l.ControllerFamily.GAMEPAD,t,i,s),o.set(this,void 0),h.__classPrivateFieldSet(this,o,e,"f")}get gamepadModel(){return h.__classPrivateFieldGet(this,o,"f")}},o=new WeakMap},5182:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ControllerEventType=void 0,function(e){e.UP="up",e.DOWN="down",e.PRESS="press"}(i||(t.ControllerEventType=i={}))},5832:(e,t)=>{var i,s,n;Object.defineProperty(t,"__esModule",{value:!0}),t.ControllerAnimationTags=t.ControllerSpriteMap=t.ControllerFamily=void 0,function(e){e.KEYBOARD="keyboard",e.GAMEPAD="gamepad"}(i||(t.ControllerFamily=i={})),function(e){e.KEYBOARD="keyboard",e.XBOX="xbox",e.PLAYSTATION="playstation",e.STADIA="stadia"}(s||(t.ControllerSpriteMap=s={})),function(e){e.CONFIRM="confirm",e.JUMP="jump",e.ACTION="action",e.INTERACT="interact",e.OPEN_DOOR="up",e.BACK="back"}(n||(t.ControllerAnimationTags=n={}))},7590:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ControllerIntent=void 0,function(e){e[e.NONE=0]="NONE",e[e.PLAYER_MOVE_LEFT=1]="PLAYER_MOVE_LEFT",e[e.PLAYER_MOVE_RIGHT=2]="PLAYER_MOVE_RIGHT",e[e.PLAYER_JUMP=4]="PLAYER_JUMP",e[e.PLAYER_DROP=8]="PLAYER_DROP",e[e.PLAYER_INTERACT=16]="PLAYER_INTERACT",e[e.PLAYER_ACTION=32]="PLAYER_ACTION",e[e.PLAYER_DANCE_1=64]="PLAYER_DANCE_1",e[e.PLAYER_DANCE_2=128]="PLAYER_DANCE_2",e[e.MENU_LEFT=256]="MENU_LEFT",e[e.MENU_RIGHT=512]="MENU_RIGHT",e[e.MENU_UP=1024]="MENU_UP",e[e.MENU_DOWN=2048]="MENU_DOWN",e[e.CONFIRM=4096]="CONFIRM",e[e.PLAYER_ENTER_DOOR=8192]="PLAYER_ENTER_DOOR",e[e.PAUSE=16384]="PAUSE",e[e.ABORT=32768]="ABORT",e[e.PLAYER_RUN=65536]="PLAYER_RUN",e[e.UNUSED_1=131072]="UNUSED_1",e[e.UNUSED_2=262144]="UNUSED_2",e[e.UNUSED_3=524288]="UNUSED_3"}(i||(t.ControllerIntent=i={}))},6038:(e,t,i)=>{var s,n,a,r,o,h;Object.defineProperty(t,"__esModule",{value:!0}),t.ControllerManager=void 0;const l=i(7582),d=i(9406),u=i(9650),c=i(5832),p=i(6667);class g{static getInstance(){return l.__classPrivateFieldGet(s,s,"f",n)}set currentGamepadStyleOverride(e){const t=this.currentGamepadStyle;l.__classPrivateFieldSet(this,r,e,"f"),this.currentGamepadStyle!==t&&this.onGamepadStyleChange.emit(this.currentGamepadStyle)}get currentGamepadStyle(){return this.autoDetectGamepadStyle?l.__classPrivateFieldGet(this,a,"f"):l.__classPrivateFieldGet(this,r,"f")}set autoDetectGamepadStyle(e){const t=this.currentGamepadStyle;l.__classPrivateFieldSet(this,o,e,"f"),this.currentGamepadStyle!==t&&this.onGamepadStyleChange.emit(this.currentGamepadStyle)}get autoDetectGamepadStyle(){return l.__classPrivateFieldGet(this,o,"f")}constructor(e=c.ControllerFamily.KEYBOARD){this.onButtonDown=new d.Signal,this.onButtonUp=new d.Signal,this.onButtonPress=new d.Signal,this.onControllerFamilyChange=new d.Signal,this.onGamepadStyleChange=new d.Signal,a.set(this,p.DEFAULT_GAMEPAD_STYLE),r.set(this,p.DEFAULT_GAMEPAD_STYLE),o.set(this,!0),h.set(this,c.ControllerFamily.KEYBOARD),this.currentControllerFamily=e,this.onButtonDown.connect((e=>{if(l.__classPrivateFieldGet(this,h,"f")!==e.controllerFamily&&(this.currentControllerFamily=e.controllerFamily),e instanceof u.GamepadControllerEvent&&l.__classPrivateFieldGet(this,a,"f")!==e.gamepadModel.style){const t=this.currentGamepadStyle;l.__classPrivateFieldSet(this,a,e.gamepadModel.style,"f"),this.currentGamepadStyle!==t&&this.onGamepadStyleChange.emit(this.currentGamepadStyle)}}))}set currentControllerFamily(e){e!==this.currentControllerFamily&&(l.__classPrivateFieldSet(this,h,e,"f"),this.onControllerFamilyChange.emit(this.currentControllerFamily))}get currentControllerFamily(){return l.__classPrivateFieldGet(this,h,"f")}toggleSelectedGamepadStyle(){if(this.autoDetectGamepadStyle)this.autoDetectGamepadStyle=!1,this.currentGamepadStyleOverride=p.GamepadStyle.XBOX;else switch(l.__classPrivateFieldGet(this,r,"f")){case p.GamepadStyle.XBOX:this.currentGamepadStyleOverride=p.GamepadStyle.PLAYSTATION;break;case p.GamepadStyle.PLAYSTATION:this.currentGamepadStyleOverride=p.GamepadStyle.STADIA;break;case p.GamepadStyle.STADIA:this.currentGamepadStyleOverride=p.GamepadStyle.XBOX,this.autoDetectGamepadStyle=!0}}get controllerSprite(){if(this.currentControllerFamily===c.ControllerFamily.GAMEPAD)switch(this.currentGamepadStyle){case p.GamepadStyle.PLAYSTATION:return c.ControllerSpriteMap.PLAYSTATION;case p.GamepadStyle.XBOX:return c.ControllerSpriteMap.XBOX;case p.GamepadStyle.STADIA:return c.ControllerSpriteMap.STADIA}return c.ControllerSpriteMap.KEYBOARD}}t.ControllerManager=g,s=g,a=new WeakMap,r=new WeakMap,o=new WeakMap,h=new WeakMap,n={value:new s}},5709:(e,t,i)=>{var s,n,a,r;Object.defineProperty(t,"__esModule",{value:!0}),t.GamepadInput=void 0;const o=i(7582),h=i(9650),l=i(5182),d=i(7590),u=i(6038),c=i(1114);var p,g;!function(e){e[e.BUTTON_1=0]="BUTTON_1",e[e.BUTTON_2=1]="BUTTON_2",e[e.BUTTON_3=2]="BUTTON_3",e[e.BUTTON_4=3]="BUTTON_4",e[e.SHOULDER_TOP_LEFT=4]="SHOULDER_TOP_LEFT",e[e.SHOULDER_TOP_RIGHT=5]="SHOULDER_TOP_RIGHT",e[e.SHOULDER_BOTTOM_LEFT=6]="SHOULDER_BOTTOM_LEFT",e[e.SHOULDER_BOTTOM_RIGHT=7]="SHOULDER_BOTTOM_RIGHT",e[e.SELECT=8]="SELECT",e[e.START=9]="START",e[e.STICK_BUTTON_LEFT=10]="STICK_BUTTON_LEFT",e[e.STICK_BUTTON_RIGHT=11]="STICK_BUTTON_RIGHT",e[e.D_PAD_UP=12]="D_PAD_UP",e[e.D_PAD_DOWN=13]="D_PAD_DOWN",e[e.D_PAD_LEFT=14]="D_PAD_LEFT",e[e.D_PAD_RIGHT=15]="D_PAD_RIGHT",e[e.VENDOR=16]="VENDOR"}(p||(p={})),function(e){e[e.LEFT_LEFT_RIGHT=0]="LEFT_LEFT_RIGHT",e[e.LEFT_UP_DOWN=1]="LEFT_UP_DOWN",e[e.RIGHT_LEFT_RIGHT=2]="RIGHT_LEFT_RIGHT",e[e.RIGHT_UP_DOWN=3]="RIGHT_UP_DOWN"}(g||(g={}));const m=new Map;m.set(g.LEFT_LEFT_RIGHT,{button1:p.D_PAD_LEFT,button2:p.D_PAD_RIGHT}),m.set(g.LEFT_UP_DOWN,{button1:p.D_PAD_UP,button2:p.D_PAD_DOWN});const y=new Map;y.set(p.D_PAD_UP,[d.ControllerIntent.PLAYER_ENTER_DOOR,d.ControllerIntent.MENU_UP]),y.set(p.D_PAD_DOWN,[d.ControllerIntent.PLAYER_DROP,d.ControllerIntent.MENU_DOWN]),y.set(p.D_PAD_LEFT,[d.ControllerIntent.PLAYER_MOVE_LEFT,d.ControllerIntent.MENU_LEFT]),y.set(p.D_PAD_RIGHT,[d.ControllerIntent.PLAYER_MOVE_RIGHT,d.ControllerIntent.MENU_RIGHT]),y.set(p.BUTTON_1,[d.ControllerIntent.PLAYER_JUMP,d.ControllerIntent.CONFIRM]),y.set(p.BUTTON_2,[d.ControllerIntent.ABORT]),y.set(p.BUTTON_3,[d.ControllerIntent.PLAYER_RUN]),y.set(p.BUTTON_4,[d.ControllerIntent.PLAYER_INTERACT]),y.set(p.SHOULDER_TOP_LEFT,[d.ControllerIntent.PLAYER_DANCE_1,d.ControllerIntent.PLAYER_ACTION]),y.set(p.SHOULDER_TOP_RIGHT,[d.ControllerIntent.PLAYER_DANCE_2,d.ControllerIntent.PLAYER_ACTION]),y.set(p.START,[d.ControllerIntent.PAUSE]);class f{constructor(e,t,i){this.index=e,this.pressed=t.pressed,this.gamepad=i}setPressed(e){const t=u.ControllerManager.getInstance(),i=this.pressed;this.pressed=e,i!==e&&(e?t.onButtonDown.emit(new h.GamepadControllerEvent(this.gamepad.gamepadModel,l.ControllerEventType.DOWN,y.get(this.index)??[d.ControllerIntent.NONE])):t.onButtonUp.emit(new h.GamepadControllerEvent(this.gamepad.gamepadModel,l.ControllerEventType.UP,y.get(this.index)??[d.ControllerIntent.NONE])))}}class _{constructor(e,t){this.threshold=.5,this.value=0,this.index=e,this.gamepad=t}setValue(e){const t=u.ControllerManager.getInstance(),i=this.value;let s;this.value=e,i<=-this.threshold&&e>-this.threshold?(s=m.get(this.index)?.button1,null!=s&&t.onButtonUp.emit(new h.GamepadControllerEvent(this.gamepad.gamepadModel,l.ControllerEventType.UP,y.get(s)??[d.ControllerIntent.NONE]))):i>-this.threshold&&e<=-this.threshold&&(s=m.get(this.index)?.button1,null!=s&&t.onButtonDown.emit(new h.GamepadControllerEvent(this.gamepad.gamepadModel,l.ControllerEventType.DOWN,y.get(s)??[d.ControllerIntent.NONE]))),i>this.threshold&&e<=this.threshold?(s=m.get(this.index)?.button2,null!=s&&t.onButtonUp.emit(new h.GamepadControllerEvent(this.gamepad.gamepadModel,l.ControllerEventType.UP,y.get(s)??[d.ControllerIntent.NONE]))):i<this.threshold&&e>=this.threshold&&(s=m.get(this.index)?.button2,null!=s&&t.onButtonDown.emit(new h.GamepadControllerEvent(this.gamepad.gamepadModel,l.ControllerEventType.DOWN,y.get(s)??[d.ControllerIntent.NONE])))}}class w{constructor(e){this.index=e.index,this.id=e.id,this.gamepadModel=c.GamepadModel.fromString(this.id),this.buttons=new Array(e.buttons.length);for(let t=0;t<this.buttons.length;t++)this.buttons[t]=new f(t,e.buttons[t],this);this.axes=new Array(e.axes.length);for(let e=0;e<this.axes.length;e++)this.axes[e]=new _(e,this)}update(){const e=navigator.getGamepads()[this.index];null!=e&&(this.buttons.forEach((t=>t.setPressed(e.buttons[t.index].pressed))),this.axes.forEach((t=>t.setValue(e.axes[t.index]))))}toString(){return`Gamepad (index: ${this.index}, id: ${this.id})`}}t.GamepadInput=class{constructor(){s.add(this),n.set(this,void 0),o.__classPrivateFieldSet(this,n,new Map,"f"),window.addEventListener("gamepadconnected",(e=>o.__classPrivateFieldGet(this,s,"m",a).call(this,e.gamepad))),window.addEventListener("gamepaddisconnected",(e=>o.__classPrivateFieldGet(this,s,"m",r).call(this,e.gamepad))),navigator.getGamepads().filter((e=>null!==e&&!o.__classPrivateFieldGet(this,n,"f").has(e.id))).forEach((e=>o.__classPrivateFieldGet(this,s,"m",a).call(this,e)))}update(){o.__classPrivateFieldGet(this,n,"f").forEach((e=>e.update()))}},n=new WeakMap,s=new WeakSet,a=function(e){null!==e&&o.__classPrivateFieldGet(this,n,"f").set(e.id,new w(e))},r=function(e){null!==e&&o.__classPrivateFieldGet(this,n,"f").delete(e.id)}},1114:(e,t,i)=>{var s,n;Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_GAMEPAD_MODEL=t.GamepadModel=void 0;const a=i(7582),r=i(6667),o=new Map;o.set(/^Cat Hive Virtual Touch Controller$/i,r.GamepadStyle.STADIA),o.set(/^.*?(xinput).*$/i,r.GamepadStyle.XBOX),o.set(/^.*(?<vendorId>045e).*$/i,r.GamepadStyle.XBOX),o.set(/^.*(?<vendorId>28de).*$/i,r.GamepadStyle.XBOX),o.set(/^.*?(stadia\ controller).*$/i,r.GamepadStyle.STADIA),o.set(/^.*?(playstation).*$/i,r.GamepadStyle.PLAYSTATION),o.set(/^.*(?<vendorId>054c).*$/i,r.GamepadStyle.PLAYSTATION),o.set(/snes/i,r.GamepadStyle.SNES),o.set(/^.*vendor:\s*?(?<vendorId>0810)\s*product:\s*?(?<groupId>e501)/i,r.GamepadStyle.SNES);const h=/^.*?vendor:?\s*(?<vendorId>.{4}).*?product:?\s*(?<productId>.{4}).*$/i;class l{constructor(e,t,i){this.style=e,s.set(this,void 0),n.set(this,void 0),a.__classPrivateFieldSet(this,s,t,"f"),a.__classPrivateFieldSet(this,n,i,"f")}get vendorId(){return a.__classPrivateFieldGet(this,s,"f")}get productId(){return a.__classPrivateFieldGet(this,n,"f")}static fromString(e){for(const[t,i]of o)if(t.exec(e)){const t=h.exec(e);let s,n;return null!==t&&(s=t.groups?.vendorId,n=t.groups?.productId),new l(i,parseInt(s??"-1",16),parseInt(n??"-1"))}return t.DEFAULT_GAMEPAD_MODEL}}t.GamepadModel=l,s=new WeakMap,n=new WeakMap,t.DEFAULT_GAMEPAD_MODEL=new l(r.GamepadStyle.UNKNOWN)},6667:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_GAMEPAD_STYLE=t.GamepadStyle=void 0,function(e){e.UNKNOWN="unknown",e.XBOX="xbox",e.PLAYSTATION="playstation",e.STADIA="stadia",e.SNES="snes"}(i||(t.GamepadStyle=i={})),t.DEFAULT_GAMEPAD_STYLE=i.XBOX},8738:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Keyboard=void 0;const s=i(9406),n=i(9650),a=i(5182),r=i(5832),o=i(7590),h=i(6038),l=["ArrowUp","ArrowDown","ArrowRight","ArrowLeft","Space"],d=new Map;d.set("Space",[o.ControllerIntent.PLAYER_JUMP]),d.set("KeyW",[o.ControllerIntent.PLAYER_ENTER_DOOR,o.ControllerIntent.MENU_UP]),d.set("KeyA",[o.ControllerIntent.PLAYER_MOVE_LEFT,o.ControllerIntent.MENU_LEFT]),d.set("KeyS",[o.ControllerIntent.PLAYER_DROP,o.ControllerIntent.MENU_DOWN]),d.set("KeyD",[o.ControllerIntent.PLAYER_MOVE_RIGHT,o.ControllerIntent.MENU_RIGHT]),d.set("ArrowUp",[o.ControllerIntent.PLAYER_ENTER_DOOR,o.ControllerIntent.MENU_UP]),d.set("ArrowDown",[o.ControllerIntent.PLAYER_DROP,o.ControllerIntent.MENU_DOWN]),d.set("ArrowLeft",[o.ControllerIntent.PLAYER_MOVE_LEFT,o.ControllerIntent.MENU_LEFT]),d.set("ArrowRight",[o.ControllerIntent.PLAYER_MOVE_RIGHT,o.ControllerIntent.MENU_RIGHT]),d.set("Enter",[o.ControllerIntent.PLAYER_INTERACT,o.ControllerIntent.CONFIRM]),d.set("NumpadEnter",[o.ControllerIntent.PLAYER_INTERACT,o.ControllerIntent.CONFIRM]),d.set("Escape",[o.ControllerIntent.ABORT,o.ControllerIntent.PAUSE]),d.set("ShiftLeft",[o.ControllerIntent.PLAYER_RUN]),d.set("ShiftRight",[o.ControllerIntent.PLAYER_RUN]),d.set("KeyE",[o.ControllerIntent.PLAYER_INTERACT,o.ControllerIntent.CONFIRM]),d.set("KeyF",[o.ControllerIntent.PLAYER_ACTION]),d.set("Digit1",[o.ControllerIntent.PLAYER_DANCE_1]),d.set("Digit2",[o.ControllerIntent.PLAYER_DANCE_2]),d.set("Numpad1",[o.ControllerIntent.PLAYER_DANCE_1]),d.set("Numpad2",[o.ControllerIntent.PLAYER_DANCE_2]),t.Keyboard=class{constructor(){this.onKeyDown=new s.Signal,this.onKeyUp=new s.Signal,this.onKeyPress=new s.Signal,this.pressed=new Set,this.controllerManager=h.ControllerManager.getInstance(),document.addEventListener("keypress",(e=>this.handleKeyPress(e))),document.addEventListener("keydown",(e=>this.handleKeyDown(e))),document.addEventListener("keyup",(e=>this.handleKeyUp(e)))}handleKeyPress(e){this.onKeyPress.emit(e),e.altKey||e.ctrlKey||e.metaKey||this.controllerManager.onButtonPress.emit(new n.ControllerEvent(r.ControllerFamily.KEYBOARD,a.ControllerEventType.PRESS,d.get(e.code)??[o.ControllerIntent.NONE],e.repeat))}handleKeyDown(e){l.includes(e.code)&&e.preventDefault(),e.repeat||this.pressed.add(e.key),this.onKeyDown.emit(e),e.altKey||e.ctrlKey||e.metaKey||this.controllerManager.onButtonDown.emit(new n.ControllerEvent(r.ControllerFamily.KEYBOARD,a.ControllerEventType.DOWN,d.get(e.code)??[o.ControllerIntent.NONE],e.repeat))}handleKeyUp(e){e.repeat||this.pressed.delete(e.key),this.onKeyUp.emit(e),e.altKey||e.ctrlKey||e.metaKey||this.controllerManager.onButtonUp.emit(new n.ControllerEvent(r.ControllerFamily.KEYBOARD,a.ControllerEventType.UP,d.get(e.code)??[o.ControllerIntent.NONE],e.repeat))}isPressed(e){return this.pressed.has(e)}}},6673:(e,t,i)=>{var s,n,a;Object.defineProperty(t,"__esModule",{value:!0}),t.Preferences=void 0;const r=i(7582),o=i(915);class h{static getInstance(){return r.__classPrivateFieldGet(s,s,"f",n)}constructor(){a.set(this,void 0),r.__classPrivateFieldSet(this,a,new o.AudioPreferencesStore,"f")}get audio(){return r.__classPrivateFieldGet(this,a,"f")}}t.Preferences=h,s=h,a=new WeakMap,n={value:new s}},9862:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AsepriteNode=void 0;const s=i(1772);class n extends s.SceneNode{constructor({aseprite:e,...t}){super({width:e.width,height:e.height,...t}),this.time=0,this.aseprite=e,this.tag=t.tag??null}getAseprite(){return this.aseprite}setAseprite(e){return e!==this.aseprite&&(this.aseprite=e,this.resizeTo(e.width,e.height),this.invalidate()),this}getTag(){return this.tag}setTag(e){return e!==this.tag&&(this.tag=e,this.invalidate()),this}update(e){this.time+=e}draw(e){null!=this.tag?this.aseprite.drawTag(e,this.tag,0,0,1e3*this.time):this.aseprite.draw(e,0,0,1e3*this.time)}}t.AsepriteNode=n},2174:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ControlTooltipNode=void 0;const s=i(7582),n=i(4488),a=i(5943),r=i(8585),o=i(9241),h=i(5832),l=i(6038),d=i(9862),u=i(1772),c=i(5955);class p extends u.SceneNode{constructor({control:e,label:t,...i}){super({childAnchor:o.Direction.LEFT,...i}),this.controllerSpriteMapRecords={[h.ControllerSpriteMap.KEYBOARD]:p.buttons[0],[h.ControllerSpriteMap.XBOX]:p.buttons[1],[h.ControllerSpriteMap.PLAYSTATION]:p.buttons[2],[h.ControllerSpriteMap.STADIA]:p.buttons[3]},this.controllerManager=l.ControllerManager.getInstance(),this.gap=6,this.icon=new d.AsepriteNode({aseprite:this.controllerSpriteMapRecords[this.controllerManager.controllerSprite],tag:e,anchor:o.Direction.LEFT}).appendTo(this),this.label=new c.TextNode({font:p.font,anchor:o.Direction.LEFT,text:t,color:"white",outlineColor:"black",y:-1}).appendTo(this),this.updateLayout()}activate(){this.controllerManager.onControllerFamilyChange.connect(this.updateControllerData,this),this.controllerManager.onGamepadStyleChange.connect(this.updateControllerData,this)}deactivate(){this.controllerManager.onGamepadStyleChange.disconnect(this.updateControllerData,this),this.controllerManager.onControllerFamilyChange.disconnect(this.updateControllerData,this)}updateControllerData(){this.icon.setAseprite(this.controllerSpriteMapRecords[this.controllerManager.controllerSprite]),this.updateLayout()}updateLayout(){const e=this.icon.getWidth();this.label.setX(e+this.gap),this.resizeTo(e+this.gap+this.label.getWidth(),Math.max(this.icon.getHeight(),this.label.getHeight()))}}t.ControlTooltipNode=p,s.__decorate([(0,a.asset)(n.DIALOG_FONT),s.__metadata("design:type",r.BitmapFont)],p,"font",void 0),s.__decorate([(0,a.asset)(["sprites/buttons_keyboard.aseprite.json","sprites/buttons_xbox.aseprite.json","sprites/buttons_playstation.aseprite.json","sprites/buttons_stadia.aseprite.json"]),s.__metadata("design:type",Array)],p,"buttons",void 0)},6547:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImageNode=void 0;const s=i(1772);class n extends s.SceneNode{constructor({image:e,...t}){super({width:e.width,height:e.height,...t}),this.image=e}getImage(){return this.image}draw(e){e.drawImage(this.image,0,0)}}t.ImageNode=n},2699:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressBarNode=void 0;const s=i(6070),n=i(1772);class a extends n.SceneNode{constructor({backgroundStyle:e="#111",borderStyle:t="#222",progressStyle:i="#888",...s}={}){super({width:200,height:8,...s}),this.progress=0,this.backgroundStyle=e,this.borderStyle=t,this.progressStyle=i}setProgress(e){return(e=(0,s.clamp)(e,0,1))!==this.progress&&(this.progress=e,this.invalidate()),this}getProgress(){return this.progress}draw(e){e.save();const t=this.getWidth(),i=this.getHeight();e.fillStyle=this.backgroundStyle,e.fillRect(0,0,t,i),e.fillStyle=this.progressStyle,e.fillRect(0,0,t*this.progress,i),e.save(),e.strokeStyle=this.borderStyle,e.lineWidth=2,e.rect(0,0,t,i),e.clip(),e.stroke(),e.restore(),e.restore()}}t.ProgressBarNode=a},4237:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RootNode=void 0;const s=i(9241),n=i(1772);class a extends n.SceneNode{constructor(e,t){super({anchor:s.Direction.TOP_LEFT,childAnchor:s.Direction.TOP_LEFT}),this.scene=e,t(this.updateAll.bind(this),this.drawAll.bind(this))}}t.RootNode=a},1772:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneNode=t.PostDrawHints=void 0;const s=i(9241),n=i(8770),a=i(2789),r=i(1771),o=i(9760);var h;!function(e){e[e.CONTINUE_DRAWING=1]="CONTINUE_DRAWING"}(h||(t.PostDrawHints=h={})),t.SceneNode=class{constructor({id:e=null,x:t=0,y:i=0,width:r=0,height:o=0,anchor:h=s.Direction.CENTER,childAnchor:l=s.Direction.CENTER,opacity:d=1,layer:u=0}={}){this.parent=null,this.nextSibling=null,this.previousSibling=null,this.firstChild=null,this.lastChild=null,this.scene=null,this.boundsPolygon=new a.Polygon2,this.transformation=new n.AffineTransform,this.sceneTransformation=new n.AffineTransform,this.animations=[],this.id=e,this.x=t,this.y=i,this.width=r,this.height=o,this.opacity=d,this.anchor=h,this.childAnchor=l,this.layer=1<<u}getId(){return this.id}setId(e){return this.id=e,this}getX(){return this.x}setX(e){return e!==this.x&&(this.x=e,this.invalidate()),this}getY(){return this.y}setY(e){return e!==this.y&&(this.y=e,this.invalidate()),this}moveBy(e,t){return 0===e&&0===t||(this.x+=e,this.y+=t,this.invalidate()),this}moveTo(e,t){return e===this.x&&t===this.y||(this.x=e,this.y=t,this.invalidate()),this}getWidth(){return this.width}setWidth(e){return e!==this.width&&(this.width=e,this.invalidate(),this.invalidateBounds()),this}getHeight(){return this.height}setHeight(e){return e!==this.height&&(this.height=e,this.invalidate(),this.invalidateBounds()),this}resizeTo(e,t){return e===this.width&&t===this.height||(this.width=e,this.height=t,this.invalidate(),this.invalidateBounds()),this}getOpacity(){return this.opacity}setOpacity(e){return(e=Math.max(0,e))!==this.opacity&&(this.opacity=e,this.invalidate()),this}getEffectiveOpacity(){return this.opacity===1/0?1:Math.max(0,Math.min(1,(this.parent?.getEffectiveOpacity()??1)*this.opacity))}getAnchor(){return this.anchor}setAnchor(e){return e!==this.anchor&&(this.anchor=e,this.invalidate()),this}getChildAnchor(){return this.childAnchor}setChildAnchor(e){return e!==this.childAnchor&&(this.childAnchor=e,this.invalidate()),this}getTransformation(){return this.transformation}transform(e){return e(this.transformation),this.invalidate()}getScene(){return this.scene}setScene(e){e!==this.scene&&(this.scene&&this.deactivate(),this.scene=e,e&&this.activate(),this.forEachChild((t=>t.setScene(e))))}activate(){}deactivate(){}getParent(){return this.parent}getNextSibling(){return this.nextSibling}getPreviousSibling(){return this.previousSibling}getFirstChild(){return this.firstChild}getLastChild(){return this.lastChild}hasChildNodes(){return null!=this.firstChild}appendChild(e){if(e===this)throw new Error("Node can not be appended to itself");const t=e.parent;t&&t.removeChild(e),e.previousSibling=this.lastChild;const i=this.lastChild;return i&&(i.nextSibling=e),this.lastChild=e,this.firstChild||(this.firstChild=e),e.parent=this,e.setScene(this.scene),e.invalidate(),this.invalidate(),this}prependChild(e){return null!=this.firstChild?this.insertBefore(e,this.firstChild):this.appendChild(e)}removeChild(e){if(e.parent!==this)throw new Error("Node must be a child node");const t=e.nextSibling,i=e.previousSibling;return t&&(t.previousSibling=i),i&&(i.nextSibling=t),e===this.firstChild&&(this.firstChild=t),e===this.lastChild&&(this.lastChild=i),e.parent=null,e.nextSibling=null,e.previousSibling=null,e.setScene(null),e.invalidate(),this.invalidate(),this}remove(){return this.parent&&this.parent.removeChild(this),this}clear(){for(;this.lastChild;)this.removeChild(this.lastChild);return this}insertBefore(e,t){if(e===this)throw new Error("Node can not be inserted into itself");if(t.parent!==this)throw new Error("Reference node must be a child node");const i=e.parent;i&&i.removeChild(e);const s=t.previousSibling;return s?s.nextSibling=e:this.firstChild=e,t.previousSibling=e,e.previousSibling=s,e.nextSibling=t,e.parent=this,e.setScene(this.scene),this.invalidate()}replaceChild(e,t){if(t===this)throw new Error("newNode must not be the parent node");if(e.parent!==this)throw new Error("oldNode must be a child node");if(t===e)return this;const i=e.nextSibling;return this.removeChild(e),i?this.insertBefore(t,i):this.appendChild(t),this}replace(e){return this.parent&&this.parent.replaceChild(this,e),this}appendTo(e){return e.appendChild(this),this}prependTo(e){return e.prependChild(this),this}forEachChild(e,t=this){let i=0,s=this.firstChild;for(;s;){const n=s.nextSibling;e.call(t,s,i++),s=n}return this}forEachDescendant(e,t=this){let i=this.firstChild;for(;null!=i&&i!==this;){let s=i.firstChild;null==s&&(s=i.nextSibling),null==s&&(s=i.parent?.nextSibling??null),e.call(t,i),i=s}return this}findChild(e,t=this){let i=0,s=this.firstChild;for(;s;){const n=s.nextSibling;if(e.call(t,s,i++))return s;s=n}return null}findDescendant(e,t=this){let i=this.firstChild;for(;null!=i&&i!==this;){let s=i.firstChild;if(null==s&&(s=i.nextSibling),null==s&&(s=i.parent?.nextSibling??null),e.call(t,i))return i;i=s}return null}someChildren(e,t=this){let i=0,s=this.firstChild;for(;s;){const n=s.nextSibling;if(e.call(t,s,i++))return!0;s=n}return!1}getChildren(){const e=[];let t=this.firstChild;for(;t;)e.push(t),t=t.nextSibling;return e}getDescendantById(e){return this.findDescendant((t=>t.getId()===e))}invalidateBounds(){return this.boundsPolygon.clear(),this}updateBoundsPolygon(e){e.addVertex(new r.Vector2(0,0)),e.addVertex(new r.Vector2(this.width,0)),e.addVertex(new r.Vector2(this.width,this.height)),e.addVertex(new r.Vector2(0,this.height))}getBoundsPolygon(){return this.boundsPolygon.hasVertices()||this.updateBoundsPolygon(this.boundsPolygon),this.boundsPolygon}invalidate(){return this}animate(e){return this.animations.push(new o.SceneNodeAnimation(this,e)),this}finishAnimations(){for(const e of this.animations)e.finish();return this.forEachChild((e=>e.finishAnimations()))}hasAnimations(){return this.animations.length>0||this.someChildren((e=>e.hasAnimations()))}getLayer(){return Math.log2(this.layer)}setLayer(e){if(e<0||e>31)throw new Error(`Valid layer range is 0-31 but was ${e}`);return(e=1<<e)!==this.layer&&(this.layer=e,this.invalidate()),this}updateAnimations(e){const t=this.animations;let i=t.length,s=0;for(;s<i;)t[s].update(e)?(t.splice(s,1),i--):s++}updateAll(e){const t=this.update(e);this.updateAnimations(e);const i=this.parent;null!=i?(this.sceneTransformation.setMatrix(i.sceneTransformation),this.sceneTransformation.translate((s.Direction.getX(i.childAnchor)+1)/2*i.width,(s.Direction.getY(i.childAnchor)+1)/2*i.height)):this.sceneTransformation.reset(),this.sceneTransformation.translate(this.x,this.y),this.sceneTransformation.mul(this.transformation),this.sceneTransformation.translate(-(s.Direction.getX(this.anchor)+1)/2*this.width,-(s.Direction.getY(this.anchor)+1)/2*this.height);const n=this.updateChildren(e)|this.layer;return null!=t&&t(),n}updateChildren(e){let t=0;return this.forEachChild((i=>{t|=i.updateAll(e)})),t}update(e){}drawAll(e,t,i,n){e.save(),e.globalAlpha*=this.getEffectiveOpacity(),e.translate(this.x,this.y),this.transformation.transformCanvas(e),e.translate(-(s.Direction.getX(this.anchor)+1)/2*this.width,-(s.Direction.getY(this.anchor)+1)/2*this.height);const a=t===this.layer?this.draw(e,i,n):null;e.save(),e.translate((s.Direction.getX(this.childAnchor)+1)/2*this.width,(s.Direction.getY(this.childAnchor)+1)/2*this.height);let r=this.drawChildren(e,t,i,n);return e.restore(),null!=a&&(!0===a?r|=h.CONTINUE_DRAWING:!1!==a&&a()),e.restore(),r}drawChildren(e,t,i,s){let n=0;return this.forEachChild((a=>{n|=a.drawAll(e,t,i,s)})),n}draw(e,t,i){}}},9760:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneNodeAnimation=void 0;const s=i(8946);t.SceneNodeAnimation=class{constructor(e,{animator:t,delay:i=0,duration:n=1,easing:a=s.linear}){this.elapsed=0,this.sceneNode=e,this.animator=t,this.delay=i,this.duration=n,this.easing=a,this.lifetime=i+n}update(e){if(this.elapsed+=e,this.elapsed<this.lifetime){if(this.elapsed>this.delay){const e=(this.elapsed-this.delay)/this.duration%1;this.animator(this.sceneNode,this.easing(e),this.elapsed)}return!1}return this.animator(this.sceneNode,1,this.lifetime),!0}finish(){this.elapsed=this.lifetime}}},5955:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextNode=void 0;const s=i(1772);class n extends s.SceneNode{constructor({font:e,text:t="",color:i="white",outlineColor:s=null,...n}){super(n),this.font=e,this.text=t,this.color=i,this.outlineColor=s,this.updateSize()}getText(){return this.text}setText(e){return e!==this.text&&(this.text=e,this.updateSize(),this.invalidate()),this}getFont(){return this.font}setFont(e){return e!==this.font&&(this.font=e,this.updateSize(),this.invalidate()),this}getColor(){return this.color}setColor(e){return e!==this.color&&(this.color=e,this.invalidate()),this}getOutlineColor(){return this.outlineColor}setOutlineColor(e){return e!==this.outlineColor&&(this.outlineColor=e,this.invalidate()),this}updateSize(){const e=this.font.measureText(this.text);this.resizeTo(e.width,e.height)}draw(e){null!=this.outlineColor?this.font.drawTextWithOutline(e,this.text,0,0,this.color,this.outlineColor):this.font.drawText(e,this.text,0,0,this.color)}}t.TextNode=n},3811:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.AmbientSoundId=void 0,function(e){e.STREAM="stream",e.WIND="wind"}(i||(t.AmbientSoundId=i={}))},2222:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.BgmId=void 0,function(e){e.OVERWORLD="overworld",e.INFERNO="inferno",e.CAVE="cave",e.RIDDLE="riddle",e.RADIO="radio",e.WINGS="wings",e.ECSTASY="ecstasy",e.AWAKE="awake",e.SHADOWGATE="shadowgate"}(i||(t.BgmId=i={}))},7319:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterSelectionScene=void 0;const s=i(7582),n=i(4488),a=i(5943),r=i(8585),o=i(815),h=i(8946),l=i(9241),d=i(4919),u=i(5832),c=i(2311),p=i(2346),g=i(9862),m=i(2174),y=i(6547),f=i(5955),_=i(1147),w=i(7137),v=i(4727);var b;!function(e){e.CHARACTER="character",e.VOICE="voice",e.START="start",e.START_PLUS="startPlus"}(b||(b={}));class T extends p.Scene{activate(){this.input.onButtonDown.connect(this.handleButtonDown,this),this.menu.onActivated.connect(this.handleMenuAction,this)}deactivate(){this.input.onButtonDown.disconnect(this.handleButtonDown,this),this.menu.onActivated.disconnect(this.handleMenuAction,this)}async handleMenuAction(e){switch(e){case b.CHARACTER:this.game.campaign.toggleCharacterAsset(),this.updateSelection();break;case b.VOICE:this.game.campaign.toggleVoiceAsset(),this.updateSelection(),T.voices[this.game.campaign.selectedVoice].play();break;case b.START:this.game.campaign.setNewGamePlus(!1),await this.game.scenes.popScene({noTransition:!1}),v.TitleScene.music.stop(),await this.game.scenes.setScene(w.GameScene);break;case b.START_PLUS:this.game.campaign.setNewGamePlus(!0),await this.game.scenes.popScene({noTransition:!1}),v.TitleScene.music.stop(),await this.game.scenes.setScene(w.GameScene)}}async handleButtonDown(e){e.isAbort?await this.scenes.popScene():e.isConfirm?this.menu.executeAction():e.isMenuUp?this.menu.prev():e.isMenuDown&&this.menu.next()}updateSelection(){this.game.campaign.selectedCharacter===o.CharacterAsset.MALE?(this.variant1.setColor("grey").setOutlineColor(null),this.variant2.setColor("white").setOutlineColor("black")):(this.variant1.setColor("white").setOutlineColor("black"),this.variant2.setColor("grey").setOutlineColor(null)),this.game.campaign.selectedVoice===o.VoiceAsset.MALE?(this.voice1.setColor("grey").setOutlineColor(null),this.voice2.setColor("white").setOutlineColor("black")):(this.voice1.setColor("white").setOutlineColor("black"),this.voice2.setColor("grey").setOutlineColor(null)),this.character.setAseprite(T.playerSprites[this.game.campaign.selectedCharacter])}setup(){this.setBackgroundStyle("rgba(0, 0, 0, 0.8)"),this.zIndex=2,this.inTransition=new _.SlideTransition({duration:.5,direction:"top",easing:h.easeOutCubic}),this.outTransition=new _.SlideTransition({duration:.25});const e=this.game.campaign.selectedCharacter,t=new y.ImageNode({image:T.panelImage,childAnchor:l.Direction.TOP_LEFT,x:this.game.width>>1,y:(this.game.height>>1)-16}).appendChild(new f.TextNode({font:T.headlineFont,text:"CHARACTER CUSTOMIZATION",anchor:l.Direction.BOTTOM_LEFT,y:-5,color:"white"})).appendChild(this.variant1=new f.TextNode({font:T.font,text:"Variant 1",anchor:l.Direction.TOP_LEFT,x:24,y:32,color:"grey"})).appendChild(this.variant2=new f.TextNode({font:T.font,text:"Variant 2",anchor:l.Direction.TOP_LEFT,x:79,y:32,color:"grey"})).appendChild(this.voice1=new f.TextNode({font:T.font,text:"High Pitch",anchor:l.Direction.TOP_LEFT,x:24,y:62,color:"grey"})).appendChild(this.voice2=new f.TextNode({font:T.font,text:"Low Pitch",anchor:l.Direction.TOP_LEFT,x:79,y:62,color:"grey"})).appendChild(this.character=new g.AsepriteNode({aseprite:T.playerSprites[e],tag:"idle",anchor:l.Direction.TOP_LEFT,x:213,y:46})).appendChild(new m.ControlTooltipNode({control:u.ControllerAnimationTags.CONFIRM,label:"Select or Change",anchor:l.Direction.TOP_LEFT,y:T.panelImage.height+2})).appendChild(new m.ControlTooltipNode({control:u.ControllerAnimationTags.BACK,label:"Back",anchor:l.Direction.TOP_LEFT,y:T.panelImage.height+18})).appendTo(this.rootNode);this.menu=(new c.MenuList).setItems(new c.MenuItem(b.CHARACTER,"Character:",T.font,"black",12,20),new c.MenuItem(b.VOICE,"Voice:",T.font,"black",12,50),new c.MenuItem(b.START,"Start New Game",T.font,"black",12,124-(d.GlobalState.getHasBeatenGame()?12:0))),d.GlobalState.getHasBeatenGame()&&this.menu.addItems(new c.MenuItem(b.START_PLUS,"Start New Game +",T.font,"black",12,124)),this.menu.appendTo(t),this.updateSelection()}cleanup(){this.rootNode.clear()}}t.CharacterSelectionScene=T,s.__decorate([(0,a.asset)(n.DIALOG_FONT),s.__metadata("design:type",r.BitmapFont)],T,"font",void 0),s.__decorate([(0,a.asset)("fonts/credits.font.json"),s.__metadata("design:type",r.BitmapFont)],T,"headlineFont",void 0),s.__decorate([(0,a.asset)(["sprites/pc/female.aseprite.json","sprites/pc/male.aseprite.json"]),s.__metadata("design:type",Array)],T,"playerSprites",void 0),s.__decorate([(0,a.asset)(["sounds/jumping/jumping_female.mp3","sounds/jumping/jumping.mp3"]),s.__metadata("design:type",Array)],T,"voices",void 0),s.__decorate([(0,a.asset)("images/panel.png"),s.__metadata("design:type",HTMLImageElement)],T,"panelImage",void 0)},445:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ControlsScene=void 0;const s=i(7582),n=i(4488),a=i(9797),r=i(5943),o=i(8585),h=i(8946),l=i(9241),d=i(5832),u=i(6038),c=i(2346),p=i(9862),g=i(2174),m=i(6547),y=i(5955),f=i(1147);class _ extends c.Scene{constructor(){super(...arguments),this.controls=["Walk","Jump","Interact","Run","Throw","Enter doors","Pause"]}get urlFragment(){return"#controls"}setup(){this.setBackgroundStyle("rgba(0, 0, 0, 0.8)"),this.zIndex=2,this.inTransition=new f.SlideTransition({duration:.5,direction:"top",easing:h.easeOutCubic}),this.outTransition=new f.SlideTransition({duration:.25});const e=u.ControllerManager.getInstance(),t=e.currentGamepadStyle;this.gamepadSelection=new p.AsepriteNode({aseprite:_.gamepadSelection,tag:e.autoDetectGamepadStyle?"autodetect":e.currentGamepadStyle,anchor:l.Direction.TOP_LEFT,x:204,y:2}),this.gamepadControls=new p.AsepriteNode({aseprite:_.gamepadControls,tag:t,anchor:l.Direction.TOP_LEFT,x:206,y:35});const i=new m.ImageNode({image:_.panelImage,x:this.game.width/2,y:this.game.height/2-16,childAnchor:l.Direction.TOP_LEFT}).appendChild(this.gamepadSelection).appendChild(new m.ImageNode({image:_.keyboardKeys,anchor:l.Direction.TOP_LEFT,x:123,y:35})).appendChild(this.gamepadControls).appendChild(new g.ControlTooltipNode({label:"Toggle Gamepad Button Prompts",control:d.ControllerAnimationTags.ACTION,anchor:l.Direction.TOP_LEFT,y:_.panelImage.height+2})).appendChild(new g.ControlTooltipNode({label:"Back",control:d.ControllerAnimationTags.BACK,anchor:l.Direction.TOP_LEFT,y:_.panelImage.height+18})).appendTo(this.rootNode);this.controls.forEach(((e,t)=>{i.appendChild(new y.TextNode({font:_.font,text:e,anchor:l.Direction.TOP_LEFT,x:10,y:35+20*t,color:"black"}))}))}cleanup(){this.rootNode.clear()}activate(){this.input.onButtonDown.connect(this.handleButtonDown,this)}deactivate(){this.input.onButtonDown.disconnect(this.handleButtonDown,this)}async handleButtonDown(e){if(e.isAbort||e.isPause)await this.scenes.popScene();else if(e.isPlayerAction){const e=u.ControllerManager.getInstance();e.toggleSelectedGamepadStyle(),this.gamepadControls.setTag(e.currentGamepadStyle),this.gamepadSelection.setTag(e.autoDetectGamepadStyle?"autodetect":e.currentGamepadStyle)}}}t.ControlsScene=_,s.__decorate([(0,r.asset)(n.DIALOG_FONT),s.__metadata("design:type",o.BitmapFont)],_,"font",void 0),s.__decorate([(0,r.asset)("images/controls.png"),s.__metadata("design:type",HTMLImageElement)],_,"panelImage",void 0),s.__decorate([(0,r.asset)("images/controls_keyboard.png"),s.__metadata("design:type",HTMLImageElement)],_,"keyboardKeys",void 0),s.__decorate([(0,r.asset)("sprites/gamepad_selection.aseprite.json"),s.__metadata("design:type",a.Aseprite)],_,"gamepadSelection",void 0),s.__decorate([(0,r.asset)("sprites/controls_gamepad.aseprite.json"),s.__metadata("design:type",a.Aseprite)],_,"gamepadControls",void 0)},3845:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreditsScene=void 0;const s=i(7582),n=i(4488),a=i(9797),r=i(5943),o=i(8585),h=i(815),l=i(8946),d=i(9241),u=i(8129),c=i(2346),p=i(9862),g=i(6547),m=i(1772),y=i(5955),f=i(963),_=i(6070),w=i(4727);class v extends c.Scene{constructor(){super(...arguments),this.starPositions=[[318,10],[288,19],[260,100],[370,91],[409,49],[446,19],[436,97],[185,93],[159,49],[322,72],[153,10],[211,20],[59,22],[17,11],[102,108]],this.lineSpacing=4,this.targetMusic=null}getCorrectBackgroundTrack(){const e=this.game.campaign.quests.find((e=>e.isFinished()));return e&&e.key===u.QuestKey.E?v.music[2]:this.game.campaign.selectedCharacter===h.CharacterAsset.FEMALE?v.music[1]:this.game.campaign.selectedCharacter===h.CharacterAsset.MALE?v.music[0]:v.music[2]}get urlFragment(){return"#credits"}setup(){const e=this.game.campaign.quests.find((e=>e.isFinished()));this.zIndex=2,this.inTransition=new f.FadeTransition({duration:.5,easing:l.easeOutCubic}),this.outTransition=new f.FadeTransition({duration:.25}),this.targetMusic=this.getCorrectBackgroundTrack(),e&&e.key===u.QuestKey.E?(new g.ImageNode({image:v.backgroundImageSpace,anchor:d.Direction.TOP_LEFT}).appendTo(this.rootNode),new p.AsepriteNode({aseprite:v.spaceship,tag:"idle",anchor:d.Direction.TOP_LEFT,x:n.GAME_CANVAS_WIDTH,y:200}).animate({animator:(e,t)=>e.setX(n.GAME_CANVAS_WIDTH+50-t*n.GAME_CANVAS_WIDTH),duration:100}).appendTo(this.rootNode),new p.AsepriteNode({aseprite:v.spaceshipsmall,tag:"idle",anchor:d.Direction.TOP_LEFT,x:n.GAME_CANVAS_WIDTH,y:185}).animate({animator:(e,t)=>e.setX(n.GAME_CANVAS_WIDTH+10-t*n.GAME_CANVAS_WIDTH),duration:200}).appendTo(this.rootNode)):(new g.ImageNode({image:v.backgroundImage,anchor:d.Direction.TOP_LEFT}).appendTo(this.rootNode),this.starPositions.forEach(((e,t)=>{new p.AsepriteNode({aseprite:v.stars[t%v.stars.length],tag:"idle",anchor:d.Direction.TOP_LEFT,x:e[0],y:e[1]}).appendTo(this.rootNode)})),new p.AsepriteNode({aseprite:v.leaf,tag:"idle",anchor:d.Direction.TOP_LEFT,x:414,y:163}).appendTo(this.rootNode)),new g.ImageNode({image:v.overlayImage,anchor:d.Direction.TOP_LEFT,opacity:.75}).appendTo(this.rootNode),this.createCreditsNode().appendTo(this.rootNode),new y.TextNode({font:v.standardFont,text:v.appInfo.gitCommitHash.substring(0,7),anchor:d.Direction.BOTTOM_RIGHT,x:this.game.width-7,y:this.game.height-4,color:"white"}).appendTo(this.rootNode)}cleanup(){this.rootNode.clear()}createCreditsNode(){const e=this.game.height+50;let t=0;const i=(new m.SceneNode).appendTo(this.rootNode).animate({animator:(i,s,n)=>{i.setY(e-1e3*n/36%(t+e))},duration:1/0}),s=20;let n=this.addTitle(i,0,s);return n=this.addParagraph(i,n,s,["Originally made as a team","effort for Ludum Dare 46","in three days by"]),n=this.addParagraph(i,n,s,["Eduard But, Nico Hlscher,","Benjamin Jung, Nils Kreutzer,","Bastian Lang, Ranjit Mevius,","Markus Over, Klaus Reimer,","and Jennifer van Veen"],50),n=this.addCredit(i,n,s,"GAME DESIGN",["Everyone"]),n=this.addCredit(i,n,s,"STORY",["Markus Over","Jennifer van Veen","Ranjit Mevius","Nils Kreutzer"]),n=this.addCredit(i,n,s,"PROGRAMMING",["Nico Hlscher","Benjamin Jung","Nils Kreutzer","Ranjit Mevius","Markus Over","Klaus Reimer","Eduard But","Matthias Wetter"]),n=this.addCredit(i,n,s,"SCRIPTING",["Markus Over","Eduard But"]),n=this.addCredit(i,n,s,"ART DIRECTION",["Eduard But"]),n=this.addCredit(i,n,s,"2D ART",["Eduard But","Nils Kreutzer","Christina Schneider","Jennifer van Veen","Matthias Wetter"]),n=this.addCredit(i,n,s,"WRITING",["Markus Over","Jennifer van Veen","Eduard But"]),n=this.addCredit(i,n,s,"LEVEL DESIGN",["Eduard But","Nils Kreutzer","Jennifer van Veen"]),n=this.addCredit(i,n,s,"DISTRIBUTION",["Benjamin Jung"]),n=this.addCredit(i,n,s,"MUSIC",["Bastian Lang","Benjamin Jung","Eduard But","Matthias Wetter"]),n=this.addCredit(i,n,s,"QA",["Jennifer van Veen","Matthias Wetter"]),n=this.addCredit(i,n,s,"SFX",["freesound.org"]),t=n,i}activate(){this.targetMusic&&(this.targetMusic.setLoop(!0),this.targetMusic.setVolume(1),this.targetMusic.play()),this.input.onButtonDown.connect(this.handleButtonDown,this)}deactivate(){this.targetMusic&&this.targetMusic.stop(),this.input.onButtonDown.disconnect(this.handleButtonDown,this)}async handleButtonDown(e){this.scenes.getPreviousScene()instanceof w.TitleScene?await this.game.scenes.popScene():await this.scenes.setScene(w.TitleScene)}addTitle(e,t,i){const s=n.APP_NAME,a=(0,_.isDev)()?"DEVELOPMENT VERSION":`Version ${v.appInfo.version}`;return t+=new y.TextNode({font:v.headlineFont,text:s,anchor:d.Direction.TOP_LEFT,x:i,y:t,color:"white"}).appendTo(e).getHeight(),t+=5,(t+=new y.TextNode({font:v.standardFont,text:a,anchor:d.Direction.TOP_LEFT,x:i,y:t,color:"white"}).appendTo(e).getHeight())+5+20}addParagraph(e,t,i,s,n=10){return s.forEach((s=>{t+=new y.TextNode({font:v.standardFont,text:s,anchor:d.Direction.TOP_LEFT,x:i,y:t,color:"white"}).appendTo(e).getHeight()})),t+n}addCredit(e,t,i,s,n){return t+=new y.TextNode({font:v.creditsFont,text:s,anchor:d.Direction.TOP_LEFT,x:i,y:t,color:"white"}).appendTo(e).getHeight(),t+=this.lineSpacing+5,n.forEach((s=>{t+=new y.TextNode({font:v.standardFont,text:s,anchor:d.Direction.TOP_LEFT,x:i,y:t,color:"white"}).appendTo(e).getHeight()})),t+40}}t.CreditsScene=v,s.__decorate([(0,r.asset)(["music/a-vision-of-fire-acoustic.ogg","music/a-vision-of-fire-orchestral.ogg","music/a-vision-of-fire.ogg"]),s.__metadata("design:type",Array)],v,"music",void 0),s.__decorate([(0,r.asset)(["sprites/stars/star1.aseprite.json","sprites/stars/star2.aseprite.json","sprites/stars/star3.aseprite.json","sprites/stars/star4.aseprite.json","sprites/stars/star5.aseprite.json"]),s.__metadata("design:type",Array)],v,"stars",void 0),s.__decorate([(0,r.asset)("sprites/credits/leaf.aseprite.json"),s.__metadata("design:type",a.Aseprite)],v,"leaf",void 0),s.__decorate([(0,r.asset)("sprites/credits/spaceship.aseprite.json"),s.__metadata("design:type",a.Aseprite)],v,"spaceship",void 0),s.__decorate([(0,r.asset)("sprites/credits/spaceshipsmall.aseprite.json"),s.__metadata("design:type",a.Aseprite)],v,"spaceshipsmall",void 0),s.__decorate([(0,r.asset)("images/credits/bg.png"),s.__metadata("design:type",HTMLImageElement)],v,"backgroundImage",void 0),s.__decorate([(0,r.asset)("images/credits/bg-space.png"),s.__metadata("design:type",HTMLImageElement)],v,"backgroundImageSpace",void 0),s.__decorate([(0,r.asset)("images/credits/overlay.png"),s.__metadata("design:type",HTMLImageElement)],v,"overlayImage",void 0),s.__decorate([(0,r.asset)("fonts/headline.font.json"),s.__metadata("design:type",o.BitmapFont)],v,"headlineFont",void 0),s.__decorate([(0,r.asset)(n.DIALOG_FONT),s.__metadata("design:type",o.BitmapFont)],v,"standardFont",void 0),s.__decorate([(0,r.asset)("fonts/credits.font.json"),s.__metadata("design:type",o.BitmapFont)],v,"creditsFont",void 0),s.__decorate([(0,r.asset)("appinfo.json"),s.__metadata("design:type",Object)],v,"appInfo",void 0)},4545:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EndScene=void 0;const s=i(7582),n=i(4488),a=i(5943),r=i(1531),o=i(8585),h=i(8946),l=i(9241),d=i(4919),u=i(5832),c=i(2346),p=i(6547),g=i(5955),m=i(3845);class y extends c.Scene{constructor(){super(...arguments),this.subtitleDelay=2,this.inputDelay=4}setup(){const e=this.game.campaign.quests.find((e=>e.isFinished()));e&&(d.GlobalState.setAchievedEnding(e.key),d.GlobalState.setHasBeatenGame()),new p.ImageNode({image:y.logo,x:this.game.width>>1,y:(this.game.height>>1)-15}).appendTo(this.rootNode),new g.TextNode({font:y.font,text:e?.title??"Unknown [E]nding",x:this.game.width>>1,y:11+(this.game.height>>1),color:"red",opacity:0}).animate({animator:(e,t)=>e.setOpacity(t),delay:this.subtitleDelay,duration:.5,easing:h.easeOutQuad}).appendTo(this.rootNode);const t=`Press any ${this.input.currentControllerFamily===u.ControllerFamily.KEYBOARD?"key":"button"} to continue.`;new g.TextNode({font:y.font,text:t,anchor:l.Direction.BOTTOM,x:this.game.width>>1,y:this.game.height-15,color:"darkgrey",opacity:0}).animate({animator:(e,t)=>e.setOpacity(t),delay:this.inputDelay,duration:.5,easing:h.easeOutQuad}).appendTo(this.rootNode)}activate(){setTimeout((()=>{y.boom.setLoop(!1),y.boom.play()}),1e3*this.subtitleDelay),setTimeout((()=>{this.input.onButtonDown.connect(this.gotoCreditsScene,this)}),1e3*this.inputDelay)}deactivate(){this.input.onButtonDown.disconnect(this.gotoCreditsScene,this)}async gotoCreditsScene(){await this.game.scenes.setScene(m.CreditsScene)}cleanup(){this.rootNode.clear()}}t.EndScene=y,s.__decorate([(0,a.asset)(n.DIALOG_FONT),s.__metadata("design:type",o.BitmapFont)],y,"font",void 0),s.__decorate([(0,a.asset)("images/ending/ff.png"),s.__metadata("design:type",HTMLImageElement)],y,"logo",void 0),s.__decorate([(0,a.asset)("sounds/ending/boom.mp3"),s.__metadata("design:type",r.Sound)],y,"boom",void 0)},9647:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.FadeDirection=void 0,function(e){e[e.FADE_IN=0]="FADE_IN",e[e.FADE_OUT=1]="FADE_OUT"}(i||(t.FadeDirection=i={}))},1193:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCollidableGameObject=void 0,t.isCollidableGameObject=function(e){return"function"==typeof e.collidesWith}},7137:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GameScene=void 0;const s=i(7582);i(7701),i(5775),i(8304),i(8881),i(9395),i(4297),i(3326),i(7577),i(567);const n=i(4488),a=i(5943),r=i(1531),o=i(3882),h=i(8585),l=i(6362),d=i(3595),u=i(1284),c=i(1387),p=i(5831),g=i(9034),m=i(2042),y=i(2170),f=i(6533),_=i(195),w=i(9095),v=i(973),b=i(7297),T=i(9021),E=i(5683),I=i(122),A=i(9690),S=i(9288),x=i(4214),O=i(1616),C=i(1809),P=i(1344),k=i(9975),M=i(2311),N=i(6820),R=i(3121),D=i(8129),L=i(225),F=i(2346),G=i(6070),B=i(8875),j=i(3811),W=i(2222),U=i(4545),H=i(9647),V=i(3894),Y=i(4727);class z extends F.Scene{constructor(){super(...arguments),this.ambientSounds={[j.AmbientSoundId.STREAM]:z.ambientStream,[j.AmbientSoundId.WIND]:z.ambientWind},this.backgroundTracks=[{active:!1,id:W.BgmId.OVERWORLD,sound:z.bgm1,baseVolume:.25},{active:!1,id:W.BgmId.CAVE,sound:z.bgmCave,baseVolume:1},{active:!1,id:W.BgmId.INFERNO,sound:z.bgm2,baseVolume:.1},{active:!1,id:W.BgmId.RIDDLE,sound:z.bgmRiddle,baseVolume:1},{active:!1,id:W.BgmId.RADIO,sound:z.bgmRadio,baseVolume:1},{active:!1,id:W.BgmId.WINGS,sound:z.bgmWings,baseVolume:.75},{active:!1,id:W.BgmId.AWAKE,sound:z.bgmAwake,baseVolume:.75},{active:!1,id:W.BgmId.ECSTASY,sound:z.bgmEcstasy,baseVolume:1},{active:!1,id:W.BgmId.SHADOWGATE,sound:z.bgmShadowgate,baseVolume:1}],this.petEndingTexts=[{label:"The sensation lacks any kind of comparison.",enter:.1},{label:"All worldly matters seem so insignificant now.",enter:.2},{label:"Reality around me begins to fade.",enter:.3},{label:"Soon, I will be swept away in ecstasy.",enter:.5},{label:"Can I muster up the strength to break free?",enter:.6},{label:"If I don't stop now, there will be no going back.",enter:.7},{label:"Is this really how it all ends?",enter:.8},{label:"I regret nothing",enter:.9},{label:"Farewell, cruel world",enter:1}],this.windowEndingTexts=[{label:"I wiped off the heavy dust layer on the glass.",enter:.1},{label:"The surface was as cold as the corpses around me.",enter:.2},{label:"It was hard to make out anything in the darkness on the other side",enter:.3},{label:"",enter:.4},{label:"My legs gave away when I realized what I was looking at.",enter:.5},{label:"Nothing can compare to the dread I felt in this moment.",enter:.6},{label:"",enter:.7},{label:"I wished I could go back to the dream I faintly remember.",enter:.8},{label:"But there was nothing but an inevitable death waiting for me",enter:.9}],this.gameTime=0,this.gameObjects=[],this.soundEmitters=[],this.pointsOfInterest=[],this.triggerObjects=[],this.boundObjects=[],this.gateObjects=[],this.paused=!1,this.particles=new R.Particles(this),this.fireFuryEndTime=0,this.apocalypse=!1,this.friendshipCutscene=!1,this.pettingCutscene=!1,this.windowCutscene=!1,this.windowCutsceneTime=0,this.pettingCutsceneTime=0,this.pettingEndingTriggered=!1,this.windowEndingTriggered=!1,this.apocalypseFactor=1,this.fireEffects=[],this.frameCounter=0,this.framesPerSecond=0,this.showBounds=!1,this.dt=0,this.fpsInterval=null,this.fadeToBlackEndTime=0,this.fadeToBlackStartTime=0,this.fadeToBlackFactor=0,this.fadeToBlackDirection=H.FadeDirection.FADE_OUT,this.renderer=new L.Renderer(this),this.mountainRiddle=new N.MountainRiddle}get urlFragment(){return"#game"}setup(){this.mapInfo=new k.MapInfo,this.soundEmitters=this.mapInfo.getSounds().map((e=>o.SoundEmitter.fromGameObjectInfo(this,e))),this.pointsOfInterest=this.mapInfo.getPointers(),this.triggerObjects=this.mapInfo.getTriggerObjects(),this.boundObjects=this.mapInfo.getBoundObjects(),this.gateObjects=this.mapInfo.getGateObjects(),this.gameTime=0,this.fadeToBlackEndTime=0,this.fadeToBlackStartTime=0,this.fadeToBlackFactor=0,this.apocalypse=!1,this.fireFuryEndTime=0,this.pettingCutscene=!1,this.pettingCutsceneTime=0,this.pettingEndingTriggered=!1,this.windowCutscene=!1,this.windowCutsceneTime=0,this.windowEndingTriggered=!1,d.Conversation.resetGlobals(),this.gameObjects=[this.world=new B.World(this),this.particles,...this.soundEmitters,...this.mapInfo.getEntities().map((e=>("player"===e.name&&(e={...e,...this.getPlayerStartingPos()}),(0,C.createEntity)(e.name,{scene:this,x:e.x,y:e.y,...e.properties}))))],this.player=this.getGameObject(v.Player),this.fire=this.getGameObject(y.Fire),this.stone=this.getGameObject(A.Stone),this.stoneDisciple=this.getGameObject(S.StoneDisciple),this.tree=this.getGameObject(x.Tree),this.flameboy=this.getGameObject(_.FlameBoy),this.wing=this.getGameObject(O.Wing),this.bird=this.getGameObject(u.Bird),this.shiba=this.getGameObject(E.Shiba),this.powerShiba=this.getGameObject(b.PowerShiba),this.shadowPresence=this.getGameObject(T.ShadowPresence),this.mimic=this.getGameObject(w.Mimic),this.caveman=this.getGameObject(p.Caveman),this.bone=this.getGameObject(c.Bone),this.exitPortal=this.getGameObject(m.ExitPortal),this.camera=new l.Camera(this,this.player),this.camera.setBounds(this.player.getCurrentMapBounds()),this.fpsInterval=window.setInterval((()=>{this.framesPerSecond=this.frameCounter,this.frameCounter=0}),1e3),this.game.campaign.begin(this),this.game.campaign.isNewGamePlus&&this.initNewGamePlusState(),this.playBackgroundTrack(W.BgmId.CAVE),d.Conversation.setGlobal("devmode",(0,G.isDev)()+""),this.loadApocalypse()}initNewGamePlusState(){this.game.campaign.runAction("talkedtofire"),this.game.campaign.runAction("gotFireQuest"),this.fire.conversation?.setState("reminder"),this.player.enableRunning(!0),this.player.enableDoubleJump(!0),this.game.campaign.runAction("talkedtotree"),this.player.enableMultiJump(!0),this.tree.spawnSeed().bury(),this.tree.conversation?.setState("reminder"),this.stone.dropInWater()}getPlayerStartingPos(){const e=this.pointsOfInterest.filter((e=>"player_spawn"===e.name)),t=e.find((e=>!0!==e.properties.newGamePlus)),i=e.find((e=>e.properties.newGamePlus));if(this.game.campaign.isNewGamePlus){if(!i)throw new Error("Missing new game plus spawn point for player");return{x:i.x,y:i.y}}if(!t)throw new Error("Missing default spawn point for player");return{x:t.x,y:t.y}}cleanup(){null!=this.fpsInterval&&window.clearInterval(this.fpsInterval)}addGameObject(e){this.gameObjects.splice(this.gameObjects.indexOf(this.player)-1,0,e)}removeGameObject(e){const t=this.gameObjects.indexOf(e);t>=0&&this.gameObjects.splice(t,1)}setGateDisabled(e,t){const i=this.gateObjects.find((t=>t.name===e));i?i.properties.disabled=t:console.error(`cannot set disabled status of gate '${e}' because it does not exist`)}getBackgroundTrack(e){return this.backgroundTracks.find((t=>t.id===e))||(console.error(`Missing background track with ID '${e}'.`),this.backgroundTracks[0])}fadeActiveBackgroundTrack(e,t=!1){this.backgroundTracks.forEach((i=>{i.active&&(t?i.sound.setVolume(i.baseVolume*(1-e)):i.sound.setVolume(i.baseVolume*e))}))}setActiveBgmTrack(e){this.backgroundTracks.forEach((e=>{e.active=!1}));const t=this.backgroundTracks.find((t=>t.id===e));t&&(t.active=!0,t.sound.isPlaying()||(t.sound.setLoop(!0),t.sound.play()))}fadeToBackgroundTrack(e){const t=this.getBackgroundTrack(e);this.muteMusic(),this.backgroundTracks.forEach((e=>{e.active=!1})),t.active=!0,t.sound.setVolume(t.baseVolume),t.sound.isPlaying()||(t.sound.setLoop(!0),t.sound.play())}playBackgroundTrack(e){const t=this.getBackgroundTrack(e);this.backgroundTracks.forEach((e=>e.sound.stop())),t.active=!0,t.sound.setVolume(t.baseVolume),t.sound.setLoop(!0),t.sound.play()}getGameObject(e){for(const t of this.gameObjects)if(t instanceof e)return t;throw new Error(`Game object of type ${e.name} not found.`)}activate(){this.input.onButtonDown.connect(this.handleButtonDown,this),this.input.onButtonDown.connect(this.player.handleButtonDown,this.player),this.input.onButtonUp.connect(this.player.handleButtonUp,this.player),this.resume()}deactivate(){this.pause(),this.input.onButtonDown.disconnect(this.handleButtonDown,this),this.input.onButtonDown.disconnect(this.player.handleButtonDown,this.player),this.input.onButtonUp.disconnect(this.player.handleButtonUp,this.player)}async handleButtonDown(e){(e.isAbort||e.isPause)&&this.player.getDance()&&(this.player.getDance()?.resetMusic(),this.player.cancelDance()),e.isPause&&await this.scenes.pushScene(V.PauseScene,Y.TitleScene)}async gameOver(){z.bgm1.stop(),z.bgm2.stop(),z.swell.setVolume(.5),z.swell.play(),await(0,G.sleep)(2e3),await this.game.scenes.setScene(U.EndScene)}isActive(){return!this.paused}update(e){this.paused&&(e=0),this.dt=e,this.gameTime+=e;for(const t of this.gameObjects)t.update(e);if(this.camera.update(e,this.gameTime),this.fadeToBlackEndTime>this.gameTime){let e=(this.gameTime-this.fadeToBlackStartTime)/(this.fadeToBlackEndTime-this.fadeToBlackStartTime);this.fadeToBlackDirection===H.FadeDirection.FADE_IN&&(e=1-e),this.fadeToBlackFactor=e}this.friendshipCutscene&&this.updateFriendshipEndingCutscene(e),this.pettingCutscene&&this.updatePettingEndingCutscene(e),this.windowCutscene&&this.updateWindowEndingCutscene(e)}draw(e,t,i){e.save(),e.translate(this.game.width/2,this.game.height/2),this.camera.applyTransform(e);for(const s of this.gameObjects)s.draw(e,t,i);if(this.particles.addEmittersToRenderingQueue(),this.addAllDebugBoundsToRenderingQueue(),this.fireFuryEndTime){this.camera.setCinematicBar(1);const t=(this.fireFuryEndTime-this.gameTime)/16,i=R.valueCurves.trapeze(.4).get(t);this.drawFade(e,i,"black")}this.apocalypse&&this.drawApocalypseOverlay(e),this.fadeToBlackFactor>0&&(this.fadeActiveBackgroundTrack(this.fadeToBlackFactor,!0),this.drawFade(e,this.fadeToBlackFactor,"black")),this.camera.addCinematicBarsToRenderer(),this.renderer.draw(e),e.restore(),(0,G.isDev)()&&z.font.drawText(e,`${this.framesPerSecond} FPS`,2,-1,"white"),this.frameCounter++}addSingleDebugBoundsToRenderingQueue(e,t){this.renderer.add({type:L.RenderingType.RECT,layer:L.RenderingLayer.DEBUG,position:{x:e.x,y:-e.y},lineColor:t,dimension:{width:e.width,height:e.height}})}addAllDebugBoundsToRenderingQueue(){if(this.showBounds){for(const e of this.gameObjects)e instanceof C.Entity&&this.addSingleDebugBoundsToRenderingQueue(e.getBounds(),"red");for(const e of this.triggerObjects){const t=(0,G.boundsFromMapObject)(e);this.addSingleDebugBoundsToRenderingQueue(t,"blue")}for(const e of this.boundObjects){const t=(0,G.boundsFromMapObject)(e);this.addSingleDebugBoundsToRenderingQueue(t,"yellow")}for(const e of this.gateObjects){const t=(0,G.boundsFromMapObject)(e);this.addSingleDebugBoundsToRenderingQueue(t,"green")}}}startApocalypseMusic(){this.playBackgroundTrack(W.BgmId.INFERNO)}startFriendshipMusic(){this.playBackgroundTrack(W.BgmId.WINGS)}muteMusic(){this.backgroundTracks.forEach((e=>e.sound.setVolume(0)))}resetMusicVolumes(){this.backgroundTracks.forEach((e=>{e.active&&e.sound.setVolume(e.baseVolume)}))}async fadeToBlack(e,t){this.fadeToBlackStartTime=this.gameTime,this.fadeToBlackEndTime=this.gameTime+e,this.fadeToBlackDirection=t,await(0,G.sleep)(1e3*e),t===H.FadeDirection.FADE_OUT?this.fadeToBlackFactor=1:this.fadeToBlackFactor=0}updateApocalypse(){this.fireEmitter.setPosition(this.player.x,this.player.y),this.fireEffects.forEach((e=>e.update())),(0,G.timedRnd)(this.dt,.8)&&this.fireEmitter.emit(),this.fire.growthTarget=Math.max(2,20-6*this.gameObjects.filter((e=>e instanceof g.Cloud&&e.isRaining())).length),this.fire.intensity<6&&(this.fire.intensity=Math.max(this.fire.intensity,4),this.apocalypseFactor=(0,G.clamp)((this.fire.intensity-4)/2,0,1),this.apocalypseFactor<=.001&&(this.apocalypseFactor=0,this.apocalypse=!1,this.fire.state=f.FireState.PUT_OUT,this.game.campaign.getQuest(D.QuestKey.A).trigger(D.QuestATrigger.BEAT_FIRE),this.game.campaign.runAction("enable",null,["fire","fire3"]),z.bgm2.stop()))}updateFriendshipEndingCutscene(e){this.camera.setCinematicBar(1)}updateWindowEndingCutscene(e){this.windowCutsceneTime+=e,!this.windowEndingTriggered&&this.windowCutsceneTime>n.WINDOW_ENDING_CUTSCENE_DURATION+n.WINDOW_ENDING_FADE_DURATION&&(this.windowEndingTriggered=!0,this.game.campaign.getQuest(D.QuestKey.E).finish(),this.gameOver()),this.windowEndingTexts.forEach(((e,t)=>{if(this.windowCutsceneTime/n.WINDOW_ENDING_CUTSCENE_DURATION>e.enter){const i=.5,s=n.WINDOW_ENDING_CUTSCENE_DURATION*e.enter,a=Math.max(0,Math.min(1,(this.windowCutsceneTime-s)/i)),r=z.font.measureText(e.label);this.renderer.add({type:L.RenderingType.TEXT,layer:L.RenderingLayer.UI,textColor:"white",relativeToScreen:!0,alpha:a,text:e.label,position:{x:n.GAME_CANVAS_WIDTH/2-r.width/2,y:r.height*t+3*t+50},asset:z.font})}}))}updatePettingEndingCutscene(e){this.pettingCutsceneTime+=e,!this.pettingEndingTriggered&&this.pettingCutsceneTime>n.PETTING_ENDING_CUTSCENE_DURATION+n.PETTING_ENDING_FADE_DURATION&&(this.pettingEndingTriggered=!0,this.game.campaign.getQuest(D.QuestKey.D).finish(),this.gameOver()),this.petEndingTexts.forEach(((e,t)=>{if(this.pettingCutsceneTime/n.PETTING_ENDING_CUTSCENE_DURATION>e.enter){const t=.5,i=n.PETTING_ENDING_CUTSCENE_DURATION*e.enter,s=-1*Math.pow((this.pettingCutsceneTime-i)/2,2),a=Math.max(0,Math.min(1,(this.pettingCutsceneTime-i)/t)),r=z.font.measureText(e.label);this.renderer.add({type:L.RenderingType.TEXT,layer:L.RenderingLayer.UI,textColor:"white",relativeToScreen:!0,alpha:a,text:e.label,position:{x:n.GAME_CANVAS_WIDTH/2-r.width/2,y:100+s},asset:z.font})}}))}drawApocalypseOverlay(e){this.updateApocalypse(),this.camera.setCinematicBar(this.apocalypseFactor),this.renderer.add({type:L.RenderingType.RECT,layer:L.RenderingLayer.FULLSCREEN_FX,position:{x:0,y:0},fillColor:"darkred",globalCompositeOperation:"color",alpha:.7*this.apocalypseFactor,relativeToScreen:!0,dimension:{width:this.game.width,height:this.game.height}})}drawFade(e,t,i="black"){this.renderer.add({type:L.RenderingType.RECT,layer:L.RenderingLayer.FULLSCREEN_FX,position:{x:0,y:0},fillColor:i,alpha:t,relativeToScreen:!0,dimension:{width:this.game.width,height:this.game.height}})}loadApocalypse(){this.fireEffects=[1,2].map((e=>new P.FireGfx(32,24,!0,2))),this.fireEmitter=this.particles.createEmitter({position:{x:this.player.x,y:this.player.y},offset:()=>({x:300*(0,G.rnd)(-1,1),y:200}),velocity:()=>({x:0,y:-25}),color:()=>(0,G.rndItem)(this.fireEffects).getImage(),size:()=>(0,G.rnd)(16,32),gravity:{x:-10,y:-30},lifetime:()=>(0,G.rnd)(5,15),alpha:1,breakFactor:.9,alphaCurve:R.valueCurves.cos(.2,.1),update:e=>{this.world.collidesWith(e.x,e.y-e.size/4)&&(e.vx=0,e.vy=0)}})}beginWindowEnding(){this.windowCutscene=!0,this.player.setControllable(!1),this.fadeToBlackDirection=H.FadeDirection.FADE_OUT,this.fadeToBlackStartTime=this.gameTime+n.WINDOW_ENDING_CUTSCENE_DURATION,this.fadeToBlackEndTime=this.fadeToBlackStartTime+n.WINDOW_ENDING_FADE_DURATION;const e=this.pointsOfInterest.find((e=>"windowzoomtarget"===e.name));e&&this.camera.focusOn(n.WINDOW_ENDING_CUTSCENE_DURATION+n.PETTING_ENDING_FADE_DURATION,e.x,this.camera.y,1,0,R.valueCurves.cubic)}beginPetEnding(){this.pettingCutscene=!0,this.player.startPettingDog(),this.shiba.startBeingPetted(),this.fadeToBlackDirection=H.FadeDirection.FADE_OUT,this.fadeToBlackStartTime=this.gameTime+n.PETTING_ENDING_CUTSCENE_DURATION,this.fadeToBlackEndTime=this.fadeToBlackStartTime+n.PETTING_ENDING_FADE_DURATION,this.playBackgroundTrack(W.BgmId.ECSTASY)}cancelPatEnding(){this.canCancelPatEnding()&&(this.pettingCutscene=!1,this.pettingCutsceneTime=0,this.player.stopPettingDog(),this.shiba.stopBeingPetted(),this.fadeToBlackEndTime=0,this.fadeToBlackStartTime=0,this.fadeToBlackFactor=0,this.playBackgroundTrack(W.BgmId.OVERWORLD))}canCancelPatEnding(){return this.pettingCutsceneTime<n.PETTING_ENDING_CUTSCENE_DURATION+n.PETTING_ENDING_FADE_DURATION}beginFriendshipEnding(){this.friendshipCutscene=!0,this.shiba.setState(I.ShibaState.ON_MOUNTAIN),this.shiba.nextState();const e=this.pointsOfInterest.find((e=>"friendship_player_position"===e.name));if(!e)throw new Error("cannot initiate friendship ending because some points of interest are missing");this.player.startAutoMove(e.x,!0),this.player.setControllable(!1)}async beginApocalypse(){this.apocalypse=!0,this.world.stopRain();const e=this.pointsOfInterest.find((e=>"boss_spawn"===e.name)),t=this.pointsOfInterest.filter((e=>"bosscloud"===e.name));if(!(e&&t.length>0))throw new Error("Cannot begin apocalypse because boss_spawn or bosscloud trigger is missing in map.");t.forEach((e=>{const t=new g.Cloud({scene:this,x:e.x,y:e.y,canRain:!0});this.gameObjects.push(t)})),this.player.x=e.x-36,this.player.y=e.y,this.player.removePowerUps(),this.player.enableRainDance(),this.fire.x=e.x,this.fire.y=e.y,this.camera.setBounds(this.player.getCurrentMapBounds()),await(0,G.sleep)(9e3),await this.player.think("This is not over",2e3),await(0,G.sleep)(1e3),await this.player.think("There's still something I can do.",4e3)}togglePause(e=!this.paused){this.paused=e}pause(){this.muteMusic(),M.MenuList.pause.stop(),M.MenuList.pause.play(),this.togglePause(!0)}resume(){this.resetMusicVolumes(),this.togglePause(!1)}setBgmVolume(e){z.bgm1.setVolume(e),z.bgm2.setVolume(e)}}t.GameScene=z,s.__decorate([(0,a.asset)("music/theme_01.ogg"),s.__metadata("design:type",r.Sound)],z,"bgm1",void 0),s.__decorate([(0,a.asset)("music/inferno.ogg"),s.__metadata("design:type",r.Sound)],z,"bgm2",void 0),s.__decorate([(0,a.asset)("music/cave.ogg"),s.__metadata("design:type",r.Sound)],z,"bgmCave",void 0),s.__decorate([(0,a.asset)("music/riddle.ogg"),s.__metadata("design:type",r.Sound)],z,"bgmRiddle",void 0),s.__decorate([(0,a.asset)("music/radio.ogg"),s.__metadata("design:type",r.Sound)],z,"bgmRadio",void 0),s.__decorate([(0,a.asset)("music/ecstasy.ogg"),s.__metadata("design:type",r.Sound)],z,"bgmEcstasy",void 0),s.__decorate([(0,a.asset)("music/wings.ogg"),s.__metadata("design:type",r.Sound)],z,"bgmWings",void 0),s.__decorate([(0,a.asset)("music/awake.ogg"),s.__metadata("design:type",r.Sound)],z,"bgmAwake",void 0),s.__decorate([(0,a.asset)("music/shadowgate.ogg"),s.__metadata("design:type",r.Sound)],z,"bgmShadowgate",void 0),s.__decorate([(0,a.asset)("sounds/ambient/stream.ogg"),s.__metadata("design:type",r.Sound)],z,"ambientStream",void 0),s.__decorate([(0,a.asset)("sounds/ambient/wind.ogg"),s.__metadata("design:type",r.Sound)],z,"ambientWind",void 0),s.__decorate([(0,a.asset)(n.DIALOG_FONT),s.__metadata("design:type",h.BitmapFont)],z,"font",void 0),s.__decorate([(0,a.asset)("sounds/ending/swell.mp3"),s.__metadata("design:type",r.Sound)],z,"swell",void 0),s.__decorate([(0,a.asset)("sounds/gate/wrong.ogg"),s.__metadata("design:type",r.Sound)],z,"wrong",void 0)},7614:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GotItemScene=t.Item=void 0;const s=i(7582),n=i(4488),a=i(5943),r=i(1531),o=i(8585),h=i(8946),l=i(9241),d=i(2346),u=i(9862),c=i(1772),p=i(5955),g=i(1147);var m;!function(e){e[e.RUNNING=0]="RUNNING",e[e.DOUBLEJUMP=1]="DOUBLEJUMP",e[e.MULTIJUMP=2]="MULTIJUMP",e[e.RAINDANCE=3]="RAINDANCE",e[e.FRIENDSHIP=4]="FRIENDSHIP"}(m||(t.Item=m={}));class y extends d.Scene{constructor(){super(...arguments),this.floatAmount=3,this.floatSpeed=4,this.titles=["Fear of the Dark","Double-Jump Boots","Flying Wings Knock-off","Dancing Dave","Eternal Friendship"],this.subtitles=[["Run and never look back","An exceptional ally","There is something in that dark corner"],["Not suitable for step dancing","An all-time classic","Still in mint condition","Even work without wearing them","Why would a tree have those?"],["Birds love it!","Feels like cheating","Free stuff is the best","M-m-m-multi-jump"],["Like tears in the rain"],["Dogs are the best!","What might this be good for?","Powered by unconditional love","Nothing can stop us!"]]}setup(e){y.sound.setVolume(.7),y.sound.play(),this.inTransition=new g.SlideTransition({duration:.5,direction:"bottom",easing:h.easeOutExpo}),this.outTransition=new g.SlideTransition({duration:.5,direction:"bottom",easing:h.easeInExpo});const t=""+this.subtitles[e][Math.floor(Math.random()*this.subtitles[e].length)]+"",i=y.itemImages[e];new p.TextNode({font:y.headlineFont,text:this.titles[e],x:this.game.width>>1,y:17+(this.game.height>>1),color:"white"}).appendTo(this.rootNode),new p.TextNode({font:y.font,text:t,color:"white",x:this.game.width>>1,y:36+(this.game.height>>1)}).appendTo(this.rootNode),new c.SceneNode({x:this.game.width>>1,y:this.game.height>>1}).animate({animator:e=>e.transform((e=>e.setScale(2).translateY(Math.sin(Date.now()/1e3*this.floatSpeed)*this.floatAmount))),duration:1/0}).appendChild(new u.AsepriteNode({aseprite:i,tag:"idle",anchor:l.Direction.BOTTOM})).appendTo(this.rootNode)}activate(){setTimeout((()=>this.scenes.popScene()),4e3)}cleanup(){this.rootNode.clear()}draw(e,t,i){e.save(),e.fillStyle="rgba(0, 0, 0, 0.5)",e.fillRect(0,(i>>1)-1,t,50),e.restore(),super.draw(e,t,i)}}t.GotItemScene=y,s.__decorate([(0,a.asset)(n.DIALOG_FONT),s.__metadata("design:type",o.BitmapFont)],y,"font",void 0),s.__decorate([(0,a.asset)("fonts/headline.font.json"),s.__metadata("design:type",o.BitmapFont)],y,"headlineFont",void 0),s.__decorate([(0,a.asset)("sounds/item/fanfare.mp3"),s.__metadata("design:type",r.Sound)],y,"sound",void 0),s.__decorate([(0,a.asset)(["sprites/powerup_running.aseprite.json","sprites/powerup_doublejump.aseprite.json","sprites/powerup_multijump.aseprite.json","sprites/powerup_raindance.aseprite.json","sprites/powerup_friendship.aseprite.json"]),s.__metadata("design:type",Array)],y,"itemImages",void 0)},6745:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingScene=void 0;const s=i(2346),n=i(2699),a=i(4727);class r extends s.Scene{setup(){this.progressBar=new n.ProgressBarNode({x:this.game.width>>1,y:this.game.height>>1}).appendTo(this.rootNode)}cleanup(){this.rootNode.clear()}activate(){this.loadAssets()}async loadAssets(){await this.game.assets.load(this.updateProgress.bind(this)),await this.game.scenes.setScene(a.TitleScene)}updateProgress(e,t){t<e?this.progressBar.setProgress(t/e):this.progressBar.remove()}}t.LoadingScene=r},1606:(e,t,i)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsScene=void 0;const n=i(7582),a=i(4488),r=i(5943),o=i(3888),h=i(4973),l=i(8585),d=i(6867),u=i(8946),c=i(9241),p=i(5832),g=i(2311),m=i(2346),y=i(2174),f=i(6547),_=i(5955),w=i(1147),v=i(6070);var b;!function(e){e.FULLSCREEN="fullscreen",e.RENDER_MODE="render-mode",e.SFX_SLIDER="sfxSlider",e.MUSIC_SLIDER="musicSlider"}(b||(b={}));class T extends m.Scene{constructor(){super(...arguments),s.set(this,void 0)}get audioManager(){return n.__classPrivateFieldGet(this,s,"f")}get urlFragment(){return"#options"}setup(){this.setBackgroundStyle("rgba(0, 0, 0, 0.8)"),this.zIndex=2,this.inTransition=new w.SlideTransition({duration:.5,direction:"top",easing:u.easeOutCubic}),this.outTransition=new w.SlideTransition({duration:.25}),n.__classPrivateFieldSet(this,s,o.AudioManager.getInstance(),"f");const e=new f.ImageNode({image:T.panelImage,x:this.game.width/2,y:this.game.height/2-16,childAnchor:c.Direction.TOP_LEFT}).appendChild(new _.TextNode({font:T.headlineFont,text:"OPTIONS",anchor:c.Direction.BOTTOM_LEFT,y:-5,color:"white"})).appendChild(new y.ControlTooltipNode({label:"Change",control:p.ControllerAnimationTags.CONFIRM,anchor:c.Direction.TOP_LEFT,y:T.panelImage.height+2})).appendChild(new y.ControlTooltipNode({label:"Back",control:p.ControllerAnimationTags.BACK,anchor:c.Direction.TOP_LEFT,y:T.panelImage.height+18})).appendTo(this.rootNode);this.menu=(new g.MenuList).setItems(new g.MenuItem(b.FULLSCREEN,"Toggle Fullscreen",T.font,"black",12,20),new g.SelectMenuItem({id:b.RENDER_MODE,label:"Render Mode",font:T.font,color:"black",x:12,y:40,enabled:!0,initialValue:this.game.displayManager.getRenderMode(),values:Object.values(d.RenderMode).filter((e=>e!==d.RenderMode.NATIVE||(0,v.isDev)())),valueLabels:{[d.RenderMode.PIXEL_IMPERFECT]:"Pixel Imperfect",[d.RenderMode.PIXEL_PERFECT]:"Pixel Perfect",[d.RenderMode.NATIVE]:"Native (Experimental)"},actionCallback:this.handleRenderModeChange,data:{displayManager:this.game.displayManager}}),new g.SliderMenuItem({id:b.SFX_SLIDER,label:"SFX Volume",font:T.font,color:"black",x:12,y:60,enabled:!0,initialValue:Math.round(100*this.audioManager.sfxGain),minValue:0,maxValue:100,increment:10,leftActionCallback:this.handleAudioSliderChange,rightActionCallback:this.handleAudioSliderChange,data:{channel:h.SoundChannel.SFX,audioManager:n.__classPrivateFieldGet(this,s,"f")}}),new g.SliderMenuItem({id:b.MUSIC_SLIDER,label:"Music Volume",font:T.font,color:"black",x:12,y:80,enabled:!0,initialValue:Math.round(100*this.audioManager.musicGain),minValue:0,maxValue:100,increment:10,leftActionCallback:this.handleAudioSliderChange,rightActionCallback:this.handleAudioSliderChange,data:{channel:h.SoundChannel.MUSIC,audioManager:n.__classPrivateFieldGet(this,s,"f")}})),this.menu.appendTo(e)}handleRenderModeChange(e,t){t.displayManager.setRenderMode(e)}handleAudioSliderChange(e,t){if(e/=100,t.channel===h.SoundChannel.MUSIC)t.audioManager.musicGain=e;else{if(t.channel!==h.SoundChannel.SFX)throw new Error(`Unknown sound channel: ${t.channel}.`);t.audioManager.sfxGain=e}}async handleMenuAction(e){e===b.FULLSCREEN&&await this.toggleFullscreen()}async toggleFullscreen(){const e=!await this.game.displayManager.isFullscreenEnabled();return await this.game.displayManager.setFullscreenEnabled(e),e}cleanup(){this.rootNode.clear()}activate(){this.input.onButtonDown.connect(this.handleButtonDown,this),this.menu.onActivated.connect(this.handleMenuAction,this)}deactivate(){this.input.onButtonDown.disconnect(this.handleButtonDown,this),this.menu.onActivated.disconnect(this.handleMenuAction,this)}async handleButtonDown(e){e.isAbort?await this.scenes.popScene():e.isConfirm?this.menu.executeAction():e.isMenuUp?this.menu.prev():e.isMenuDown?this.menu.next():e.isMenuRight?this.menu.executeRightAction():e.isMenuLeft&&this.menu.executeLeftAction()}}t.OptionsScene=T,s=new WeakMap,n.__decorate([(0,r.asset)(a.DIALOG_FONT),n.__metadata("design:type",l.BitmapFont)],T,"font",void 0),n.__decorate([(0,r.asset)("fonts/credits.font.json"),n.__metadata("design:type",l.BitmapFont)],T,"headlineFont",void 0),n.__decorate([(0,r.asset)("images/credits.png"),n.__metadata("design:type",HTMLImageElement)],T,"panelImage",void 0)},3894:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PauseScene=void 0;const s=i(7582),n=i(4488),a=i(5943),r=i(1531),o=i(8585),h=i(8946),l=i(9241),d=i(2311),u=i(2346),c=i(5955),p=i(1147),g=i(6070),m=i(445),y=i(1606),f=i(4727);var _;!function(e){e.RESUME="resume",e.CONTROLS="controls",e.OPTIONS="options",e.EXIT="exit"}(_||(_={}));class w extends u.Scene{cleanup(){this.rootNode.clear()}get urlFragment(){return"#pause"}setup(){this.setBackgroundStyle("rgba(0, 0, 0, 0.8)"),this.inTransition=new p.SlideTransition({duration:1,direction:"top",easing:h.easeOutBounce}),this.outTransition=new p.SlideTransition({duration:.25}),w.music.setLoop(!0),w.music.setVolume(.5),w.music.play(),new c.TextNode({font:w.headlineFont,text:"GAME PAUSED",color:"white",anchor:l.Direction.TOP_LEFT,x:75,y:100}).appendTo(this.rootNode),new c.TextNode({font:w.font,text:(0,g.isDev)()?"DEVELOPMENT VERSION":w.appInfo.version,color:"white",anchor:l.Direction.BOTTOM_RIGHT,x:this.game.width-7,y:this.game.height-4,opacity:.6}).appendTo(this.rootNode),this.menu=(new d.MenuList).appendTo(this.rootNode).setItems(new d.MenuItem(_.RESUME,"Resume",w.font,"white",75,130),new d.MenuItem(_.CONTROLS,"Controls",w.font,"white",75,145),new d.MenuItem(_.OPTIONS,"Options",w.font,"white",75,160),new d.MenuItem(_.EXIT,"Back to title",w.font,"white",75,175))}activate(){this.input.onButtonDown.connect(this.handleButtonDown,this),this.menu.onActivated.connect(this.handleMenuAction,this)}deactivate(){this.input.onButtonDown.disconnect(this.handleButtonDown,this),this.menu.onActivated.disconnect(this.handleMenuAction,this)}async handleMenuAction(e){switch(e){case _.RESUME:w.music.stop(),await this.scenes.popScene();break;case _.CONTROLS:await this.game.scenes.pushScene(m.ControlsScene);break;case _.OPTIONS:await this.game.scenes.pushScene(y.OptionsScene);break;case _.EXIT:w.music.stop(),await this.game.scenes.popScene({noTransition:!0}),await this.game.scenes.setScene(f.TitleScene)}}async handleButtonDown(e){e.isAbort||e.isPause?(w.music.stop(),await this.scenes.popScene()):e.isConfirm?this.menu.executeAction():e.isMenuUp?this.menu.prev():e.isMenuDown&&this.menu.next()}}t.PauseScene=w,s.__decorate([(0,a.asset)("music/pause.ogg"),s.__metadata("design:type",r.Sound)],w,"music",void 0),s.__decorate([(0,a.asset)(n.DIALOG_FONT),s.__metadata("design:type",o.BitmapFont)],w,"font",void 0),s.__decorate([(0,a.asset)("fonts/headline.font.json"),s.__metadata("design:type",o.BitmapFont)],w,"headlineFont",void 0),s.__decorate([(0,a.asset)("appinfo.json"),s.__metadata("design:type",Object)],w,"appInfo",void 0)},4727:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TitleScene=void 0;const s=i(7582),n=i(4488),a=i(9797),r=i(5943),o=i(1531),h=i(8585),l=i(8946),d=i(9241),u=i(4919),c=i(2311),p=i(8129),g=i(2346),m=i(9862),y=i(6547),f=i(1772),_=i(2753),w=i(963),v=i(6070),b=i(7319),T=i(445),E=i(3845),I=i(1606);var A;!function(e){e.START="start",e.CONTROLS="controls",e.OPTIONS="options",e.CREDITS="credits",e.EXIT="exit"}(A||(A={}));const S={[A.START]:{label:"Start Game"},[A.CONTROLS]:{label:"Controls"},[A.OPTIONS]:{label:"Options"},[A.CREDITS]:{label:"Credits"},[A.EXIT]:{label:"Exit Game",electronOnly:!0}};class x extends g.Scene{constructor(){super(...arguments),this.animationDuration=3,this.titleBasePosition={x:this.game.width/2-x.logoImage.width/2,y:60},this.titleLayer1Position={x:0,y:70},this.titleLayer2Position={x:0,y:163},this.titleLayer3Position={x:0,y:-125},this.menuBasePosition={x:this.game.width/2,y:180,gap:15}}get urlFragment(){return"#title"}cleanup(){this.rootNode.clear()}setup(){this.zIndex=1,this.inTransition=new w.FadeTransition,this.outTransition=new _.CurtainTransition({easing:l.easeInSine}),new m.AsepriteNode({id:"titleLayer3",aseprite:x.titleLayer3,tag:"idle",x:this.titleLayer3Position.x,y:this.titleLayer3Position.y,anchor:d.Direction.TOP_LEFT}).animate({animator:(e,t)=>e.setY(this.titleLayer3Position.y+100*(1-t)),duration:this.animationDuration,easing:l.easeOutQuad}).appendTo(this.rootNode),new m.AsepriteNode({id:"titleLayer2",aseprite:x.titleLayer2,tag:"idle",x:this.titleLayer2Position.x,y:this.titleLayer2Position.y,anchor:d.Direction.TOP_LEFT}).animate({animator:(e,t)=>e.setY(this.titleLayer2Position.y+200*(1-t)),duration:this.animationDuration,easing:l.easeOutQuad}).appendTo(this.rootNode),(new f.SceneNode).appendChild(new m.AsepriteNode({id:"titleIsland1",aseprite:x.titleIsland1,tag:"idle",anchor:d.Direction.TOP_LEFT,x:90,y:168})).appendChild(new m.AsepriteNode({id:"titleIsland2",aseprite:x.titleIsland2,tag:"idle",anchor:d.Direction.TOP_LEFT,x:323,y:178})).animate({animator:(e,t)=>e.setY(250*(1-t)),duration:this.animationDuration,easing:l.easeOutQuad}).appendTo(this.rootNode),new m.AsepriteNode({id:"person",aseprite:x.person,tag:"idle",x:22,y:155,anchor:d.Direction.TOP_LEFT}).animate({animator:(e,t)=>e.setY(155+330*(1-t)),duration:this.animationDuration,easing:l.easeOutQuad}).appendTo(this.rootNode),new m.AsepriteNode({id:"titleLayer1",aseprite:x.titleLayer1,tag:"idle",x:this.titleLayer1Position.x,y:this.titleLayer1Position.y,anchor:d.Direction.TOP_LEFT}).animate({animator:(e,t)=>e.setY(this.titleLayer1Position.y+300*(1-t)),duration:this.animationDuration,easing:l.easeOutQuad}).appendTo(this.rootNode),new f.SceneNode({opacity:0,x:this.titleBasePosition.x,y:this.titleBasePosition.y}).appendChild(new m.AsepriteNode({id:"flameicon",aseprite:x.flameicon,tag:"idle",anchor:d.Direction.TOP_LEFT,x:147,y:-10})).appendChild(new y.ImageNode({id:"logoImage",image:x.logoImage,anchor:d.Direction.TOP_LEFT})).animate({animator:(e,t)=>e.setY(this.titleBasePosition.y-10+150*(1-t)),duration:this.animationDuration,easing:l.easeOutQuad}).animate({animator:(e,t)=>e.setOpacity(t),delay:this.animationDuration/2,duration:this.animationDuration/2,easing:l.easeOutQuad}).appendTo(this.rootNode),this.menu=new c.MenuList({id:"menu",opacity:0,align:c.MenuAlignment.CENTER}).animate({animator:(e,t)=>e.setOpacity(t),delay:2.5,duration:.5,easing:l.easeOutQuad}).appendTo(this.rootNode),u.GlobalState.getHasBeatenGame()&&new f.SceneNode({opacity:0,x:118,y:108}).appendChild(this.addEndingCard(0,p.QuestKey.A)).appendChild(this.addEndingCard(1,p.QuestKey.B)).appendChild(this.addEndingCard(2,p.QuestKey.C)).appendChild(this.addEndingCard(3,p.QuestKey.D)).appendChild(this.addEndingCard(4,p.QuestKey.E)).animate({animator:(e,t)=>e.setOpacity(t),delay:2.5,duration:.5,easing:l.easeOutQuad}).appendTo(this.rootNode),Object.values(A).forEach(((e,t)=>{(!0!==S[e].electronOnly||(0,v.isElectron)()||null!=window.opener)&&this.menu.addItems(new c.MenuItem(e,S[e].label,x.font,"white",this.menuBasePosition.x,this.menuBasePosition.y+this.menuBasePosition.gap*t))}))}animationIsDone(){return!this.rootNode.hasAnimations()}finishAnimation(){this.rootNode.finishAnimations()}addEndingCard(e,t){let i="";switch(t){case p.QuestKey.A:i="a_";break;case p.QuestKey.B:i="b_";break;case p.QuestKey.C:i="c_";break;case p.QuestKey.D:i="d_";break;case p.QuestKey.E:i="e_"}return i+=u.GlobalState.getAchievedEndings().includes(t)?"on":"off",new m.AsepriteNode({id:`endingCard_${t}`,aseprite:x.endingCards,tag:i,anchor:d.Direction.TOP_LEFT,x:40*e+10*e,y:0})}async handleMenuAction(e){switch(e){case A.START:await this.game.scenes.pushScene(b.CharacterSelectionScene);break;case A.CONTROLS:await this.game.scenes.pushScene(T.ControlsScene);break;case A.OPTIONS:await this.game.scenes.pushScene(I.OptionsScene);break;case A.CREDITS:this.stopMusicTrack(),await this.game.scenes.pushScene(E.CreditsScene);break;case A.EXIT:window.close()}}activate(){this.input.onButtonDown.connect(this.handleButtonDown,this),this.menu.onActivated.connect(this.handleMenuAction,this),this.playMusicTrack()}deactivate(){this.input.onButtonDown.disconnect(this.handleButtonDown,this),this.menu.onActivated.disconnect(this.handleMenuAction,this)}handleButtonDown(e){this.animationIsDone()?e.isConfirm?this.menu.executeAction():e.isMenuUp?this.menu.prev():e.isMenuDown&&this.menu.next():e.isConfirm&&this.finishAnimation()}stopMusicTrack(){x.music.stop()}playMusicTrack(){x.music.setLoop(!0),x.music.setVolume(.3),x.music.play()}}t.TitleScene=x,s.__decorate([(0,r.asset)("music/cerulean-expanse.ogg"),s.__metadata("design:type",o.Sound)],x,"music",void 0),s.__decorate([(0,r.asset)("sprites/title/layer1.aseprite.json"),s.__metadata("design:type",a.Aseprite)],x,"titleLayer1",void 0),s.__decorate([(0,r.asset)("sprites/title/layer2.aseprite.json"),s.__metadata("design:type",a.Aseprite)],x,"titleLayer2",void 0),s.__decorate([(0,r.asset)("sprites/title/island1.aseprite.json"),s.__metadata("design:type",a.Aseprite)],x,"titleIsland1",void 0),s.__decorate([(0,r.asset)("sprites/title/island2.aseprite.json"),s.__metadata("design:type",a.Aseprite)],x,"titleIsland2",void 0),s.__decorate([(0,r.asset)("sprites/title/layer3.aseprite.json"),s.__metadata("design:type",a.Aseprite)],x,"titleLayer3",void 0),s.__decorate([(0,r.asset)("sprites/title/person.aseprite.json"),s.__metadata("design:type",a.Aseprite)],x,"person",void 0),s.__decorate([(0,r.asset)("images/logo.png"),s.__metadata("design:type",HTMLImageElement)],x,"logoImage",void 0),s.__decorate([(0,r.asset)("sprites/flameicon.aseprite.json"),s.__metadata("design:type",a.Aseprite)],x,"flameicon",void 0),s.__decorate([(0,r.asset)("sprites/ending_cards.aseprite.json"),s.__metadata("design:type",a.Aseprite)],x,"endingCards",void 0),s.__decorate([(0,r.asset)(n.DIALOG_FONT),s.__metadata("design:type",h.BitmapFont)],x,"font",void 0)},408:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SteamworksApi=void 0,function(e){e.getInstance=()=>window.steamworks??null}(i||(t.SteamworksApi=i={}))},2753:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CurtainTransition=void 0;const s=i(7391);class n extends s.Transition{constructor({direction:e="horizontal",...t}){super(t),this.direction=e}draw(e,t,i,s){const n=this.valueOf();"horizontal"===this.direction?(e.save(),e.translate(Math.round(-i*n/2),0),e.beginPath(),e.rect(0,0,Math.round(i/2),s),e.clip(),t(),e.restore(),e.save(),e.translate(Math.round(i*n/2),0),e.beginPath(),e.rect(Math.round(i/2),0,Math.round(i),s),e.clip(),t(),e.restore()):"vertical"===this.direction&&(e.save(),e.translate(0,Math.round(-s*n/2)),e.beginPath(),e.rect(0,0,i,Math.round(s/2)),e.clip(),t(),e.restore(),e.save(),e.translate(0,Math.round(s*n/2)),e.beginPath(),e.rect(0,Math.round(s/2),i,Math.round(s/2)),e.clip(),t(),e.restore())}}t.CurtainTransition=n},963:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FadeTransition=void 0;const s=i(7391);class n extends s.Transition{draw(e,t){e.globalAlpha=1-this.valueOf(),t()}}t.FadeTransition=n},1147:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SlideTransition=void 0;const s=i(7391);class n extends s.Transition{constructor({direction:e="top",...t}={}){super(t),this.direction=e}draw(e,t,i,s){const n=this.valueOf();"top"===this.direction?e.translate(0,-s*n):"bottom"===this.direction?e.translate(0,s*n):"left"===this.direction?e.translate(-i*n,0):"right"===this.direction&&e.translate(i*n,0),t()}}t.SlideTransition=n},6070:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.roundRect=t.normalizeDegrees=t.normalizeRadians=t.degrees=t.radians=t.calculateVolume=t.isDev=t.isElectron=t.boundsFromMapObject=t.shuffle=t.sleep=t.shiftValue=t.now=t.orientPow=t.clamp=t.timedRnd=t.rndItem=t.rndInt=t.rnd=void 0;const s=i(4488);t.rnd=function(e=1,t){return null!=t?e+Math.random()*(t-e):Math.random()*e},t.rndInt=function(e,t){return null!=t?Math.floor(e+Math.random()*(t-e)):Math.floor(Math.random()*e)},t.rndItem=function(e){return e[Math.floor(Math.random()*e.length)]},t.timedRnd=function(e,t){let i=0,s=e-Math.random()*t;for(;s>0;)i++,s-=Math.random()*t;return i},t.clamp=function(e,t,i){return e<t?t:e>i?i:e},t.orientPow=function(e,t){return e<0?-((-e)**t):e**t};const n=Date.now()-performance.now();t.now=function(){return performance.now()+n},t.shiftValue=function(e,t,i){if(e===t)return t;if(e<t){if((e+=i)>=t)return t}else if((e-=i)<=t)return t;return e},t.sleep=async function(e=0){await new Promise((t=>{setTimeout(t,e)}))},t.shuffle=function(e){for(let t=1;t<e.length;t++){const i=Math.floor(Math.random()*(t+1));if(t!==i){const s=e[t];e[t]=e[i],e[i]=s}}return e},t.boundsFromMapObject=function(e,t=0){const i=e.width+2*t,s=e.height+2*t;return{x:e.x-t,y:e.y+t,width:i,height:s}},t.isElectron=function(e=navigator.userAgent){return!!e.match(/\belectron\b/i)},t.isDev=function(){let e=!1;return"8000"===window.location.port&&(e=!0),""!==window.location.search?null!=window.location.search.substring(1).split("&").find((t=>{t.toLowerCase().startsWith("dev")&&(e=3===t.length||t.toLowerCase().endsWith("=true"))})):e},t.calculateVolume=function(e,t=1,i=1){return Math.max(0,t-e*s.METER_PER_PIXEL/(s.SOUND_INTENSITY_MULTIPLIER*i))};const a=180/Math.PI;t.radians=function(e){return e/a},t.degrees=function(e){return e*a},t.normalizeRadians=function(e){const t=2*Math.PI;return(e%t+t)%t},t.normalizeDegrees=function(e){return(e%360+360)%360},t.roundRect=function(e,t,i,s,n,a,r=!1,o=0){const h=s/2,l=t+h,d=t+s,u=i+n;return s<2*a&&(a=h),n<2*a&&(a=n/2),e.beginPath(),e.moveTo(t+a,i),r&&(e.lineTo(l-4+o,i),e.lineTo(l+o,i-4),e.lineTo(l+4+o,i)),e.arcTo(d,i,d,u,a),e.arcTo(d,u,t,u,a),r||(e.lineTo(l-4+o,u),e.lineTo(l+o,u+4),e.lineTo(l+4+o,u)),e.arcTo(t,u,t,i,a),e.arcTo(t,i,d,i,a),e.closePath(),e}},7582:(e,t,i)=>{i.r(t),i.d(t,{__addDisposableResource:()=>R,__assign:()=>a,__asyncDelegator:()=>A,__asyncGenerator:()=>I,__asyncValues:()=>S,__await:()=>E,__awaiter:()=>g,__classPrivateFieldGet:()=>k,__classPrivateFieldIn:()=>N,__classPrivateFieldSet:()=>M,__createBinding:()=>y,__decorate:()=>o,__disposeResources:()=>L,__esDecorate:()=>l,__exportStar:()=>f,__extends:()=>n,__generator:()=>m,__importDefault:()=>P,__importStar:()=>C,__makeTemplateObject:()=>x,__metadata:()=>p,__param:()=>h,__propKey:()=>u,__read:()=>w,__rest:()=>r,__runInitializers:()=>d,__setFunctionName:()=>c,__spread:()=>v,__spreadArray:()=>T,__spreadArrays:()=>b,__values:()=>_,default:()=>F});var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},s(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var a=function(){return a=Object.assign||function(e){for(var t,i=1,s=arguments.length;i<s;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a.apply(this,arguments)};function r(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}function o(e,t,i,s){var n,a=arguments.length,r=a<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(r=(a<3?n(r):a>3?n(t,i,r):n(t,i))||r);return a>3&&r&&Object.defineProperty(t,i,r),r}function h(e,t){return function(i,s){t(i,s,e)}}function l(e,t,i,s,n,a){function r(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,h=s.kind,l="getter"===h?"get":"setter"===h?"set":"value",d=!t&&e?s.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,s.name):{}),c=!1,p=i.length-1;p>=0;p--){var g={};for(var m in s)g[m]="access"===m?{}:s[m];for(var m in s.access)g.access[m]=s.access[m];g.addInitializer=function(e){if(c)throw new TypeError("Cannot add initializers after decoration has completed");a.push(r(e||null))};var y=(0,i[p])("accessor"===h?{get:u.get,set:u.set}:u[l],g);if("accessor"===h){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw new TypeError("Object expected");(o=r(y.get))&&(u.get=o),(o=r(y.set))&&(u.set=o),(o=r(y.init))&&n.unshift(o)}else(o=r(y))&&("field"===h?n.unshift(o):u[l]=o)}d&&Object.defineProperty(d,s.name,u),c=!0}function d(e,t,i){for(var s=arguments.length>2,n=0;n<t.length;n++)i=s?t[n].call(e,i):t[n].call(e);return s?i:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function c(e,t,i){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:i?"".concat(i," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function g(e,t,i,s){return new(i||(i=Promise))((function(n,a){function r(e){try{h(s.next(e))}catch(e){a(e)}}function o(e){try{h(s.throw(e))}catch(e){a(e)}}function h(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}h((s=s.apply(e,t||[])).next())}))}function m(e,t){var i,s,n,a,r={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(h){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(r=0)),r;)try{if(i=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,s=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!((n=(n=r.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){r.label=o[1];break}if(6===o[0]&&r.label<n[1]){r.label=n[1],n=o;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(o);break}n[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],s=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,h])}}}var y=Object.create?function(e,t,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,n)}:function(e,t,i,s){void 0===s&&(s=i),e[s]=t[i]};function f(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||y(t,e,i)}function _(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],s=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var s,n,a=i.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(s=a.next()).done;)r.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return r}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e}function b(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var s=Array(e),n=0;for(t=0;t<i;t++)for(var a=arguments[t],r=0,o=a.length;r<o;r++,n++)s[n]=a[r];return s}function T(e,t,i){if(i||2===arguments.length)for(var s,n=0,a=t.length;n<a;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function E(e){return this instanceof E?(this.v=e,this):new E(e)}function I(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,n=i.apply(e,t||[]),a=[];return s={},r("next"),r("throw"),r("return"),s[Symbol.asyncIterator]=function(){return this},s;function r(e){n[e]&&(s[e]=function(t){return new Promise((function(i,s){a.push([e,t,i,s])>1||o(e,t)}))})}function o(e,t){try{(i=n[e](t)).value instanceof E?Promise.resolve(i.value.v).then(h,l):d(a[0][2],i)}catch(e){d(a[0][3],e)}var i}function h(e){o("next",e)}function l(e){o("throw",e)}function d(e,t){e(t),a.shift(),a.length&&o(a[0][0],a[0][1])}}function A(e){var t,i;return t={},s("next"),s("throw",(function(e){throw e})),s("return"),t[Symbol.iterator]=function(){return this},t;function s(s,n){t[s]=e[s]?function(t){return(i=!i)?{value:E(e[s](t)),done:!1}:n?n(t):t}:n}}function S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=_(e),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(i){t[i]=e[i]&&function(t){return new Promise((function(s,n){!function(e,t,i,s){Promise.resolve(s).then((function(t){e({value:t,done:i})}),t)}(s,n,(t=e[i](t)).done,t.value)}))}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var O=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&y(t,e,i);return O(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function k(e,t,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(e):s?s.value:t.get(e)}function M(e,t,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,i):n?n.value=i:t.set(e,i),i}function N(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function R(e,t,i){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var s;if(i){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(void 0===s){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose]}if("function"!=typeof s)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:s,async:i})}else i&&e.stack.push({async:!0});return t}var D="function"==typeof SuppressedError?SuppressedError:function(e,t,i){var s=new Error(i);return s.name="SuppressedError",s.error=e,s.suppressed=t,s};function L(e){function t(t){e.error=e.hasError?new D(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function i(){for(;e.stack.length;){var s=e.stack.pop();try{var n=s.dispose&&s.dispose.call(s.value);if(s.async)return Promise.resolve(n).then(i,(function(e){return t(e),i()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const F={__extends:n,__assign:a,__rest:r,__decorate:o,__param:h,__metadata:p,__awaiter:g,__generator:m,__createBinding:y,__exportStar:f,__values:_,__read:w,__spread:v,__spreadArrays:b,__spreadArray:T,__await:E,__asyncGenerator:I,__asyncDelegator:A,__asyncValues:S,__makeTemplateObject:x,__importStar:C,__importDefault:P,__classPrivateFieldGet:k,__classPrivateFieldSet:M,__classPrivateFieldIn:N,__addDisposableResource:R,__disposeResources:L}},1466:e=>{e.exports=JSON.parse('{"entry":[" Chirp!","Who are you? @who","What are you up to? @what","[relevant]Can you help me in my quest? @quest","[not chirp]Did you just say Chirp? @chirp","You have strange flying technique. @multijump","Bye, bird. @bye"],"chirp":["Yes, I did.  Chirp. That\'s what birds say! !set chirp true @entry"],"who":["I\'m the bird around these parts. @entry"],"what":["I do bird stuff, mostly.","I fly from my nest to some bushes to find food."," Chirp.","There isn\'t any, though. !set relevant true","My adopted child might go hungry again.","You adopted a bird baby?","No.  Chirp!","It\'s something else. But it\'s still my son.","You can visit our nest on the tree in the west...","if you can fly, that is."," Chirp! @entry"],"quest":["What quest? I\'m a bird!","Whatever you\'re up to is not my concern, really."," Chirp. I\'m just doing my daily bird things. @entry"],"multijump":["I\'m not actually flying, though.","It\'s the multi-jump power-up that I got a while ago."," Chirp.","They said it was a flying ability, but it\'s not really.","But I don\'t care much. At least I don\'t have to flap my wings anymore. @entry"],"bye":["Bye, human."," Chirp! @entry !end"]}')},2377:e=>{e.exports=JSON.parse('{"entry":["Holy macaroni, another human!","[$ismale] I thought I\'d never see another dude anytime soon.","[not $ismale] I thought I\'d never see a woman ever again.","Did you stone-skip-jump your way across the river as well?","Yes! @stuck"],"stuck":["Well, then make yourself comfortable.","At least I\'m not stuck here alone anymore.","What? Can\'t we just exit the cave?","The platforms on the way up are too high","[$hasDoubleJump]But I can double jump! @doublejump","[not $hasDoubleJump]F","Game over, man!","GAME OVER! !endgameC !end"],"doublejump":["What?","How?","Why?","That\'s a long story.","I\'m at a loss of words can you help me get out?","I wouldn\'t know how.","Damn !end @end"],"end":["Please let me be I really hoped you could help me. !end @end"]}')},3123:e=>{e.exports=JSON.parse('{"entry":["Holy macaroni, another human! !set $metcaveman","[$ismale] I thought I\'d never see another dude anytime soon.","[not $ismale] I thought I\'d never see a woman ever again.","Did you stone-skip-jump your way across the river as well?","[$hasDoubleJump]No, I come here regularly. @regularly","[$hasDoubleJump]What\'s a stone-skip-jump? @skipjump","[not $hasDoubleJump]Yes! @stuck"],"stuck":["Well, then make yourself comfortable.","At least I\'m not stuck here alone anymore.","What? Can\'t we just exit the cave?","The platforms on the way up are too high","F","Game over, man!","GAME OVER! !endgameC !end"],"visitedEntry":["[$ismale]Hey pal!","[not $ismale]Greetings my lady.","Can I ask you some questions? @questions","I\'m on my way. @visitedEntry !end"],"regularly":["So there is a regular way to cross the river? !set visited","Yeah, it\'s a long story.","I couldn\'t cross the broken bridge after falling down from the sky.","I tried many times but I couldn\'t jump far enough.","Since there wasn\'t anything better to do, I found out about the skip-jump by accident and ended up on this side of the river. @skipjump"],"skipjump":["It\'s a secret jumping technique I mastered. !set visited","Just at the moment of impact, I was able to jump on the water and cross the river this way!","Just like a stone skips on water when you throw it at the right angle. Hence the name.","Patent pending.","And now I\'m stuck here @bug"],"bug":["The fire up top wasn\'t very helpful.","And after I entered the cave, I couldn\'t get back out.","The platforms are to high for me to jump up.","The power-up fire? He gave me the ability to fly. @powerup","Keep going. @strange"],"powerup":["Oh really? You can actually fly now?","He was just repeating lines and blabbing about broken sequences.","Maybe you can go talk to him?","If I have the time. Continue.","Where was I? Ah! @strange"],"strange":["But that\'s not all.","There is something very strange going on here.","What do you mean?","Don\'t you see it? The strange shrine in the clouds and the very suspicious fire people?","How did we get here in the first place?","It\'s like a feverish nightmare from which you can\'t wake up.","I conducted some experiments down here and the results are alarming. @questions"],"questions":["What do you want to know about?","How did you get here? @memories","Anything interesting about this cave? @cave","Why the open fire in the cave? @fire","Nevermind. @visitedEntry !end"],"fire":["Good question! First of all, carbon monoxide poisoning is not something that happens here.","Death in general seems to be impossible. Trust me, I tried.","But the fire itself is very interesting.","I made a lot of camp fires since I came here and they all look alike.","I mean, practically identical. And not only that, they even resemble the fire in the entrance.","Isn\'t that strange? It\'s like someone got really lazy and just made everything from the same template.","You\'re right, but the fire in the beginning looked different.","Yeah, I remember. It looked fake.","I have other questions. @questions"],"cave":["Yes! This cave is strange as well.","It\'s the only cave I\'ve seen so far that has nothing of interest in it.","Very suspicious if you ask me.","Well, you are here.","I don\'t like the tone of that","I\'m a living person and not some kind of pawn that only exists to chat with anyone who enters this cave.","As soon as I have the means to leave, I will.","We will see. I have other questions. @questions"],"memories":["My memories are very hazy, I can\'t remember anything from before my arrival here.","What about you?","No, it\'s all blank.","Thought so There\'s something sinister going on here behind the curtains.","There\'s always a lingering feeling of being watched from the shadows.","Yeah, I met that guy under the bridge. @shadows","Creepy. I got other questions. @questions"],"shadows":["What guy?","The shadow person. He taught me how to run.","You seem to have had a very different experience than I did","Apparently. I got other questions. @questions"]}')},7651:e=>{e.exports=JSON.parse('{"entry":["What?","[not met]Never seen a glowing chicken before? !set met true","[not livingDialog]Are you living here? @living","[not touchDialog]What happens when I touch you? @touch","So you\'re not the social type @social"],"social":["Exactly. !end @entry"],"touch":["Firstly, I\'ll fill up you health bar by five points. !set touchDialog true","Secondly, I\'m gonna reward you with salmonella.","So, go right ahead.","I\'m good, thanks.","[$ismale] Good boy. @entry !end","[not $ismale] Clever girl. @entry !end"],"living":["Apparently. Living the life to it\'s fullest. !set livingDialog true","I spent enough time just slaving my life away, being buried inside walls","waiting for someone to accidentally free me from my prison.","Just to be consumed for a cheap health buff.","Used and forgotten.","Woah, that\'s kinda dark.","It is. But we power-ups can live in peace here","The people tend to lack health bars, so I\'m off the wanted list.","But apparently I seem to be on the being asked stupid questions list.","I get the hint.","Good. @entry !end"]}')},1688:e=>{e.exports=JSON.parse('{"entry":["Hey, person! !talkedtofire","[$devmode]Hey!","[$devmode]I\'m a dev, show me variables example! @variableExample","I am starving, I fear to die very soon and my light will go out forever. @help !sad"],"variableExample":["This example demonstrates variables. !set exampleSeen","[exampleSeen]It\'s pretty cool!","It is not perfect yet and a little buggy, some things don\'t work yet sorry","[exampleSeen]This line is conditional, and you should see it. !set fail","[not fail]This line unfortunately is visible due to a bug, where conditions are evaluated one line too early.","Variables sometimes only take effect after another sentence has been spoken. A little weird. Hopefully fixed in future.","Variables also work with player options.","Say hello !set hello 1","Say howdy !set hello 0","","[hello=1]Hello!","[hello!=1]Howdy!","What was the other word again?","[hello=1]Howdy!","[not hello=1]Hello!","I don\'t know !set idk","","[idk]You\'re a little forgetful","[not idk]Ah, right!","Also, now setting a global variable which could be accessed from other dialogs. !set $test 42","Which can be accessed using a dollar sign.","[$test]Isn\'t that cool?","Yes!","Bye! @entry !end"],"help":["Would you help me out, kind stranger?","Oh my God, a talking fire?! @impressed","Why should I help you? @why","How can I help you? @how","I don\'t care! !angry","Oh you son of a! No, sorry, I get it. Well, maybe another time. !neutral","Just be aware this whole game is pretty pointless if you don\'t help me out @help !end"],"impressed":["Well yes, I\'m impressed too. Took me some time to get used to it. @help !amused"],"how":["[not $ismale]I really need some wood. Surely a strong and marvelous woman like you can help an old fire out.","[$ismale]I really need some wood. Surely a strong and marvelous man like you can help an old fire out.","Sounds boring. Maybe later @bye","I\'m in. @details","What do we say to the god of fire?","I don\'t know, what?","Not today!","But if you don\'t help me out, there may not be a tomorrow. @why"],"why":["Because I am the essence of life. If I die, everything dies. Do you want everything to die?","Oh, I wouldn\'t want to be responsible for that! @details","I don\'t know, do I?","Yes!","No!","OK","So you\'ll help me then?","Definitely! @details","Do I even have a choice?","Technically yes. Practically deciding against it would be a little stupid though.","Well OK then, you convinced me. @details","Why? @existence"],"existence":["Because your sole existence in this world hinges on helping to keep me alive.","That\'s why you\'re here. There\'s nothing else for you to do anyway.","Cool! I\'ll help you. @details","I\'d rather think about this in private. @bye"],"bye":["Sure, take your time. You\'ll come back eventually! @help !end"],"details":["Great! I knew I could rely on you. I know a good person when I see one!","So what exactly should I do?","It\'s easy! I just need a little firewood so I can keep burning a little longer.","I can get you some wood!","Yes, yes! But it needs to be a special kind of wood.","There\'s a good tree in the east. His wood is good. !treezoom","Go get it! !gotFireQuest","Sure thing! @reminder !end"],"reminder":["Hello again!","What do I need to do?","Bye! @reminder !end","Go east. Ask tree for wood. Bring me wood. Soon!","On my way! @reminder !end"]}')},9063:e=>{e.exports=JSON.parse('{"entry":["Oh, you did it! That\'s the real deal. !amused !talkedToFireWithWood","Good job on scalping that piece of junk.","Just take the wood and throw it into my fire, just as we agreed.","Got it.","I have second thoughts @secondthoughts","Just do it! @holdup !end"],"holdup":["What\'s the holdup? !angry","Just take the wood and throw it into me! Seriously","Got it. @holdup !end"],"secondthoughts":["You can\'t be serious. Are you numb? !angry","Take the WOOD and THROW it into ME, you understand? !angry","Don\'t make me wait!","Wow, calm down.","You calm down! Just give me the wood already! !angry @holdup !end"]}')},1347:e=>{e.exports=JSON.parse('{"entry":["Omnmnommnomm, that was good!","Hahahahaha!","I am finally complete.","What are you doing?","Whyyy?","I\'m unstoppable!","This was the last time I have to ask a filthy mortal for help!","And now I\'m going to devour the world.","And I\'ll start with you!","It is how it is","I thought we were friends!","Not so fast!","Stop right there!","What do you want to do, stop me? You got nothing on me! You\'re a human! I\'m literally fire!","[not $hasFriendship]As a cherry on top of the fiery cake, I\'m also gonna consume all of your power-ups. @noFriendship","As a cherry on top of the fiery cake, I\'m also gonna consume all of your power-ups. @friendship"],"noFriendship":["All of the useful ones, that is. You can keep that annoying dancing Dave as eternal punishment!","HAHAHAHAHA! !crazyzoom !end"],"friendship":["Wait","Didn\'t you have a flying power-up before? Where did that go?","I was really looking forward to consume it. It tastes like chicken","Oh well, doesn\'t matter.","HAHAHAHAHA! !friendshipEnding !end"]}')},7117:e=>{e.exports=JSON.parse('{"entry":["Whoops !amused","Well this is awkward.","Seriously though now I\'m in serious risk of dying. !sad","Are you happy now? Is this what you wanted?","You sacrificed our deep friendship for the brief satisfaction of putting out a fire. !bored","I\'m disappointed.","But let\'s not dwell in the past. Will you help me out of this?","Yes. @nothing","No.","I see you\'ve learned a lesson here.","Keep it alive, they said, it will be fun. And you almost paid the price.","Good for you the weather shifted. !bored","Goodbye. Maybe see you in a sequel. !endgameA !end"],"nothing":["Then you have learned nothing!!! !angry","Thank you nonetheless, very kind of you.","We\'re still coming to an end now. This game can\'t go on forever.","You\'ve made it. Good for you.","Goodbye. !endgameA !end"]}')},8001:e=>{e.exports=JSON.parse('{"entry":["I give up !bored","That was too much. Keep that dog away from me. !bored","I\'m no match for this kind of special companionship.","And now I\'m in serious risk of dying !sad","But I have learned my lesson.","I won\'t try to destroy the world anymore. This goal really isn\'t worth being put out like that. !bored","It will take a while getting the stench off of me !bored","Goodbye. Maybe see you in a sequel. !endgameB !end"]}')},2575:e=>{e.exports=JSON.parse('{"entry":["Hello humble adventurer, welcome to my","Wait, how did you get past the river? That\'s not how this works! !angry","Whoops, I\'ll be on my way.","Yeah, do that please. @visited !end"],"visited":["No no no no! Don\'t go breaking all the precious sequences! !angry","Get back to the other side and do things in the correct order.","You might be right","Hush hush! @visited !end"]}')},8364:e=>{e.exports=JSON.parse('{"entry":["Hello humble adventurer, welcome to my sacred hut, yadda yadda. What do you need?","What\'s with that attitude? @attitude","I\'m just here for some answers. @answers"],"answers":["Answers? What? Do I look like some kind of prophet to you?","The stone from the mountain told me I should come here for answers.","Ohhh, that guy. I bet he told you to throw him into the river.","The fact that he floats should tell you everything about him. He\'s a real airhead.","So, no answers? I need to get a seed to grow.","Not my problem. I\'m only here to give away power-ups.","Power-ups? I\'m interested @powerup"],"attitude":["I\'ve just had the worst day. Lost my job to some fancy pants high framerate fire jerk and was put here to give away free power-ups.","The other fire across the river? @otherfire","I don\'t care. I need answers! @answers","You said something about power-ups? @powerup"],"otherfire":["Yeah, that jiggly eyed bastard!","He seemed pretty helpless to me.","I still don\'t care. I need answers! @answers","You said something about power-ups? @powerup","Hah! That\'s just fantastic! Do whatever you like, just leave me out of it. And don\'t come back complaining after you get scorched.","Whatever. I need answers! @answers","OK You said something about power-ups? @powerup"],"powerup":["Yeah, I\'m assigned to distribute the flying ability. It\'s popular amongst school children and birds.","Nice, flying!","Don\'t expect too much. It\'s more of a multi-jump if you ask me. But you know marketing.","I\'ll take one.","Sure, here you go. !multijump","No refunds!","Also, I\'m obligated to tell you, that you should visit the cloud world.","I personally wouldn\'t go there. The people there are really annoying.","But that\'s just my opinion @visited !end"],"visited":["Sorry, we have a strict no return policy!","[$metcaveman]Did you know there\'s someone living in the caves? @caveman","I just wanted to talk some more. @more","Damn","Come on man! You didn\'t even pay anything. @finished !end"],"more":["I already have a headache, thanks. Can\'t you just do like a bird and multi-jump out of here? @finished !end"],"finished":["Just let me do my job in peace. Go irritate the cloud people. They love that.","[$metcaveman] Did you know there\'s someone living in the caves? @caveman","Fine. @finished !end"],"caveman":["Yeah, the best kind of neighbor: Quiet and seclusive.","Can\'t you just give him a free flying power-up?","No, that\'s not how this works. He broke the sequence and messed up some triggers.","That\'s irreversible, but not my problem.","Sequence? Triggers? What does all that mean?","Whoops, don\'t mind me. Just giving away power-ups here.","But","Bye! @nodialog !end"],"nodialog":["I really don\'t want to talk to you anymore. !end"]}')},812:e=>{e.exports=JSON.parse('{"entry":["Thanks for the wood","But weren\'t you supposed to bring it somewhere else?","I just wanted to try this out first. @tryOut","I don\'t trust the other fire. @trust","Whoops, you\'re right. Can I have the wood back? @back"],"tryOut":["Interesting. So no moral motivation? You\'re just driven by curiosity?","Well, I take what I can get. At least you didn\'t just blindly follow the order of a psychotic flame.","The others weren\'t so smart. @first"],"trust":["Good call. I did tell you that this thing was nothing but trouble.","Nice to see that you aren\'t as dense as the others. @first"],"back":["No no! Don\'t you understand?","You did good. Even if it was just by chance.","I\'ll take what I can get. @first"],"first":["You\'re actually the first one in a couple hundred years to break the cycle. !amused","I\'m proud of you. You can pat yourself on the back. !amused","I would do so myself, but I don\'t have any arms in this form.","I don\'t understand anything @meaning","What does this all mean?  @meaning"],"meaning":["That\'s nothing that you should think too much about.","Even a glimpse of the truth would instantaneously turn your sanity inside out.","Let\'s just say this was all a dream, how about that?","If you\'re lucky, you\'ll even forget that this happened at all.","What happens now? @next"],"next":["Like I said, you can leave. I\'ll activate the portal here.","Just go through and you\'re out of here.","Don\'t dilly-dally for too long. I have a lot of paper work waiting for me.","Thanks I guess.","Yes yes. I have to thank you as well. You spared me a lot of work here. !amused","The damage the fire would\'ve done to this place, would you have fed the wood to it, is a pain to fix.","I might even get some long overdue vacation time out of this. !amused","So, see you around or not. !activatefireportal !end @idle"],"idle":["Still around?","There isn\'t really much you can do here now.","Just hop in the portal and off you go!","O-Okay !end @idle"]}')},2662:e=>{e.exports=JSON.parse('{"entry":["Oh come on ","I can\'t believe this !angry","Don\'t bring that stupid grey guy to this side of river. !angry","How did you even get over here?","I can\'t help you like this. Go back und do it properly!","Does nobody here care for a proper order of events?","Whoops, I\'ll be on my way.","Yes! @visited !end"],"visited":["No! Don\'t talk to me while carrying that stupid stone!","On my way!. @visited !end"]}')},3491:e=>{e.exports=JSON.parse('{"entry":["","zZzZZ","(Someone seems to be asleep in there.)","I better force the chest open. @wakeup !wakeupchest !end","I better leave the chest alone. @entry !end"],"wakeup":["Oh my, was I asleep?","What time is it?","I have not the slightest idea","Well, no worries. @who"],"who":["I haven\'t seen you before. Are you an item?","No, just a regular human.","Ahh, one of those. @questions"],"main":["Hello friend! @questions"],"questions":["What are you? @what","[not asked_about_items]Do you have any items? @items","[not asked_about_sleeping]I thought someone was sleeping in there. @sleeping","I\'m off.","Bye! @main !end"],"what":["A mimic chest.","But a basic one, I can\'t even move properly.","It looks really silly when I jump to move forward, so I don\'t do it when people are around.","How did you get here then?","Delivery services! @questions"],"items":["No, we mimics usually don\'t carry items. !set asked_about_items true","Some do, but that only creates incentives for unnecessary violence.","There\'s no need to attack a mimic who doesn\'t hold items, no?","True","Yes, yes. @questions"],"sleeping":["Oh, a common mistake! !set asked_about_sleeping true","The people I eat usually don\'t have the capacity to make sleep noises anymore.","But that was a long time ago. I\'m living the vegan lifestyle now.","I moved here when I heard how peaceful it was. @sleeping_questions"],"sleeping_questions":["What do you eat then? @eat","Lucky me @lucky"],"eat":["Vegetables, rice, and tofu.","Or whatever is prepared when I\'m around. I can\'t really cook for myself. @sleeping_questions"],"lucky":["Indeed!","If you had met me when I was still working as a trap for adventurers, you would be crushed and dismembered by now. @questions"]}')},8047:e=>{e.exports=JSON.parse('{"entry":["","Oh, hello mortal. !set $metPowerShiba","Hello. Who are you?","I\'m a power-up.","But I wasn\'t always one.","Were you a dog before by any chance?","I do not remember my past life and it doesn\'t really matter either.","How does one become a power-up?","I was taught by my mentor and father figure, the almighty flying power-up.","After years of meditation, I was able to transcend and leave my mortal shell behind.","I lost my memories and the ability to move, but it was worth the sacrifice.","If you say so @met"],"met":["What is it you desire?","What kind of power do you inherit? @powerup","Aren\'t you interested in your past? @past","[$metShiba]Did you know, you have a brother? @brother","I\'ll leave you to yourself.","Please do. @met !end"],"powerup":["That I do not know.","Usually, the designated power is bestowed upon birth.","Since I transcended being a mortal like you, my power is unknown.","But it doesn\'t matter either way.","I have no intention to be consumed.","Not even by me?","Yes, not even by a person I met a minute ago.","I shall contemplate about cloud related topics here for the rest of time.","Too bad @met"],"past":["No, the memories of my mortal past are but an ember of the flame I am now.","This is how I must be. This is everything.","If you say so @met"],"brother":["I do not remember my past life.","I also have no desire to involve myself with mortals.","That\'s harsh man I gotta tell the other dog. @met"]}')},5979:e=>{e.exports=JSON.parse('{"entry":["I remember","A memento from the past.","Thank you for bringing this to me.","How is my brother? Tell me about him.","He is a good boy.","Good to hear that.","I can\'t believe I forgot about him","This is unacceptable.","Maybe you can make it up to him.","Yes I must do that.","I must meet him. @sacrifice"],"sacrifice":["I know that it\'s a lot to ask from you after you already did so much","but would you be so kind and give away your power of multi-jumping to my brother?","This is the only way for him to actually come to me. @sacrificeOptions"],"sacrificeOptions":["Can\'t you just leave the clouds yourself? @yourself","Can\'t I carry you down? @carry","Of course I will! @yes","Eh, no thanks. @sacrifice !end"],"yourself":["As a power-up, I lost all means to move by myself.","I\'m a slave to my own ambitions. @sacrificeOptions"],"carry":["Touching me will most likely lead to a consumption of my unknown power.","I might keep my consciousness, but that\'s not a risk I can take.","Who knows how my power might manifest.","I must meet him like I am now. @sacrificeOptions"],"yes":["You will?","[not $seedgrown] Wait @notyet","This sacrifice will not be forgotten.","Please go to my brother and grant him your power-up.","Of course I will! @go"],"notyet":["Make sure you have done everything you need to do here up in the clouds.","If you give away your multi-jump prematurely it could lead to a disaster.","I can tell that you still have business here.","Thanks for the heads up! !end @sacrifice"],"go":["Thank you human! !set $gotPowerShibaQuest true !end @end"],"end":["Please grant your multi-jump to my mortal brother.","Your sacrifice will not be forgotten.","Of course I will! @end !end"]}')},954:e=>{e.exports=JSON.parse('{"entry":["Human! Thank you for coming.","Your selflessness brought an estranged family back together.","This is something no amount of meditating could achieve.","Don\'t mention it!","Please don\'t play this down.","My brother and I came to the agreement that you should collect me.","My unknown power might help you on your quest.","I don\'t know if I can accept that @accept","Great idea! @idea"],"accept":["We don\'t accept a no for an answer. @fate"],"idea":["Good to see that you agree. @fate"],"fate":["This is the inevitable fate of my existence.","And I couldn\'t be happier to be at your side.","It\'s a deal then!","I hope my power is useful to you.","You should continue your quest now!","Farewell! !friendship !end @entry"]}')},6847:e=>{e.exports=JSON.parse('{"entry":["I have been born. I am alive!","I thank you for bestowing the miracle of life onto me.","My father will hear of this. Please speak to him to receive a proper reward.","I will, but please stop the creepy talk.","I will not comply to this demand. Farewell! @visit !end"],"visit":["I will drown in a very short amount of time. Can you stop the unending rush of fluids?","I guess there is no dry-dance, sorry.","Oh father, why have you forsaken me?","Gotta go, fast! @final !end"],"final":["My life was in vain Avenge me! !end"]}')},2381:e=>{e.exports=JSON.parse('{"entry":["Greetings, human!","[not $gotFireQuest]You might wanna talk to the flame first.","[not $gotFireQuest]My hands are tied until then.","[$gotFireQuest]Oh my god, what are you? @what","I can\'t handle this darkness.","[not $gotFireQuest]Sure, no hard feelings. @entry !end","[$gotFireQuest]Sure, come around again if you\'re ready. @entry !end"],"what":["[$ismale]No need to soil your pants.","[not $ismale]No need to soil your skirt.","Ever had the feeling someone was watching you from a dark corner at home?","Or you\'re being followed at night but no one is there when you turn around?","That\'s probably me, or one of my coworkers.","But I\'m on my break right now. It\'s nice to have a chat every once in a while. @visited"],"visited":["[visited]Welcome back, friend!","[not taught]Any idea how to get over that bridge? @bridge","[not darkness]Why are you surrounded by darkness? @darkness","[darkness]Can I still come by later? @comebye","[not pokemon]Are you playing on your phone? @pokemon","[taught]How does the running work again? @running","I\'ll get going. !set visited","Sure, keep up the good work. @visited !end"],"darkness":["Makes me feel at ease.","I don\'t really like daylight, let alone fire.","This also serves as a gateway home. You can totally come by later if you have nothing better to do. !set darkness","I\'m kinda in the middle of something right now. @middleofsomething","Sure, maybe later. @maybelater"],"middleofsomething":["Too bad. I could use someone to play games with.","If you change your mind, you can always just slip through here. I have no other plans today after work.","I\'ll think about it. @visited"],"maybelater":["Awesome!","Just slip through this gateway when you\'re ready. I\'ll be home later this evening.","I\'ll update my appointment schedule. @visited"],"comebye":["Yes! My shift is almost over for today. Just head right through later and we can play some games","Sounds like a plan. @visited"],"bridge":["That bridge is pretty busted, isn\'t it? !set visited","You can easily vault over the gap if you gain enough speed.","I can only walk. I\'m too slow.","That\'s not a problem. I can teach you how to run.","It\'s a pleasure seeing people run anyway.","How does it work?","Close your eyes and envision that unique feeling.","The creeping anxiety you feel on an empty walkway at night.","Someone is behind you. Cold sweat oozes from your skin.","You can almost feel the dark presence crawling up your spine.","Your irrational fear swells up and blossoms to a beautiful raging panic!","or in other words: Just hold your run button. Fairly easy. !enableRunning !set taught","Awesome!","Have fun with your new ability. @visited !end"],"running":["Just remember that one feeling, that creeping anxiety at night.","Someone is behind you. You can almost feel the cold presence on your skin.","The fear swells up and bursts out as raging panic. Beautiful!","or in other words: just hold the run button. Fairly easy.","Thanks!","See you around. @visited !end"],"pokemon":["Yeah, I\'m hooked on Pokmon GO since last year.","This bridge used to be a popular poke-stop, but the folks around here stopped playing.","I might be the last one playing. Finishing raids like this is nearly impossible.","Can\'t you just stop playing as well?","I already invested so much time and effort... how could I stop now?","Suit yourself. !set pokemon @visited"]}')},2630:e=>{e.exports=JSON.parse('{"entry":["Hello! Friend!","You smell nice.","Are you here to play???","A talking dog, I\'m not surprised.","Yes. Talking!","Mother taught me to speak."," Bark!","I mean  Chirp. @met"],"met":["Play???","[not inTree]Why are you in a tree? @tree","[inTree]Can you tell me about your brother again? @reminder","We\'ll play another time.","(Pet the dog already!) !petDoggo !end @met"," OK friend. !end @met"],"met2":["Did you find my brother?","Also Play???","[$metPowerShiba]I found your brother @found","[inTree]Can you tell me about your brother again? @reminder","We\'ll play another time.","(Pet the dog already!) !petDoggo !end @met2"," OK friend. !end @met2"],"tree":["I fell from the sky. !set inTree","Bird mother brought me here, gave me food.","Brother is still missing We separated.","There is another dog?","Yes, in the clouds. I fell.","Can you find brother? You can fly! !set $metShiba","[not $metPowerShiba]Sure, I can take a look. @search","[$metPowerShiba]I already found him. @found"],"reminder":["Yes! Brother!","I fell from the sky, my brother stayed.","I howl every night, but no response.","Please find brother!","I\'ll see what I can find in the clouds. @met2"],"search":["Wow! Thanks!","I want to smell brother!","I\'ll see what I can find in the clouds. @met2 !end"],"found":["Wow! Really? !set $gotBoneQuest","How does he smell?","Really nice That\'s not the issue though.","Did you bring him? Where is he?","He doesn\'t remember you","What??? Oh no why?","It\'s complicated. Any ideas how to make him remember?","Mmmh","Yes the bone! ","We had a bone when we were with human.","In a cave, when we came to the clouds.","It\'s the favorite bone. He must remember the bone!","Can you bring favorite bone?","The bone in the portal room I remember that.","Can you bring???","This might be tricky. The throw power-up seemed to know a lot about items.","Please bring @boneReminder !end"],"boneReminder":["Hello friend!","Can you bring favorite bone?","it\'s in the cloud cave. You can fly!","Can\'t get items through doors Gotta talk to the throw power-up @boneReminder !end","(Pet the dog already!) !petDoggo !end @boneReminder"]}')},1670:e=>{e.exports=JSON.parse('{"entry":["You found bone!","Wow!!!","Bring to brother please.","Sure, I\'m on the way! !end @entry2"],"entry2":["Friend!","Go to brother.","Bring bone. He will remember!","Sure, I\'m on the way! !end @entry2"]}')},8357:e=>{e.exports=JSON.parse('{"entry":["How was it? Did you give bone?","Yeah, your brother remembered you after all!","Wow! I\'m happy. Best day. @main"],"main":["You are the best!","[$gotPowerShibaQuest]Do you want to meet your brother? @meet @entry","Have a nice day! !end @main"],"meet":["Yes!!!","Can he come?","No, that won\'t be possible","Awww","But you can go to him. @go","There\'s nothing I can do. @main !end"],"go":["How???","In theory, I could give you the power to go to him.","I can fly?","Yes you can now! @giveaway","On second thought nevermind @nevermind"],"nevermind":["What??? Nooo !end @main"],"giveaway":["I can feel it. Thank you!","No time wasting!","I will go get brother.","Find us on the mountain. I will wait at bird feeding spot.","At the bird feeding spot check!","You are best friend!","See you there. !shibaNextState !end"]}')},8598:e=>{e.exports=JSON.parse('{"entry":["Hello best friend!","Thank you for visiting.","We have the best day.","Brother is glowing!","He sure is. @entry2 !end"],"entry2":[" Happy bark!","Play???","Later. I have to deal with the fire first. @entry2 !end"]}')},8478:e=>{e.exports=JSON.parse('{"entry":["I helped!","You sure did, buddy.","At last, time to play!!!","Just a minute! @play !end"],"play":["Play with friend???","Just a minute! @play !end"]}')},9584:e=>{e.exports=JSON.parse('{"entry":["[not met]I am the wise stone. Hard, but fair. !talkedToStone","[not met]I oversee the sacred garden up that hill. What wisdom do you seek? !set met","[met]Welcome back young human. What wisdom do you seek?","[not $seedplanted]I need to plant a seed. Any tips? @tips","[$seedplanted]I planted the seed but nothing happened @introduction","Nevermind. @entry !end"],"tips":["You can use the sacred garden of course. Just throw the seed directly onto the soil.","The item will be absorbed by the blessed and fertile ground to help create new life.","What a miracle!","It\'s just a gardening","Will do.","Good luck! @entry !end"],"visitedentry":["I see that you still struggle with your task.","Yeah, kind of. @introduction"],"introduction":["Well, if you are willing to listen, I would be willing to teach you the ways of the sacred soil.","I do not need a teacher. @noteacher","Sure, whatever will help me finally get this done. @getthisdone","Seriously, can everything talk here? @getthisdone","I can do this on my own, thanks. @onmyown"],"noteacher":["Without my teachings your little tree will remain but a sad seed in the sand.","Return to me when you\'ve grown some wisdom! @visitedentry !end"],"ionlymaster":["Fool! Out of my sight! @visitedentry !end"],"getthisdone":["[$ismale]A bit more respect, young boy. Start by calling me master!","[not $ismale]A bit more respect, young girl. Start by calling me master!","I am the only master I acknowledge! @ionlymaster","Fine, what can you teach me master? @yesmaster","Forgive me, master. I am willing to learn. @yesmaster","[$ismale]When do you beings stop calling me boy for once?!","[not $ismale]When do you beings stop calling me girl for once?!","[$ismale]What are you saying, boy?","[not $ismale]What are you saying, girl?","[$ismale]I\'m a girl! @genderswap","[not $ismale]I\'m a woman! @woman","[$ismale]I\'m a man! @man","[not $ismale]I\'m a man! @genderswap","I\'m a human, leave me alone with your gender talk! @human"],"woman":["Great for you. @getthisdone"],"man":["Ohohoh. Have you looked in a mirror? You have less facial hair than a stone.","You\'re right, master. @yesmaster","Touch! @touche","A man is defined by his actions, not by his beard.","And for now you have neither. But I reckon this may change today.","You\'re right, master. @yesmaster","But I have accomplished so much!","Are you saying I\'ll grow a beard today? @beard","So what, you talked to a fire, bounced off a mushroom and stuck a pine cone into the mud.","Mediocre!","But I\'ll lead you to greatness once you\'ve accepted your current lack thereof.","Please do, master. @yesmaster","Just get to the point already.","So impatient. I\'ll bless you with my teachings once you\'ve demonstrated your willingness to accept them!","OK, master, you win. @yesmaster","Just tell me!","Well, let me help you help yourself then","Master master master master!","See, easy! @yesmaster"],"beard":["Well that\'s a miracle for another game. Your fate in this world is a different one, one of carrying and dancing, I presume.","OK, master. @yesmaster"],"genderswap":["Well I guess even my immense wisdom has its limits.","Maybe you should switch up your appearance next time","All righty. Maybe I\'ll do that.","Where were we? Ah yes! @getthisdone"],"touche":["","touch, master. @yesmaster"],"human":["This exceeds my expertise. Umm. Where were we. Ah, yes. @yesmaster"],"onmyown":["Good luck, fool. @visitedentry !end"],"yesmaster":["So, let an old and wise stone tell you: Basic gardening requires water. So","Sooo? @soo","I think I need a drink a hard one. @drink","Wait I want to talk about something else first. @introduction"],"soo":["This is harder than I thought. @rain"],"drink":["Me too, although I am hard enough already, hahahahaha. @rain"],"rain":["[$ismale]You need some rain of course, you foolish man. Magical rain from the clouds above!","[not $ismale]You need some rain of course, you foolish woman. Magical rain from the clouds above!","You need to grow as person to get access to the cloud world. Not literally, but metaphorically.","Though literally might also work, but I digress.","As a part of this trial, you have to bring me down to the river and toss me in. !riverzoom","I will grant you incredible strength so you are able to carry me down the mountain.","Beyond the river, you will find the answer to your quest in a sacred cave.","I am not sure if I really want to touch you @nottouchyou","[$ismale]By the power of Grayskull! @lift","[not $ismale]For the honor of Grayskull! @lift","Yes, master. @lift","On second thought, I don\'t like this at all.","What a hard disappointment @visitedentry !end"],"nottouchyou":["This is the beauty about power, and now lift me up!","I need to lift my master @lift"],"lift":["You are wooooorthy! @remember !pickupstone !end"],"remember":["There you are again, my padawan. @remember !end"]}')},9324:e=>{e.exports=JSON.parse('{"entry":["At last, I can take a bath. @entry!end"]}')},662:e=>{e.exports=JSON.parse('{"entry":["Hello! !set $talkedToStoneDisciple true","I\'m a stone monk and student of the wise stone atop the mountain peak.","Are you here to climb the mountain?","Yes. @yes","Is there any other way to get up there? @no"],"no":["No.","[$ismale]Maybe flying, but you don\'t look like a bird man or man bird.","[not $ismale]Maybe flying, but you don\'t look like a bird woman or woman bird.","Damn then yes. @yes"],"yes":["Good.","In order to get up, just jump up the platforms here","It\'s easy. Just jump and that\'s it.","pfftttt. !amused","Nothing special to consider.","hehe! !amused","Why the suspicious act? @suspicious","I\'m on my way then. @onmyway"],"suspicious":["That\'s part of the fun!","OK I\'m on my way then. @onmyway"],"onmyway":["Pffttttt !amused","Good luck!@visited !end"],"visited":["[not $gotTeleported]Go on, I\'ll wait here. !end","[$gotTeleported]Welcome back @introduction !set $talkedToStoneDiscipleAgain true"],"introduction":["How far did you get? Pftttt hihi! !amused","Not so far according to your reaction.","Yes, very true.","Just say a word if you need help.","I\'m in a hurry, give me something to work with. @explanation","Riddles are my strong suit. I\'ll do it myself!","Respectable. Good luck then! @onmyown !end"],"onmyown":["How goes the riddling?","Progress is imminent! I can do this. @onmyown !end","I could use some help after all.","I thought so! @explanation"],"explanation":["This is a magical climbing chamber with unlimited height. !set $mountainRiddleExplained true","We adopted the concept from a fire spitting turtle.","He used it to keep some plumbers out. You can\'t make this stuff up.","I really don\'t care, how can I overcome the trial? @solution"],"solution":["You might already have guessed that the distinct gates are the key.","Just go through them in the right order and that\'s it.","And you\'re gonna tell me the order?","No.","Wouldn\'t be much of a trial I spoiled the solution here and now.","","Don\'t worry. I have a cryptic tip for you!","Listen closely:","The solution is represented outside on the wall to the right","That is very specific and not cryptic at all.","whoops.","I got the wrong tip sheet here.","Well, good luck nonetheless.","I\'ll try my best. @end !end"],"end":["Still not finished?","Remember the tip: The solution is represented outside on the wall to the right.","Yeah, thanks. @end !end"]}')},8165:e=>{e.exports=JSON.parse('{"entry":["You did it!","[not $mountainRiddleExplained]And you even did it without my help.","[not $mountainRiddleExplained]You rock!","[not $mountainRiddleExplained]I have nothing left to teach to.","[$mountainRiddleExplained]It was fairly easy with my help, wasn\'t it?","[not $mountainRiddleExplained]You didn\'t really teach me anything. @teaching","[$mountainRiddleExplained]Yeah. @easy","[$mountainRiddleExplained]I still struggled. @struggled"],"teaching":["Don\'t be like that","Bye! @end !end"],"easy":["I really should keep track of my tip sheets.","I feel kinda bad for spoiling your fun","Well, bye! @end !end"],"struggled":["What, really?","Maybe I have to revisit the tip sheet for brain dead humans","Well, bye! @end !end"],"end":["Hey again!","You can still use this mountain trial in your free time, if you want. @end !end"]}')},6073:e=>{e.exports=JSON.parse('{"entry":["Hey! No touching!","Woah, sorry. @sorry","But aren\'t you collectible? @collectible"],"sorry":["No hard feelings.","Just keep your hands where I can see them. @greetings","Sure don\'t worry @greetings"],"collectible":["I am, that\'s why you shouldn\'t just go around touching me!","You really don\'t want to own a power-up that hates you!","I guess @greetings"],"hey":["Hey there! @greetings"],"greetings":["Need anything?","Who are you? @who","What are you up to? @what","[not talkedAboutSeed]I have this seed problem @seed","[talkedAboutSeed]I still have this seed problem @seed2","[$gotBoneQuest]I have this bone problem @bone","I\'m off @bye"],"bone":["A bone problem?","[not gotBoneInfo]Yeah, I need to get a bone through a door","[gotBoneInfo]How did the trick work again? @throw","Oh that might be tricky.","As you know, items won\'t go through doors.","Is there really nothing I can do?","Well I\'ll let you in on a little secret.","Listen closely!","It\'s not that items can\'t go through doors.","They just don\'t want to.","But you can trick them with a precise throw.","How would that help? @throw"],"throw":["It\'s really easy.","You pretend to go through the door without the item.","Just throw it and enter the door as usual.","The trick is, that you time the throw in a way, that you can still catch it.","Going through a door takes some time after all!","I hope that helps with your bone problem.","Awesome, I\'ll try that. !set gotBoneInfo @greetings"],"who":["I\'m the almighty super throw!","Not that useful, but at least I\'m not a dancing power-up.","I live in the clouds with the rest of the family.","Like, literally in the clouds? @clouds","Why are you down here? @down","Back to topic. @greetings"],"clouds":["Can you live there any other way?","Nevermind @greetings"],"down":["I\'m exercising my throwing arm","Also, Dad has company over. I don\'t like the smell.","I really don\'t want any details @greetings"],"what":["I\'m throwing stuff up the mountain to exercise.","This is practically the best spot to do so in the entire world.","Any success?","No, I ran out of stuff pretty quickly.","Too bad @greetings"],"seed":["What kind of problem?","I must get the seed up the mountain.","I see. Items really hate going through doors.","You\'re a human right? Humans can throw by default.","Maybe try throwing the seed up the mountain?","You won\'t find a better spot than this.","Good call, I\'ll try that. @greetings !set talkedAboutSeed true"],"seed2":["Really? Still?","Like I said, throw the seed up the mountain whenever possible.","This spot here is a perfect start.","This trick might come in handy later on as well.","Got it. @greetings"],"bye":["See ya! @hey !end"]}')},8091:e=>{e.exports=JSON.parse('{"entry":[" You are the dancing tree,\\n  Old and rough. !amused"," One hundred and seventeen,\\n  dancing tree. !amused","Hello?"," Feel the beat from the tree topsee, oh yeah! !amused","He seems preoccupied with singing. @visited !end"],"visited":[" La la la","Maybe I should talk to the fire first @visited !end"]}')},4337:e=>{e.exports=JSON.parse('{"entry":[" You are the dancing tree,\\n  Old and rough. !amused !talkedtotree"," One hundred and seventeen,\\n  dancing tree. !amused"," Feel the beat from the tree topsee, oh yeah! !amused","Hello?","Wait what?"," You can dance\\n  You can grow. !amused"," Having the root of your life. !amused","Can you hear me?","What is this?","I know that song!"," Ooh, see that birch\\n  Watch that tribe. !amused"," Digging the dancing tree. !amused","Are you done yet?","Rude! !angry","I\'ll talk to you after you prove you\'re worthy.","[$ismale]Show me your moves, boy!","[not $ismale]Show me your moves, girl!","Follow the beat! Get ready! @danced !end !dance 1"],"danced":["Your little dance amuses me. You\'re keeping the beat alive! !amused","Thanks for the compliment! @smile","There is nothing like putting a smile on a tree\'s face. How are you? @smile ","How dare you?! @dare"],"dare":["Oh you pesky human! Can\'t even take a compliment! @request !end"],"nothelpful":["Oh you gnarly individual. I should have never trusted you in the first place @request !end"],"smile":["You seem like a decent lad! Maybe you can help me out with something.","Actually, I was about to ask you for something.","Huh? You came here just for me? How nice! @request"],"request":["What is it that made you come all this way?","I\'d like to humbly ask you for a piece of your wood. @wood","I\'m gonna cut you down.","You and what army?! !angry","Haha, it\'s just a prank bro! @prank","You\'re right, stupid idea. @request","Maybe we can help each other out.","How? Why are you here?","I need a piece of you. @wood"],"prank":["Go prank somebody else. I\'m too old for this. @sure !end"],"wood":["Sure sure. I can spare some. If you help me, you shall have your wood.","Awesome! @sure","What can I do for you? @sure"],"sure":["I\'m an old tree. I don\'t have any children.","My pine cones never amount to anything","I could really need your help. With procreation.","I\'d love that! @lovethat","Isn\'t that a little weird? @weird","Oh no! What happens to your pine cones? @pinecones","Nah I\'m not really the helpful kind. @nothelpful"],"pinecones":["Well that\'s a super long story.","But I\'ll gladly tell you, little one.","Um, nevermind. @nevermind","Cool! @cool"],"lovethat":["I figured it all out.","The only way I can get a son is if you plant one of my pine cones on the mountain in the west. !mountainzoom","Would you do that for me?","Definitely! @definitely","Ain\'t nobody got time for that! @notime"],"weird":["Oh you judgemental humanoid! Show some empathy! @request !end"],"notime":["Oh you are not a very helpful life-form! @request !end"],"nevermind":["Oh you rude leafless imposter! Won\'t even listen to my sad, sad story. @request !end"],"definitely":["Awesome. @missinggear"],"missinggear":["Oh, and I almost forgot!","You will need some special gear to be able to climb that mountain. I hereby grant my personal pair of double jump boots!","Awesome, thanks! !doublejump","I\'ll drop the seed for you now. Good luck on your journey! !spawnseed @reminder !end"],"cool":["So the thing with pine cones, you see, is they need very special fertile ground to grow.","Have you looked down? The soil here is rubbish. Nothing can grow here. No nutrients!","Which, ironically, is why I\'m too weak to throw my pine cones far enough onto better grounds.","A vicious circle of non-procreation!","So I need somebody to carry my pine cone to the best possible place in the area.","I just want my child to have it easier than me, you know?","Definitely! @lovethat","Ain\'t nobody got time for that! @notime"],"reminder":["You know, you wanted to help me procreate. Bring my cone to the highest place in this area.","Got it! @reminder !end","[not $seedplanted]Sorry, I lost your cone!","[$seedplanted]I planted the seed. How about the reward? @reward","You did what? Thank god I have an unlimited supply of them. @reminder !spawnseed !end"],"reward":["You will get a reward when my offspring sprouts. That was the deal.","But... that might take forever!","Ho ho, maybe you can go the extra mile and make the little cone grow faster?","I\'ll try... There might be some trick to it. !end @reminder"]}')},271:e=>{e.exports=JSON.parse('{"entry":["How did you fare?","There was a suspiciously convenient patch of soil at the top of the mountain.","The sacred garden, yes. How about my seed?","He is alive and well. @alive","He is alive for now. @barelyalive","He is alive but you might want to check if your seeds are not spoiled. @spoiled"],"alive":["This is good news. This deed will not be forgotten.","As promised, you may have a piece of my crusty bark.","Thanks! @returning !spawnwood !end"],"barelyalive":["Trees are sturdy creatures. He will make me proud, I\'m sure of it!","If you say so","Yes, yes where were we? Ah yes, as promised, you may have a piece of my crusty bark.","Thanks! @returning !spawnwood !end"],"spoiled":["Oh dear what did he say? Was he making strange frog related puns?","That\'s a very specific but no.","Well, don\'t mind him then. It\'s just a phase, he will grow out of it.","As promised, you may have a piece of my crusty bark.","Thanks! @returning !spawnwood !end"],"returning":["Greetings, friend!","See you around! @returning !end","Sorry, I lost the wood you gave me earlier!","You do this on purpose, right? Wood is not growing on trees! @returning !spawnwood !end"]}')},7574:e=>{e.exports=JSON.parse('{"entry":["(The blinds on this window are only half closed.)","(It is possible to take a look through the window.)","Take a look !end @entry !lookThroughWindow","Step back !end @entry"]}')},4554:e=>{e.exports=JSON.parse('{"entry":["[visited]You again Breaking into my home.","[not visited]Who are you? Why are you breaking into my house?","[not visited]I was just looking around. @looking","You look like a flying ability power-up. @pickup","[$seedplanted]Do you know anything about growing seeds? @seed","[$seedgrown]I did it, the seed has grown. @grown","[not visited]What a strange person","[visited]Bye power-up. @dontcallmethat","Whatever. @entry !end"],"dontcallmethat":["Don\'t call me that! @entry !end"],"looking":["And you think this is an accepted behavior?","Nevermind, it\'s apparent what your standards are.","How did you get up here in the first place?","Via jumping. @jumping"],"jumping":["Aw man, another one of the multi-jump gang. Flying is better and you know it. !set visited","There was no flying ability available. @noflying","I like the multi-jump.","Yeah, you look like someone who would. @entry"],"noflying":["That\'s because I\'m up here and don\'t let strangers touch me. That includes you! @entry !end"],"pickup":["[$ismale]And you look like generic action guy.","[not $ismale]And you look like a random japanese school girl.","Go be generic somewhere else, it\'s unbearable. !set visited","Don\'t change the subject. You\'re even glowing.","Ouch! The truth hurts. @entry","Yeah, so? That\'s none of your business and as if you needed a flying ability in the first place!","I bet you got one of those multi-jump things! Even birds are falling for this scam nowadays.","Guilty as charged.","I guessed so. @entry"],"seed":["[not deal]Seeds? What is there to know? That\'s basic gardening. !set visited","[not deal]Just put the thing in dirt and pour some liquids over it.","[not deal]I don\'t have any water.","[not deal]Well, that\'s too bad. But not really my problem, is it?","[not deal]Then I will annoy you until it rains naturally. @annoy","[not deal]Don\'t you have some water? @water","[not $seedgrown]Seriously? I already gave you my stupid son and an instruction on how to get the water.","[not $seedgrown]Sorry, can you repeat it?","[not $seedgrown]Wow stand on top of the grey cloud next to my house.","[not $seedgrown]It\'s very very simple. There shouldn\'t be any reason for me to repeat this.","[not $seedgrown]Go away please!","[not $seedgrown]OK !end @entry","That\'s a trick question! I know that you already grew the seed.","You really can\'t hold your side of our deal, can you?","Sorry, I just like being around you.","Leave before I call the cops on you.","I\'m on my way! !end @entry"],"water":["Look around you! I\'m living in the clouds.","When I get thirsty, I just put my face in through my living room wall and breathe in.","Then I will annoy you until it rains naturally. @annoy"],"annoy":["Company of a human is the last thing I need right now.","OK, let\'s strike a deal.","I get you your water and you leave me alone forever.","How does that sound?","Best deal ever made. @deal","I might still send you emails in secret.","Joke\'s on you, I forgot my email password a long time ago! @deal","OK OK, the deal is great. @deal"],"deal":["So, listen closely. You can get water out of the darker clouds.","Since waiting is not an option, there is the possibility of rain dancing.","I think one of my children holds this kind of useless power.","Let\'s see","","Yeah Dave! That little misfit is nothing but trouble.","You can have him.","Are you really just giving away your child? @giveaway","Thanks. I will take care of him. @takecare"],"giveaway":["Don\'t worry. I have plenty more where this one comes from.","Also, this might be the only opportunity for him to actually be of any importance.","Plus, you have no idea how annoying he can be.","So, win-win I guess? !learnraindance @use"],"takecare":["Whatever. Just don\'t bring him back! !learnraindance @use"],"use":["Where was I? Ah","Using the power is easy: Stand on top of the cloud and Dave should give you a hint on what to do.","I\'m on my way then!","Close the door on your way out. !end !set deal true @entry"],"grown":["What a great achievement. I\'m so proud of you. !set visited","Thanks!","Are you being sarcastic? @sarcastic","That was sarcasm. I couldn\'t care less. @entry"],"sarcastic":["Oh no, I have been found out!","Shame on you!","I couldn\'t care less. @entry"]}')},6107:e=>{e.exports=JSON.parse('{"compressionlevel":21,"height":109,"infinite":false,"layers":[{"compression":"zstd","data":"KLUv/aCYQwEA7S4A5htMOyCvBEEAAABvxmczJmJg87AS8R3KBgBZo4shTUCvPQXHcmPJlalOouVRpCUgJgnt35Dy84CsDaTFZb/zMAA3AEEA/zkgkGd7CN6B1/EZN8t4jMM4ip+4iZd4V6iIh7iMZCKVdHpAG6jH87x50jqP8/YGs/iKq6BCLSQ+4javOQ1VzQxlw5jD/GWlWImqn1NF1Vqf6yWVpKjWHP5Fq3VqZjQajUaiV5+pDgttooby2bTtUZsuycjGcfZG6nDWojDhxKREwvWWZOSBA5EQzhiALFCQ4ONTwzPsON7GG/AEPI0XgMLwC7+4i7cYIjUyNlVs1sjQuLy8xHxwgWFZWQKhUlph8SB16DCwAAEOkCk/AGi8myQLSxUmRViC8Kbtdu08/SnrO9mmhdafBqtlbfIICYJaqNJUEwIGABIBATLDkjEIGSMxsm2CAABEYAMEAMAxAAAAGEFEAGAEAEBQEgAEAI6AIIUQ2ByFEvhWuwpMTCbRk0xk3kfZF36DtG4XZDm287yeaPGtG/CAD1n+HL0uQzpnjL+02OwzKlC/FavWnE9vh4474vEru4XyxRcWb/b5n314dRvo7Xy+2sR9XatkiKC5+CS+4XwT4ymus8PQjsGg+8KFXO5JkS/dsq9vvg8Le5RYRY510jafHO1wtmGO+Psms0ZoZkafRX3aS2NExoF8KA3x3WYVG3uc78Ne6hDfsjG97Ied7F+cr70UQN/YHtGJM/+kHlqG4xaqJ4ldZdIfEg9eGR1ljdb3Kx3RR+7bwWfhG5icw1VV5gqQ7v1QZuYjSL0zw69xCVM79KAUevb8Mft0juRAu9+LBYKHBy/A3zkJ/x+zbb4e1yTNFv/w9323HYSODbOcB845dDfKPgzPIdF4wDl2vpK7AGfjdv8tfk1pYOJuIbmsduJVFtrdVOwzfMAVAZJk33hFbKDZVZbm5OefomVmGJFIELGC+de0LZ+vM7hvpkPqDNPODNbo4MB8vfhTPcV4OSzdH5sqr2W4wvny6uBiPt993p6+76e1XZSoeU3Wu5k5OGrZl1Xc/9XMRccP00uqhfmWNa9nQyaBg9tA0IkkFm/ZT+Xljh9wG0qSNPtnXk6U+SpJQxP3f9TuI8N8vu9930nhGCnJ5vP7uT+M/jweOg73PPZ9XBQ7CeZJvpVUcb7R7AN+rOQLT/vJNIwNMzip7PitpGq+IljDeqyMHuqx5gag6XuSouZ/nQHQJ453/QuI/nHIT0DfgDIXUlgvNUD2zqWvefx8d4ySyil/w7BP4ohmA6qPON6scE2qm69RJh67kQZi9kW/ztMb9tpEl59vtKvfM4z2OrwPNNNJ+37LM+1VkiapUHB1ScLbjcYCmPS836/vr951lAzmhqWdXMNM+CfC8/F4LZq/D/fzRCYb9J7Y38/HJ/+wD/KT4ZkHO8sMDPgo/CrVTej2Ush3M8Op93TcBzF3xm6CUuazEikjx+dCpQ+6CSjuLVKc1GcB/kWPhLQxvVoJd1co4CqhL+gjfB70Fl0QL6dxuOF9hlX4ZOFartOfkjYkfnJ2xOMU+vO52UgFrI6Q84SA3rHpJR1rH+0PWeaL2eMqUJA18u8W2w7BIjsH5IdGNOYLsFjQLoBnQcsLDmSIWnUf7j2Hgrzd82C3y+ImTb5eu7JLry0gjCVYmkgZsKASCCnnc0uFkosUwEpdUFYagYwInTTXvUw5OHFnBA58GhCVzAq0RDa3wAS+XZbzXzYS+2a4BOI/0dJ0NCCGz0UPHUYpsmy2xbvoYrHWcDWVwRB8Gp2HnQcdtRBagJd9FjofbbPR9N84ac32Qx8Pgau3g3+zpdZsC63xWAiUeazu37r12p0h4ws8oZThE1kxH1/TuCEUmfzdzPcXwxX/+0WW1ddctTvD94S4ISVSiPAKbCgSWLmiPk5kuvaRfE7Efgl0B3GdO7zL/j6tpL/ReqYqxrktXk+RQ5kP98zKz6UnUdC77dqnpkX2geiaZ3ZPqjG5sUCrNbyszE7hCg==","encoding":"base64","height":109,"id":4,"name":"background","opacity":1,"type":"tilelayer","visible":true,"width":190,"x":0,"y":0},{"compression":"zstd","data":"KLUv/aCYQwEAFTEAGkusCTrAHAEK7B2/+ZlExRhPqE0pq1MsRvLtV4E8lECxlTJtfVn4pbNKsEKRL2LjX4HuKeVBdI3aSgdIZ+c7igCDAJcAX4SP6Zvr6oSqjG4NbgxuC24KCH0jcBtwE3Ajug1d9RfoA/T9+fx8fdQQevUH53vzufnafGyqZlf9ffm8fF0+Lh8Vk2/Jp+RL0oD1hC/7ZDzBb8QnIkDWq+j39PH5pA5lv6D+E7GG/grO+ieYhxYYraY+LX9QbemcvjVS/x+Pm/qkbkpP/2Lf0wcbnb6mHucRwRP8XZfwqf8xqm+5gBf7YFGHyr76L5ZddRX702FH4vSmM31HVuEUvriLtziLYMKIGTP7cA9feof/z16T7DnJ3pPsQbk4j8H/DUOWD8t35bPy2YvzkHxHPiNfkbfj0/Hl+HCw+FZ8Kr4UQ/8PcRCvw8fh2/BpOKmX9Lk+CQHf1VQppc/OV+ej882BWcWOqbme06st/R9sU3JtSUSwp+fL8+H57nxyWJkemu/MZ+YrA+BV+ah8Uz4pLSnGYUxzND/zOiLfkE/IF6SCs3eVvULZNtvuI0M0wC/cQvbmZI9O9upkz84X5aAe3MED8v34bWnSZ3U1PhrfjMOQba5b0v9N6dTB3vOZ+Ep8JF7HtJr/L8OVL9YPVP+fbU1/Y/r/Nugm6G+BboCyzenW9J9qyxaqG5ejvi35vzH5//9Nzi3O3+Dc3vz/rckoKKioW5LNx61H0QJFR40eGWhtGd34bAwt2noovhNbRUhHzWWgBWs1V9Gjg93awFkZISH9xRrNfiEdtaw+q0cHkGZPzjV9a5ZYEQ5hANkH/na3X6GBZqgxQQiAAAAEABAgCAAhLQLGICBEVNQDIgAEEBQCgIABCLAECQFAEgQECQFCEBE0BA1AgFEkBEGvcQCdQh41RoqETMFsDQvwsuFqvTfAXuZz6eZg7o6ZgXnwMzyREsXP+kZWiVGXRDnBF7oxm/3lUuoBtCdfnpjT3qpoDUSWW4Nvg3+ZxaX7decOw30++KGTUf9e3eqmtzjKuV/SDcTsL5dSD2j2X36sIpDeGEGJGY2SOwCovL/tkPTzIDVeXQYQ7wAjZz7iFtq7cOQzDkVxivLcUpn7xN2FGzkyMe12TM/T12Pg0kiIoIsdOPgMrm3ZpS60xp42+fGsfFLh4SG3DyWOYNkMQ3hV0V1YPLkDkBBjdISkn6R+t6U0Ih66nV9dV/f4+MBXOF5zKmwhocD5JP6xR72AJxs8fPobHjm2+ahUwQF5dbwRr3Qd/w52JDNxIODHJ3arK9kc/47xtynlyVbOraUJm9/dHmz8YeDrSnahUcCjJ51fTmiFrdHheFAA4zlmoZ7Hbq7xICUZ5pYlGN4ueyNyNzmFObZHCM6quBpnHzZfxvcQhq/NH2U0PeeclGWOnMl+1hN3dTyg+FnXlqmZhUkCgNYK5pyUSf6QjRN7M7ax2kv2C4v+pwp3tiSVwbTgbdqp8eBK3L4ml3ji49Ok9YzQkIHdTsBBtBi2BgwZnwJo/M9498UWUwEgbMfPlqNLY+VRrj585k8BbnMkusduOD4gD2n/9FeywowMFU0v/sNABEAkuXHSEzp7m6sE6QbYqGJITp79sP8HaXTsbdwm6r/WTiAo1nJy2wOPHMRTbP23xhGUyBqi9wKEeYMMHpaE+XDsDTwD+S8gAvON25cbsdQEipXTVlJH9/SaZZ9g4W6UKDVgWDRKQg8XSIiiWwqnRKixKYy9F5psufYH2aTqA5nwne2r3Wpwd0c+aenDOV3aFGAAKsAIW5K8RomNNTD38AZnH/UQ3D5sqR7J6sjThRmeHTOrotti5515St+dulJJLYtsLDZBRMkEIkJ0MP7+yzu9fb3pHV7uKnICZDQJysWrrwRfympfTYYBd3mMvSzPg4naskoLo58VuWGB8BWZC+9vwFfZXcxCFFbjCj5kkCkJVZxrF/Ba9sCPsTehRgCU6zRN6JMsh8EROiKfoBWbk0TmOj0DbkAbk+uVIMxmpwV4Nmd4Nihy0Fg13xjjGz6TkPVKuPZ1g5vqcimhBfP4AVmYnP+yCrsj/Ji7D8v+VvseRDgyH8wcMuiCMIYnwA==","encoding":"base64","height":109,"id":6,"name":"decoration","opacity":1,"type":"tilelayer","visible":true,"width":190,"x":0,"y":0},{"compression":"zstd","data":"KLUv/aCYQwEAHX8Axv6vQMCYDRIoqtYaKJC1EZKI/N8cMDk4m/8Gl5ml6yoAI6EEFPoldZx0DUxzAZYrCREkH0iqnt9ddc6kpSdYp1Cm73uVAI8AowC1oJqTNzmTrxvtdWhqBftwDx2LFUCdixZ3QrgJl/A6tOoI3G3AHXoJEPwO/EGx3ahMuZTVTef29kbkFOn8iQjxu73VcEjThtJ4W73tBOBwVy51LL/yOiTkQ4OkAvmP1/+q7h4EYQFCeq2euIl/L2kcy6VOAAWxYL/XLwZj/WAH8iA/GG6NoR9SmdzchwOwZmKW39RPSzWtm573mDY4FFE8sa+WnMbu6snB9NJiWooxRQ6bmQwKmsdWd73CKoPye3I387Sy4hRV9mItuQ6lp0fhfOezx4Jq+o5OwF2AOw13Bu4K+GC6U+4mKKUvvcd5TGNVRelJMkOMcofRxuuyMqyfzJI/XUmm3E5fgnnrOZ77jcccBsmP3MgLruhH9LPhpGg8OT9bfRzMwLBW72w1Gg4o6bnPxu9G7kva5bTZatTAWVD7y0XL/dOK6WQXvoigWjUQ3U2XAWd0IlBOj+e3c6NIV6LLaXC3gKlpNou5g2X4ambljMtQ8qM7iB3WCaqz0OBHodBZPAnhfNbJWDyaMtw11sOTFfmA2vEoCV90OpofVZMOp6ZndBxKTzpq9DZXUUN0hU0tpia05jAanoRfhJfnGhZ9QDPTM1NUVVtyXLbcTd1V3VHdTUEokOui4FRRTVFVJeFCNVXVYbeFBsKDVzQ34AzggENggQErAT61Ittf0F6iZuLndfn9vWs6NBiPDAaH1F3weXUvGGQW/vpVqMH4yDrX66/FgNY5mIF1rrvXtJYL5vqGNFhR1pxfz2/nVxPoLM8jmLcotOEAsX4T4zvxbp7NzxNBdAF3NANxs+38J4kudhdzS6EA9yuahE0dFDQdmxix1YhXboW1qCM7SyI4wBCAIAHzUbkICghEIUGzro3qATMQgABg4RBoAQIIIAAABjZAIAUAAAaYICFoAYDBCUCGxSnr3vCfdAMY0q5Stb4/A3DybsCzr+n1u2eV4+QVB88yTb3+6dD+rGUk/4d18mIKafjQp6MMVkn0fg9x1r43zF7xyUvjS38mzfyIkjEmAjpAXYCuHzPbuT1pJYe5xURm4jw752iglEjXe6tzSvukw9WJ9wyd4YDE6cw1isa3+Led9imd+Xd7C7/iCZxL6YEI9+vxDxTQRvrxMdOe27XeMORZLTdY7qOBTuZlHpt/mX8znX24caVWAbZ1vEK1Phcc5gkgnX2k19RUuate5FxsYPfTKn6RLP33LiuwEfrR7CF9SPbXwNVThfq2f20z32g0eGE8D3IAQN9/f0kXjI/CAJPOYx5ws+SP/YqU+TPT7VN9QdbcX3mnXU065rm3m/Ig/TXDBWHjbCfTaZKFaR/YZpsh2VbxAuQcfr2pA/SR1r51bL3cVp6itLfsxmUz///5eMOXVtC/h/XvhlDP5w2tK+voZJ+Q/i2G92ixFsezZb6WRgqV/gEqkFmJs7KhPmQ6ACbjmPY18rqfVymtPPZ4Okc3/omfQYFfcqGa12n2uXLX502spt/8v+4fpz1shWFHfDMF5pD97+E/xWwTztm/v3Q9NGP3S4634e2VqtVu8HXU+dN/Y+vD7yPeqidoTiHq3ixweck6aQLihvEBTo3Ph/yPxFflS4T+z1qyGAjjYd0VdtfR2TNcOvpaiNgnATwQOKD+5yLKvjZ7tXnGNfjndYm++cLHaHx4HdJ0bSr9wFRvaL7fd8ifNMoWQ6nfcMPr4WeGvouvdDncyx63fd0HH0jVXdh98tFMyenuu7xFWzT8ii5DRH4+xwJcYj69T8KSmkf0n1o/58h09IrZZ3f1DOPnBvnSZFGrABoK0LMtiNaz3w2AYeq+FO+br8MR7/hAfpNgJYqP8wrye969LBHTNVpy+1ukhct8jubmMF4cCdn77tgW3+DtXojjEZ5t8RI9zDFP+8wxunU3r81RweDfztMd39axDrW2rwPZYnswaLuDFFle8Y9+vmbvc5fX/XTL8FeQzXzqB1YfbGjXvi0a320QFveBSN/d/TJ1MrajjwlgyisC4jc9Kff5osAwn9SeL5YyDEfe4S/NNwN1bvJv/vhIGnPwh/+tv4D9mtXbvcDNnu8r37nxrIqnRtA3mY1HlIaK64/DNArIAuRpDfnTfLzVLp+V8D2Gxnm0KC9aso+h2Lzt+kXCM6pO/4YssM/tw+LcR/yUML518+vICtaJ9PITsVUJ9RgHPAh3uRwnYOcyF7nBBZ7nlMCpdOlC/rZxH0if6QU4WbKMQ+1npQyXTejCnoN4ue7eWh/3986WPSRwgxjnjA+7TwlyrvbPMyfA859K/3z0fRE+MDE/NLSfzwI5EDir8gPRhZPGtm/vMTO+ekWnw4R/9n89PvoVtE4C/BACc/+iNzha/zIRthw5zTLOs3z7FDj940si+648UIpmv/gnkCoHWB7zKlj/URgLm7WzsUOzd4/u/0N+2h7YsS9kx5wQ3S+Ec775z3663Kf8QbRRVngS1utQ73v+8d1s179HLnmfwZk2Pg7G54P4+74lXxmZ0L1k1N9dxfs+lK+i9RY41gfb+fbCxxF+QcdA06hN5v+R7bs2FmmT8s5LofAo95OOLZZWH57eeyqWMW93dV/88yKDF8zvvHrtt7lHPS/PvH1P/bnn/6uo41nH1+DYjHyijONU5ZNHOIeZQPatEkc/N1MDR6pTHdoEKs8Fr49xpuXDePh/s+dPfmpeiu/e/9/7BTGFx1H9pV19+/6/7ifiM49PPoN9E4jDn9smfXTjDbLJbC8hv7ktNkUVWI94XrrzWHacmw9sGsHZoIefB+Dht83xFh6v8HkGHDd7iwS9b53LzruG7oT2gduxx2px82S14zy1v36V4d/4wxgHbHqPJs9S8dXCfxVD1sqm97W49RCLF2L6wL73bXrjVT8n05xbgk0Rwe8/EndRV/c6XiYTrLce7IuXrseXtwiZr+3/WuC+eQ80lMI99bxODMH+6WvB+xqO5vfQvKluOyTOgrN1dL3m0bnM7p60rzYLls7Pu3+UzZkK/ntbfeuyNOM/jch63lruAvnum7IasSWGLlXNw1+jcstveVyZ/Qorovvm43Q+rYNGnNk7D2YjhN5uNBW4XrzlXphRv9EpMdcrXKVU+lNU2Ny3rMPEOJnm3mf6AT3GD1+oAeWbgk8q2+48DNC+zN0n/lqVYHxPLbTkBZZ2x8HoCMSUU4MVPWn7eNTmaN9q8nz+meSRcxfLD3HzHnfJ7BCY/Jh+01R+BL8LRLrv2I57zX0jtzmAM1X/8ByzFDZwy8sq7zur2rvp7L+vewuPyHPFj3sPxLc093muo+wUcOsZH0Ks/Vhx3O4BK57yDpLjYBDP6o84MbZwax9A3svhkoy4+/ph85FZurybv9o3ghLW4e5FnXbbjqwH5Fqtd6Ksn3baXfPHT1tk37u/8npvdoE1sn8O3w0bnm7zOWktIB7wIlyAPQGxD7QO+J8xh7k2w5b/LIS5qhr5H9l/tt9EZMZ829e5ahUq0AmUzkee5dj9rn3aPqPY95svHFcP0XXAeB2a9YzTZ+B4AkxWasgb08xDQSf3Sv7Pnmy+fciTM+4ZGbcH0hfZGLJzdFWjpCLhPmPAB/fhruHdYkB2MsmZrnO8MDt5zNNLyquGjuJ1SH74J99s2cxxIhoLrkM8payC7LN7iv/J4yCT0FSZ7BEX+XoZ1h5tn6rZKObz8Wz53/L6bhkT8gWhIMR9GKNbHZKvDuSuVpuK8T5yGfa+TvJ/qwcRseWyT/S/g3F7metkukcYMLvhgU4050j73gENKx7Cdy3/0HP8RY6627a1OQTq2nzE2tcD9IP4e9Botvzj54//BHF8OSfR/Xpc2MCJieTyPY6xQ+6hK0F8pwP6BXDIw4Fz72OczXIc9g05NJ/357bvdJHXi6LRMy/uJ+DYvr/HWw3QLSj7BALRtJccxtyIGPbd/aW3513T1KwqftV69qvQPndluvnl6O3p2jaYxcf29D4N34HX5H8RjFil7QvKALKheGzQ21P/C+fik5cJvDuLMke6JO8dx3gfLG79uetKJvkakoYVzg4foy/66RbPWPy5tu8+iZ0NVXGBT6bLky2tQG57HHvf1K2c9jJDmA7ubGeHXAXVKfCDSBPCXqOIOMeT3ad9De7ZWWgj+RkP6bN63Y2dlVdnWaEM8s5VgWbJs5nDo33n2le1COvyFmC+qLUx4gQ6ns1nCdYUwg3lPSnLUe5zGgFzKWsN/JbNZi7YbzxGxGi0PL9hfGPrFVG4bdXbhe5497X4TzJc+TF6ItqzSZt0lj5fZts02p8HjzMa8AwNdQru++yJa90AdJ/8ox0bAseoVTHPhhR5+I5NPARpN7hNWEjLnu3b/Q2qXSwIJxj4Nka8wv40RUwrxnqFDf+ygFFxVP5Lti+gfRer3AVRt1Z15m+KDr3d9Qrugek+1Dwf9wgJ4S3I7YuL7M34jMe7fEF1ZDocXJK5oVMl146DVjeeeTFFh6MY8ArZc+eE+fd5TMRVAHTv9/Gh03Wbrjk+MenrU/Deh3KV9NNHbs/O6AiHj8U1MWPkIwP6V/W64DNU+qp6lsff2pf8sPlr9gvNTfJbx4dNM6Oa7WBdZa0taI9MZGfOqqdeM/Iep/5IKob68qC+gkf/XK8pZ9mzvtpfCD1/+3D8G9lVvqox6zN+I+6fqF/nD6wL4vORO2D/nQwq0Xw4m5viMJDSHGwrB7hszPe8n4F8/BRMsDH46f3IL/0R8nJoCr6rge4CChW7lH5n+AK43ff8DEfWtRW6qsF6ba+aiflj0teyl3YmYl89gmtXLyDI3e/zFb77bL/P2dO97+0vYa+LrNzt8yu7OyOLC+WkYkvgg5O6Hn/sB4Bt94n+NZ6fLfN/+KycceC/Nsske22ib6ml7s82P8B7gWtBp60cb8GK+fbM5GntGXrSl8n7t/uFprGVkajMJnB2HIaYIeke4JkFcXNqgdouuR9GWEPcxxog5sAv1HaknOHb8D/PwH+A5i0Cc9L4EgfA4wn2x+v+7ziAEEZhX3i+lBaGjwhfyJN8SmdSfUcOvtuPN/cSUCaQp33kPvntFniqDj3K7FPKviuPLfxG/HtcpNYsXH65G+sYVSczfepqGgpnY82ouh/XbFQHlVULvKwRXejfQebPgnffPn90ew7LxbaQ7brKxr7CZPXNqXLPuk8bAtjN+Bi+61gQ/ofxwOBUFPu5W+d/Xk2+F9rtYgY3cfZiqk03KZHBj450VL6vdlV3M/0p226pNtjSOeX2GfyNuhr5u8AE6yts47LP594EVKYqe3jUEeVIhn11rqX+hqaO68W84RE7lOlzK/uCfeM5yMcxHGn1VkhdZ/ViH0DQlofdes9REw/AqmE/X5DZyA0=","encoding":"base64","height":109,"id":3,"name":"map","opacity":1,"type":"tilelayer","visible":true,"width":190,"x":0,"y":0},{"compression":"zstd","data":"KLUv/aCYQwEAJQgAYgYSGXBtBAHkxxrWVne3sDuNA3BCzAydoAb4fQ9bgUWwyIMMegrnET5AtOit/8FSDs+iFifoOTnNGXVleOFxcjRnUuKEmDzJGo8xOKgAEenWA8AIYmmIHBH8/ysEIwQnBBLJ0SwPcYo66Jeb7iy3iDtM/JiWd3vODt3yjkXMDi2kbYvhHqa+Ls4AYdqA4C38yF4GLQjxOlO/FPus63sofE9jeyaeIBTBH9ZvfhFcEaFurd1N1+Mk3+bmlHAEr2yZzk5vXxK9Yetzs3PIUilB/B6T/T+LfYK1fSWHY28SmN5i+mciwmvJbB3tcBqZyy4XqMOlYUSxJcIs4e1Tekc/PfT5Aww=","encoding":"base64","height":109,"id":2,"name":"foreground","opacity":1,"type":"tilelayer","visible":true,"width":190,"x":0,"y":0},{"draworder":"topdown","id":7,"name":"objects","objects":[{"height":0,"id":182,"name":"exitportal","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":156,"y":1928},{"height":0,"id":133,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":0},{"name":"row","type":"int","value":0}],"rotation":0,"type":"entity","visible":true,"width":0,"x":1980,"y":1742},{"height":0,"id":134,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":1},{"name":"row","type":"int","value":0}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2004,"y":1741},{"height":0,"id":135,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":2},{"name":"row","type":"int","value":0}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2028,"y":1741},{"height":0,"id":136,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":0},{"name":"row","type":"int","value":1}],"rotation":0,"type":"entity","visible":true,"width":0,"x":1980,"y":1718},{"height":0,"id":137,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":1},{"name":"row","type":"int","value":1}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2004,"y":1717},{"height":0,"id":138,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":2},{"name":"row","type":"int","value":1}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2028,"y":1717},{"height":0,"id":139,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":0},{"name":"row","type":"int","value":2}],"rotation":0,"type":"entity","visible":true,"width":0,"x":1980,"y":1694},{"height":0,"id":140,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":1},{"name":"row","type":"int","value":2}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2004,"y":1693},{"height":0,"id":141,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":2},{"name":"row","type":"int","value":2}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2028,"y":1693},{"height":0,"id":142,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":0},{"name":"row","type":"int","value":3}],"rotation":0,"type":"entity","visible":true,"width":0,"x":1980,"y":1670},{"height":0,"id":143,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":1},{"name":"row","type":"int","value":3}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2004,"y":1669},{"height":0,"id":144,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":2},{"name":"row","type":"int","value":3}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2028,"y":1669},{"height":0,"id":145,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":0},{"name":"row","type":"int","value":4}],"rotation":0,"type":"entity","visible":true,"width":0,"x":1980,"y":1646},{"height":0,"id":146,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":1},{"name":"row","type":"int","value":4}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2004,"y":1645},{"height":0,"id":147,"name":"riddlestone","point":true,"properties":[{"name":"col","type":"int","value":2},{"name":"row","type":"int","value":4}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2028,"y":1645},{"height":0,"id":85,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":"Use jump to overcome obstacles.:::The longer you press, the higher the jump."}],"rotation":0,"type":"entity","visible":true,"width":0,"x":3432,"y":563},{"height":0,"id":86,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":"Walk over items to carry them.:::You cannot interact with doors or other entities when carrying items.:::Press throw to throw your current item."}],"rotation":0,"type":"entity","visible":true,"width":0,"x":3492,"y":443},{"height":0,"id":88,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":" A magical journey awaits you beneath the clouds."}],"rotation":0,"type":"entity","visible":true,"width":0,"x":1140,"y":370},{"height":0,"id":89,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":"Be careful!"}],"rotation":0,"type":"entity","visible":true,"width":0,"x":120,"y":250},{"height":0,"id":102,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":" Mountain\\n Temple\\n Sacred Forest"}],"rotation":0,"type":"entity","visible":true,"width":0,"x":1392,"y":1999},{"height":0,"id":103,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":"Landmark: The Broken Bridge"}],"rotation":0,"type":"entity","visible":true,"width":0,"x":1668,"y":1977},{"height":0,"id":104,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":" Entrance to mountain hiking path.:::Good jumping skills required."}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2064,"y":2000},{"height":0,"id":109,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":" Popular bird feeding spot"}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2016,"y":1235},{"height":0,"id":110,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":"Bouncy mushrooms ahead "}],"rotation":0,"type":"entity","visible":true,"width":0,"x":3876,"y":534},{"height":0,"id":111,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":" Mountain trial"}],"rotation":0,"type":"entity","visible":true,"width":0,"x":1788,"y":1714},{"height":0,"id":161,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":"You can check the controls in the pause menu at any time."}],"rotation":0,"type":"entity","visible":true,"width":0,"x":3300,"y":439},{"height":0,"id":112,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":" Popular seed throwing spot"}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2532,"y":1861},{"height":0,"id":82,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":"Hold down to fall through platforms."}],"rotation":0,"type":"entity","visible":true,"width":0,"x":3336,"y":490},{"height":0,"id":148,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":" Advanced seed throwing spot"}],"rotation":0,"type":"entity","visible":true,"width":0,"x":1573,"y":1735},{"height":0,"id":4,"name":"stone","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":2090,"y":672},{"height":0,"id":2,"name":"fire","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":1212,"y":1968},{"height":0,"id":3,"name":"tree","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":3048,"y":1944},{"height":0,"id":9,"name":"flameboy","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":156,"y":1930},{"height":0,"id":13,"name":"wing","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":3428,"y":850},{"height":0,"id":43,"name":"campfire","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":3480,"y":192},{"height":0,"id":42,"name":"caveman","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":3499,"y":177},{"height":0,"id":17,"name":"river","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":864,"y":1945},{"height":0,"id":18,"name":"forest","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":2907,"y":1890},{"height":0,"id":19,"name":"mountain","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":1932,"y":579},{"height":0,"id":20,"name":"seedposition","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":1932,"y":562},{"height":0,"id":24,"name":"stone_floating_position","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":804,"y":2018},{"height":0,"id":25,"name":"recover_floating_position","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":929,"y":2010},{"height":131,"id":26,"name":"bird_nest_left","rotation":0,"type":"trigger","visible":true,"width":5,"x":163,"y":1011},{"height":0,"id":27,"name":"rain_spawn_position","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":1933,"y":288},{"height":42,"id":36,"name":"door_1","properties":[{"name":"bgm","type":"string","value":"cave"},{"name":"target","type":"string","value":"door_2"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":204,"y":2166},{"height":0,"id":55,"name":"movingplatform","point":true,"properties":[{"name":"direction","type":"string","value":"up"},{"name":"distance","type":"int","value":200},{"name":"velocity","type":"int","value":44}],"rotation":0,"type":"entity","visible":true,"width":0,"x":1585,"y":1172},{"height":0,"id":56,"name":"movingplatform","point":true,"properties":[{"name":"direction","type":"string","value":"up"},{"name":"distance","type":"int","value":100},{"name":"velocity","type":"int","value":44}],"rotation":0,"type":"entity","visible":true,"width":0,"x":2364,"y":842},{"height":44,"id":37,"name":"door_2","properties":[{"name":"bgm","type":"string","value":"overworld"},{"name":"target","type":"string","value":"door_1"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":3252,"y":148},{"height":288,"id":39,"name":"cave1-bounds","rotation":0,"type":"bounds","visible":true,"width":480,"x":3168,"y":0},{"height":288,"id":44,"name":"startingcave-bounds","rotation":0,"type":"bounds","visible":true,"width":480,"x":3168,"y":336},{"height":0,"id":60,"name":"shadowpresence","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":1862,"y":2136},{"height":44,"id":45,"name":"startingdoor_1","properties":[{"name":"bgm","type":"string","value":"overworld"},{"name":"target","type":"string","value":"startingdoor_2"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":3540,"y":484},{"height":0,"id":80,"name":"stonedisciple","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":3480,"y":2204},{"height":44,"id":46,"name":"startingdoor_2","properties":[{"name":"bgm","type":"string","value":"cave"},{"name":"target","type":"string","value":"startingdoor_1"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":60,"y":220},{"height":42,"id":48,"name":"forrest_door_left_1","properties":[{"name":"bgm","type":"string","value":"cave"},{"name":"target","type":"string","value":"forrest_door_left_2"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":2604,"y":1998},{"height":42,"id":49,"name":"forrest_door_right_1","properties":[{"name":"bgm","type":"string","value":"cave"},{"name":"target","type":"string","value":"forrest_door_right_2"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":2724,"y":1998},{"height":624,"id":50,"name":"forrest-cave-bounds","rotation":0,"type":"bounds","visible":true,"width":624,"x":3696,"y":0},{"height":42,"id":51,"name":"forrest_door_left_2","properties":[{"name":"bgm","type":"string","value":"overworld"},{"name":"target","type":"string","value":"forrest_door_left_1"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":3804,"y":510},{"height":42,"id":52,"name":"forrest_door_right_2","properties":[{"name":"bgm","type":"string","value":"overworld"},{"name":"target","type":"string","value":"forrest_door_right_1"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":4188,"y":510},{"height":42,"id":53,"name":"montain_door_floor_1","properties":[{"name":"bgm","type":"string","value":"riddle"},{"name":"target","type":"string","value":"montain_door_floor_2"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":2100,"y":1974},{"height":42,"id":54,"name":"montain_door_top_1","properties":[{"name":"bgm","type":"string","value":"riddle"},{"name":"target","type":"string","value":"montain_door_top_2"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":2220,"y":1782},{"height":264,"id":57,"name":"winghouse-bounds","rotation":0,"type":"bounds","visible":true,"width":480,"x":3168,"y":672},{"height":40,"id":58,"name":"wing_house_door_1","properties":[{"name":"bgm","type":"string","value":"radio"},{"name":"target","type":"string","value":"wing_house_door_2"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":2197,"y":224},{"height":40,"id":59,"name":"wing_house_door_2","properties":[{"name":"bgm","type":"string","value":"overworld"},{"name":"target","type":"string","value":"wing_house_door_1"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":3348,"y":824},{"height":336,"id":61,"name":"mountain-foot-cave-bounds","rotation":0,"type":"bounds","visible":true,"width":480,"x":3168,"y":984},{"height":42,"id":62,"name":"montain_door_floor_2","properties":[{"name":"bgm","type":"string","value":"overworld"},{"name":"target","type":"string","value":"montain_door_floor_1"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":3276,"y":1230},{"height":42,"id":63,"name":"montain_door_top_2","properties":[{"name":"bgm","type":"string","value":"overworld"},{"name":"target","type":"string","value":"montain_door_top_1"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":3492,"y":1063},{"height":960,"id":64,"name":"mountain-foot-cave-bounds","rotation":0,"type":"bounds","visible":true,"width":480,"x":3168,"y":1344},{"height":42,"id":65,"name":"montain_riddlecave_bottom_1","properties":[{"name":"bgm","type":"string","value":"riddle"},{"name":"target","type":"string","value":"montain_riddlecave_bottom_2"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":1741,"y":1686},{"height":42,"id":66,"name":"montain_riddlecave_bottom_2","properties":[{"name":"bgm","type":"string","value":"overworld"},{"name":"target","type":"string","value":"montain_riddlecave_bottom_1"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":3276,"y":2190},{"height":42,"id":77,"name":"montain_riddlecave_top_1","properties":[{"name":"bgm","type":"string","value":"riddle"},{"name":"target","type":"string","value":"montain_riddlecave_top_2"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":1933,"y":1350},{"height":42,"id":78,"name":"montain_riddlecave_top_2","properties":[{"name":"bgm","type":"string","value":"overworld"},{"name":"target","type":"string","value":"montain_riddlecave_top_1"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":3540,"y":1397},{"height":505,"id":79,"name":"no_emit_trigger","properties":[{"name":"disableParticles","type":"bool","value":true}],"rotation":0,"type":"trigger","visible":true,"width":384,"x":3216,"y":1608},{"height":45,"id":81,"name":"finish_mountain_riddle","properties":[{"name":"setDialogEntity","type":"string","value":"stonedisciple"},{"name":"setDialogValue","type":"string","value":"stonedisciple2"}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3384,"y":1443},{"height":0,"id":87,"name":"skull","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":3528,"y":432},{"height":0,"id":97,"name":"wall","point":true,"properties":[{"name":"identifier","type":"string","value":"wall0"}],"rotation":0,"type":"entity","visible":true,"width":0,"x":4260,"y":1464},{"height":0,"id":98,"name":"wall","point":true,"properties":[{"name":"identifier","type":"string","value":"wall1"}],"rotation":0,"type":"entity","visible":true,"width":0,"x":4452,"y":1464},{"height":912,"id":90,"name":"inferno-bounds","rotation":0,"type":"bounds","visible":true,"width":912,"x":3648,"y":624},{"height":0,"id":91,"name":"boss_spawn","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":4104,"y":1416},{"height":0,"id":92,"name":"bosscloud","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":4089,"y":936},{"height":0,"id":93,"name":"bosscloud","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":4056,"y":1293},{"height":0,"id":94,"name":"bosscloud","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":4176,"y":1105},{"height":2304,"id":95,"name":"overworld-bounds","rotation":0,"type":"bounds","visible":true,"width":3168,"x":0,"y":0},{"height":42,"id":100,"name":"boss_door2","properties":[{"name":"target","type":"string","value":"boss_door1"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":3684,"y":798},{"height":42,"id":101,"name":"boss_door1","properties":[{"name":"target","type":"string","value":"boss_door2"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":4451,"y":822},{"height":0,"id":105,"name":"chicken","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":3504,"y":844},{"height":0,"id":106,"name":"bird","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":168,"y":1131},{"height":24,"id":107,"name":"raincloud_sky","rotation":0,"type":"trigger","visible":true,"width":72,"x":1897,"y":212},{"height":119,"id":108,"name":"bird_nest_right","rotation":0,"type":"trigger","visible":true,"width":33,"x":2132,"y":1067},{"height":0,"id":113,"name":"superthrow","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":2592,"y":1863},{"height":3,"id":114,"name":"mountaingate","properties":[{"name":"col","type":"int","value":0},{"name":"row","type":"int","value":0}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3264,"y":2090},{"height":3,"id":115,"name":"mountaingate","properties":[{"name":"col","type":"int","value":1},{"name":"row","type":"int","value":0}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3384,"y":2090},{"height":3,"id":116,"name":"mountaingate","properties":[{"name":"col","type":"int","value":2},{"name":"row","type":"int","value":0}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3504,"y":2090},{"height":3,"id":117,"name":"mountaingate","properties":[{"name":"col","type":"int","value":0},{"name":"row","type":"int","value":1}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3264,"y":1994},{"height":3,"id":118,"name":"mountaingate","properties":[{"name":"col","type":"int","value":1},{"name":"row","type":"int","value":1}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3384,"y":1994},{"height":3,"id":119,"name":"mountaingate","properties":[{"name":"col","type":"int","value":2},{"name":"row","type":"int","value":1}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3504,"y":1994},{"height":3,"id":120,"name":"mountaingate","properties":[{"name":"col","type":"int","value":0},{"name":"row","type":"int","value":2}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3264,"y":1898},{"height":3,"id":121,"name":"mountaingate","properties":[{"name":"col","type":"int","value":1},{"name":"row","type":"int","value":2}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3384,"y":1898},{"height":3,"id":122,"name":"mountaingate","properties":[{"name":"col","type":"int","value":2},{"name":"row","type":"int","value":2}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3504,"y":1898},{"height":3,"id":123,"name":"mountaingate","properties":[{"name":"col","type":"int","value":0},{"name":"row","type":"int","value":3}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3264,"y":1802},{"height":3,"id":124,"name":"mountaingate","properties":[{"name":"col","type":"int","value":1},{"name":"row","type":"int","value":3}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3384,"y":1802},{"height":3,"id":125,"name":"mountaingate","properties":[{"name":"col","type":"int","value":2},{"name":"row","type":"int","value":3}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3504,"y":1802},{"height":3,"id":126,"name":"mountaingate","properties":[{"name":"col","type":"int","value":0},{"name":"row","type":"int","value":4}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3264,"y":1706},{"height":3,"id":127,"name":"mountaingate","properties":[{"name":"col","type":"int","value":1},{"name":"row","type":"int","value":4}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3384,"y":1706},{"height":3,"id":128,"name":"mountaingate","properties":[{"name":"col","type":"int","value":2},{"name":"row","type":"int","value":4}],"rotation":0,"type":"trigger","visible":true,"width":48,"x":3504,"y":1706},{"height":5,"id":129,"name":"reset_mountain","rotation":0,"type":"trigger","visible":true,"width":384,"x":3216,"y":2140},{"height":1,"id":130,"name":"teleporter","properties":[{"name":"teleportY","type":"int","value":288}],"rotation":0,"type":"trigger","visible":true,"width":384,"x":3216,"y":1705},{"height":1,"id":131,"name":"teleporter","properties":[{"name":"teleportY","type":"int","value":192}],"rotation":0,"type":"trigger","visible":true,"width":384,"x":3216,"y":1801},{"height":1,"id":132,"name":"teleporter","properties":[{"name":"teleportY","type":"int","value":96}],"rotation":0,"type":"trigger","visible":true,"width":384,"x":3216,"y":1897},{"height":24,"id":151,"name":"readable","properties":[{"name":"content","type":"string","value":"A strange device:::There is no manual available."}],"rotation":0,"type":"trigger","visible":true,"width":24,"x":3240,"y":417},{"height":24,"id":152,"name":"readable","properties":[{"name":"content","type":"string","value":"A little garden. Cute."}],"rotation":0,"type":"trigger","visible":true,"width":24,"x":1920,"y":542},{"height":46,"id":153,"name":"readable","properties":[{"name":"content","type":"string","value":"A collection of books regarding non euclidean architecture.:::Just thinking about the contents drives me mad."},{"name":"duration","type":"int","value":4}],"rotation":0,"type":"trigger","visible":true,"width":30,"x":3558,"y":2162},{"height":0,"id":154,"name":"portal","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":3252,"y":439},{"height":0,"id":156,"name":"mimic","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":3288,"y":857},{"height":0,"id":160,"name":"bone","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":3564,"y":438},{"height":24,"id":157,"name":"readable","properties":[{"name":"content","type":"string","value":"A classic mailbox.:::It\'s welded shut."}],"rotation":0,"type":"trigger","visible":true,"width":14,"x":2141,"y":240},{"height":0,"id":158,"name":"radio","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":3552,"y":748},{"height":11,"id":159,"name":"readable","properties":[{"name":"content","type":"string","value":"Just a regular old stereo:::How disappointing."}],"rotation":0,"type":"trigger","visible":true,"width":30,"x":3537,"y":737},{"height":0,"id":47,"name":"player","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":3280,"y":399},{"height":0,"id":162,"name":"shiba","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":184,"y":1231},{"height":0,"id":163,"name":"powershiba","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":2712,"y":249},{"height":24,"id":164,"name":"shiba_action","properties":[{"name":"velocity","type":"int","value":1}],"rotation":0,"type":"trigger","visible":true,"width":5,"x":150,"y":1224},{"height":24,"id":165,"name":"shiba_action","properties":[{"name":"velocity","type":"int","value":-1}],"rotation":0,"type":"trigger","visible":true,"width":5,"x":264,"y":1224},{"height":24,"id":166,"name":"readable","properties":[{"name":"content","type":"string","value":"A small dog house entrance.:::I don\'t fit since I\'m not a dog."}],"rotation":0,"type":"trigger","visible":true,"width":3,"x":144,"y":1224},{"height":12,"id":167,"name":"readable","properties":[{"name":"content","type":"string","value":"Some kind of bird nest made out of twigs.:::Pretty normal."}],"rotation":0,"type":"trigger","visible":true,"width":22,"x":158,"y":1130},{"height":24,"id":168,"name":"readable","properties":[{"name":"content","type":"string","value":"This a great vantage point.:::I can see a large tree with a birds nest in the distance."}],"rotation":0,"type":"trigger","visible":true,"width":24,"x":1392,"y":1440},{"height":0,"id":170,"name":"shiba_mountain_spawn","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":1950,"y":1235},{"height":0,"id":171,"name":"powershiba_mountain_spawn","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":1979,"y":1234},{"height":0,"id":172,"name":"friendship_player_position","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":1179,"y":1968},{"height":0,"id":173,"name":"friendship_shiba_spawn","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":1477,"y":2010},{"height":47,"id":175,"name":"shiba_stop","rotation":0,"type":"trigger","visible":true,"width":12,"x":1212,"y":1921},{"height":0,"id":176,"name":"water_sound","point":true,"properties":[{"name":"intensity","type":"float","value":0.5},{"name":"sound","type":"string","value":"stream"},{"name":"volume","type":"int","value":1}],"rotation":0,"type":"sound","visible":true,"width":0,"x":732,"y":1992},{"height":0,"id":177,"name":"wind_sound","point":true,"properties":[{"name":"intensity","type":"float","value":1},{"name":"sound","type":"string","value":"wind"},{"name":"volume","type":"float","value":0.6}],"rotation":0,"type":"sound","visible":true,"width":0,"x":2029,"y":933},{"height":0,"id":178,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":"There is currently no way to save your progress.:::A single run is pretty short so we hope that it isn\'t too much of a problem.::: Sorry for any resulting inconveniences!"}],"rotation":0,"type":"entity","visible":true,"width":0,"x":3336,"y":563},{"height":0,"id":179,"name":"player_reset_position","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":1261,"y":1573},{"height":24,"id":180,"name":"flameboy_action","properties":[{"name":"velocity","type":"int","value":1}],"rotation":0,"type":"trigger","visible":true,"width":5,"x":342,"y":1968},{"height":24,"id":181,"name":"flameboy_action","properties":[{"name":"velocity","type":"int","value":-1}],"rotation":0,"type":"trigger","visible":true,"width":5,"x":504,"y":1968},{"height":44,"id":183,"name":"exitportaldoor_1","properties":[{"name":"bgm","type":"string","value":"awake"},{"name":"disabled","type":"bool","value":true},{"name":"enterSound","type":"string","value":"portal"},{"name":"target","type":"string","value":"exitportaldoor_2"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":144,"y":1887},{"height":44,"id":184,"name":"exitportaldoor_2","properties":[{"name":"bgm","type":"string","value":"cave"},{"name":"disabled","type":"bool","value":true},{"name":"exitFadeTime","type":"float","value":5},{"name":"exitSleepTime","type":"float","value":5},{"name":"exitSound","type":"string","value":"empty"},{"name":"target","type":"string","value":"exitportaldoor_1"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":3360,"y":2452},{"height":264,"id":185,"name":"laboratory-bounds","rotation":0,"type":"bounds","visible":true,"width":3648,"x":0,"y":2328},{"height":41,"id":186,"name":"readable","properties":[{"name":"content","type":"string","value":"This door is locked. It says \'100\'"},{"name":"duration","type":"int","value":4}],"rotation":0,"type":"trigger","visible":true,"width":22,"x":2881,"y":2455},{"height":39,"id":187,"name":"readable","properties":[{"name":"content","type":"string","value":"I woke up in this strange capsule"},{"name":"duration","type":"int","value":4}],"rotation":0,"type":"trigger","visible":true,"width":19,"x":3362,"y":2457},{"height":39,"id":188,"name":"readable","properties":[{"name":"content","type":"string","value":"Some capsules are still closed. I can see a humanoid shape through the glass"},{"name":"duration","type":"int","value":4}],"rotation":0,"type":"trigger","visible":true,"width":19,"x":3266,"y":2456},{"height":39,"id":189,"name":"readable","properties":[{"name":"content","type":"string","value":"He seems to be dead for quite some time."},{"name":"duration","type":"int","value":4}],"rotation":0,"type":"trigger","visible":true,"width":19,"x":2762,"y":2457},{"height":41,"id":190,"name":"readable","properties":[{"name":"content","type":"string","value":"The is door is locked as well. It says \'200\'"},{"name":"duration","type":"int","value":4}],"rotation":0,"type":"trigger","visible":true,"width":22,"x":2185,"y":2455},{"height":0,"id":191,"name":"window","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":1680,"y":2476},{"height":41,"id":194,"name":"readable","properties":[{"name":"content","type":"string","value":"The blinds are shut tight."},{"name":"duration","type":"int","value":4}],"rotation":0,"type":"trigger","visible":true,"width":23,"x":1740,"y":2455},{"height":41,"id":195,"name":"readable","properties":[{"name":"content","type":"string","value":"The blinds are shut tight."},{"name":"duration","type":"int","value":4}],"rotation":0,"type":"trigger","visible":true,"width":23,"x":1812,"y":2455},{"height":41,"id":196,"name":"readable","properties":[{"name":"content","type":"string","value":"The blinds are shut tight."},{"name":"duration","type":"int","value":4}],"rotation":0,"type":"trigger","visible":true,"width":23,"x":1596,"y":2455},{"height":0,"id":197,"name":"windowzoomtarget","point":true,"rotation":0,"type":"pointer","visible":true,"width":0,"x":275,"y":2465},{"height":0,"id":200,"name":"player_spawn","point":true,"properties":[{"name":"newGamePlus","type":"bool","value":false}],"rotation":0,"type":"pointer","visible":true,"width":0,"x":3252,"y":426},{"height":40,"id":201,"name":"ngplus_house_door_1","properties":[{"name":"bgm","type":"string","value":"cave"},{"name":"newGamePlus","type":"bool","value":true},{"name":"target","type":"string","value":"ngplus_house_door_2"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":901,"y":1664},{"height":40,"id":202,"name":"ngplus_house_door_2","properties":[{"name":"bgm","type":"string","value":"overworld"},{"name":"target","type":"string","value":"ngplus_house_door_1"}],"rotation":0,"type":"gate","visible":true,"width":24,"x":3972,"y":1736},{"height":0,"id":203,"name":"player_spawn","point":true,"properties":[{"name":"newGamePlus","type":"bool","value":true}],"rotation":0,"type":"pointer","visible":true,"width":0,"x":3828,"y":1691},{"height":0,"id":204,"name":"portal","point":true,"rotation":0,"type":"entity","visible":true,"width":0,"x":3828,"y":1713},{"height":264,"id":206,"name":"ngplus-house-bounds","rotation":0,"type":"bounds","visible":true,"width":480,"x":3648,"y":1560},{"height":0,"id":207,"name":"sign","point":true,"properties":[{"name":"content","type":"string","value":"Welcome to New Game+!:::If you want to try to tackle some of the other endings, this is a great way to do that!:::The seed is already planted and you just got the flying ability. Have fun!"}],"rotation":0,"type":"entity","visible":true,"width":0,"x":3936,"y":1760},{"height":24,"id":208,"name":"readable","properties":[{"name":"content","type":"string","value":"Another strange device:::Still no manual far and wide."}],"rotation":0,"type":"trigger","visible":true,"width":24,"x":3816,"y":1691},{"height":24,"id":209,"name":"readable","properties":[{"name":"content","type":"string","value":"A mysterious door.:::It\'s locked."},{"name":"newGamePlus","type":"bool","value":false}],"rotation":0,"type":"trigger","visible":true,"width":19,"x":903,"y":1680},{"height":40,"id":210,"name":"shadowgate_door_1","properties":[{"name":"bgm","type":"string","value":"shadowgate"},{"name":"disabled","type":"bool","value":true},{"name":"enterSound","type":"string","value":"portal"},{"name":"target","type":"string","value":"shadowgate_door_2"}],"rotation":0,"type":"gate","visible":true,"width":19,"x":1853,"y":2096},{"height":40,"id":211,"name":"shadowgate_door_2","properties":[{"name":"bgm","type":"string","value":"cave"},{"name":"disabled","type":"bool","value":true},{"name":"exitFadeTime","type":"float","value":5},{"name":"exitSound","type":"string","value":"empty"},{"name":"target","type":"string","value":"shadowgate_door_1"}],"rotation":0,"type":"gate","visible":true,"width":19,"x":3768,"y":2452},{"height":264,"id":212,"name":"shadowhallway-bounds","rotation":0,"type":"bounds","visible":true,"width":912,"x":3648,"y":2328}],"opacity":1,"type":"objectgroup","visible":true,"x":0,"y":0}],"nextlayerid":8,"nextobjectid":213,"orientation":"orthogonal","renderorder":"left-down","tiledversion":"1.10.2","tileheight":24,"tilesets":[{"columns":25,"firstgid":1,"image":"tilemap.png","imageheight":816,"imagewidth":600,"margin":0,"name":"tilemap","spacing":0,"tilecount":850,"tileheight":24,"tilewidth":24,"transparentcolor":"#ff00ff"}],"tilewidth":24,"type":"map","version":"1.10","width":190}')}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,i),a.exports}i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=i(2821),t=i(6745),s=i(6070);class n extends e.Game{constructor(){super()}}function a(e){document.getElementById("update-banner").dataset.state="update-available",document.querySelector("#update-banner .headline").innerHTML="Update available",document.querySelector("#update-banner .subhead").innerHTML="Click here to update the app to the latest version",document.getElementById("update-banner").addEventListener("click",(t=>{e.postMessage("SKIP_WAITING")}))}let r=Promise.resolve();if(!(0,s.isElectron)()){const e=document.getElementsByTagName("body")[0],t=document.createElement("script");if(t.setAttribute("defer","true"),t.setAttribute("src","./touch-controls.js"),e.appendChild(t),"registerProtocolHandler"in navigator&&"play.friendlyfiregame.com"===window.location.hostname&&navigator.registerProtocolHandler("web+friendlyfiregame","https://play.friendlyfiregame.com/?s=%s"),"serviceWorker"in navigator){r=navigator.serviceWorker.ready;let e=!1;window.addEventListener("load",(async()=>{try{const t=await navigator.serviceWorker.register("./service-worker.js");null!==t.waiting&&a(t.waiting),t.addEventListener("updatefound",(function(e){null!==t.active&&t.installing?.addEventListener("statechange",(function(e){"installed"===this.state&&null!=t.waiting&&a(t.waiting)}))})),navigator.serviceWorker.addEventListener("controllerchange",(async function(t){await this.ready,e||(e=!0,window.location.reload())}))}catch(e){console.error("Registration of service worker failed.",e)}}))}}(async()=>{await r;const e=new n;window.game=e,e.scenes.setScene(t.LoadingScene),e.start()})().catch(console.error)})()})();
//# sourceMappingURL=index.js.map